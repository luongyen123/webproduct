if (self.CavalryLogger) { CavalryLogger.start_js(["vX4uF"]); }

__d("MercuryAudioPlayer",["Arbiter","DOM","Event","Flash"],(function(a,b,c,d,e,f){__p&&__p();var g=200;function h(){var a=b("DOM").create("audio"),c=!1;try{a.canPlayType&&(a.canPlayType("video/mp4;").replace(/^no$/,"")&&(c=!0))}finally{return c}}function i(){return b("Flash").isAvailable()}var j=function(){this.interval=null,this.arbiterInstance=null,this.audio=b("DOM").create("audio"),b("Event").listen(this.audio,"playing",function(){this.informAttachment("playing",this.audio.currentTime),this.interval=setInterval(function(){this.informAttachment("playing",this.audio.currentTime)}.bind(this),g)}.bind(this)),b("Event").listen(this.audio,"ended",function(){clearInterval(this.interval),this.informAttachment("finished")}.bind(this))};Object.assign(j.prototype,{setAudio:function(a,b){this.audio.setAttribute("src",a),this.arbiterInstance=b},informAttachment:function(a,b){this.arbiterInstance&&this.arbiterInstance.inform(a,b)},play:function(){this.audio.play(),this.informAttachment("played")},resume:function(){this.audio.play(),this.informAttachment("played")},pause:function(){this.audio.pause(),clearInterval(this.interval),this.informAttachment("paused")},getType:function(){return"html5"}});var k=function(){this.src=null;this.arbiterInstance=null;var a=b("DOM").create("div");document.body.appendChild(a);this.swf=b("Flash").embed("/swf/cigars/SoundStreamPlayer.swf",a,null,{});this.interval=null;b("Arbiter").subscribe("soundstream/finished",function(){clearInterval(this.interval),this.informAttachment("finished")}.bind(this))};Object.assign(k.prototype,{setAudio:function(a,b){this.src=a,this.arbiterInstance=b},informAttachment:function(a,b){this.arbiterInstance&&this.arbiterInstance.inform(a,b)},play:function(){this.swf.playSound(this.src),this.interval=setInterval(function(){var a=this.swf.getCurrentTime();this.informAttachment("playing",a)}.bind(this),g),this.informAttachment("played")},resume:function(){this.swf.resume(),this.informAttachment("played")},pause:function(){clearInterval(this.interval),this.swf.pause(),this.informAttachment("paused")},getType:function(){return"flash"}});function l(){if(h())return new j();else if(i())return new k();return!1}var m=null,n=null,o=0;function a(a,b){this.src=a;this.arbiterInstance=b;this.audio_id=++o;m!==null||(m=l());if(!m)return!1}Object.assign(a.prototype,{getType:function(){if(!m)return!1;else return m.getType()},play:function(a){a&&n==this.audio_id?m.resume():(this.pause(),n=this.audio_id,m.setAudio(this.src,this.arbiterInstance),m.play())},pause:function(){m.pause()}});e.exports=a}),null);
__d("MercuryAttachmentAudioClip.react",["cssVar","cx","fbt","Arbiter","ArbiterMixin","CurrentUser","JSLogger","LeftRight.react","Link.react","MercuryAudioPlayer","MercuryShareAttachmentRenderLocations","React","SubscriptionsHandler","WorkModeConfig","joinClasses","messengerCustomColorUtils","shield"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();a=b("React").PropTypes;var j="MercuryAttachmentAudioClip/play",k="progress-bar",l=b("JSLogger").create("mercury_audio_clip");c=b("React").createClass({displayName:"AudioClip",mixins:[b("ArbiterMixin")],propTypes:{customColor:a.string,duration:a.number,isChat:a.bool,isFromViewer:a.bool,location:a.oneOf(b("MercuryShareAttachmentRenderLocations").getValues()),onAttachmentLoad:a.func,rootClassName:a.string,showHelp:a.bool,src:a.string.isRequired,width:a.number},getInitialState:function(){this.logged=!1;return{time:0,playing:!1,started:!1,duration:this.props.duration,audioPlayer:new(b("MercuryAudioPlayer"))(this.props.src,this)}},componentDidMount:function(){this.props.onAttachmentLoad&&this.props.onAttachmentLoad(),this._subscriptionsHandler=new(b("SubscriptionsHandler"))(),this._subscriptionsHandler.addSubscriptions(this.subscribe("playing",this.updateTime),this.subscribe("played",b("shield")(this.setState,this,{playing:!0,started:!0})),this.subscribe("paused",b("shield")(this.setState,this,{playing:!1})),this.subscribe("finished",b("shield")(this.setState,this,{playing:!1,started:!1,time:this.props.duration})),b("Arbiter").subscribe(j,function(a,b){this.props.src!=b&&this.setState({time:0})}.bind(this)))},componentWillUnmount:function(){this._subscriptionsHandler&&this._subscriptionsHandler.release()},updateTime:function(a,b){this.setState({time:b})},play:function(){this.state.playing?this.state.audioPlayer.pause():(this.state.audioPlayer.play(this.state.started),b("Arbiter").inform(j,this.props.src),this.logged||(this.logged=!0,l.log("play",{uid:b("CurrentUser").getID(),duration:this.props.duration})))},_formatSeconds:function(a){if(a){a=Math.round(a);var b=a%60;b<10&&(b="0"+b);a=Math.floor(a/60);return a+":"+b}else return null},_renderPlayer:function(a,c,d){var e=this.props.isFromViewer,f=this.props.isChat,g=b("WorkModeConfig").is_work_user,h=d===k,j=f&&e&&!h,l=this.props.location===b("MercuryShareAttachmentRenderLocations").MESSENGER;g=g?"#373e4c":"#4080ff";g=d||g;a={width:a};j&&(a.backgroundColor=g);j=d&&d!==k&&!f?{color:d}:{};g={};h&&(g["aria-disabled"]=!0);return b("React").createElement(b("Link.react"),babelHelpers["extends"]({"aria-label":i._("Tin nh\u1eafn tho\u1ea1i"),className:"_1miz _2e-1"+(l?"":" _3_om")+(e&&f?" _3e5f":""),role:"button",style:a,onClick:this.play},g),b("React").createElement("span",{className:"_1mi- _2e-2"},b("React").createElement("i",{className:"_1mi_ _2e-3"})),b("React").createElement("span",{style:j,className:"_1mj0 _2e-4 _3oh-"},c),b("React").createElement("div",{className:"_1mj1 _2e-5"}))},render:function(){__p&&__p();var a=this.state.time,c=this.state.playing,d=this._formatSeconds(this.state.duration),e=this.props.location===b("MercuryShareAttachmentRenderLocations").MESSENGER,f=this.props.width||170;if(e){var g=this.props.duration;g>10?f=240:g>5?f=200:g>2?f=160:f=120}g=null;var h=Math.ceil(a*(f+2)/this.state.duration);e&&(h=Math.ceil(a*(f+24)/this.state.duration));if(this.state.audioPlayer&&this.state.audioPlayer.getType()){var j=this._renderPlayer(f,d,this.props.customColor);f=this._renderPlayer(f,d,k);c="_1mj2 _2e-6"+(c&&a!==0?" _1mj3":"")+(c&&a===0?" _4g4x":"");g=b("React").createElement("div",{className:c},j,b("React").createElement("div",{className:"_1mj4 _2e-7",style:{width:h}},f))}else g=b("React").createElement("div",{className:"_1mj2"},b("React").createElement("div",{className:"_1miz"},b("React").createElement(b("LeftRight.react"),null,b("React").createElement("a",{className:"_1mj5",href:this.props.src},b("React").createElement("span",{className:"_3qi6"},b("React").createElement("i",{className:"_1mj6"})),b("React").createElement("span",{className:"_1mj7"},i._("Tin nh\u1eafn tho\u1ea1i")),b("React").createElement("span",{className:"_1mj8"},d)),b("React").createElement("a",{href:this.props.src,className:"_1mj9"},b("React").createElement("i",{className:"_1mja"})))));return b("React").createElement("div",{className:b("joinClasses")("_1mjb"+(e?" _454y":""),this.props.rootClassName)},g)}});e.exports=c}),null);
__d("UFICreatorInfo.react",["cx","fbt","HelpLink.react","Image.react","React","URI"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;i=babelHelpers.inherits(a,b("React").Component);i&&i.prototype;a.prototype.render=function(){__p&&__p();var a,c=this.getCreatorLink();switch(this.props.labelType){case"commented":a=h._("Ng\u01b0\u1eddi b\u00ecnh lu\u1eadn: {creator}",[h._param("creator",c)]);break;case"edited_comment":a=h._("\u0110\u01b0\u1ee3c ch\u1ec9nh s\u1eeda b\u1edfi {creator}",[h._param("creator",c)]);break;case"sent_message":a=h._("\u0110\u01b0\u1ee3c g\u1eedi b\u1edfi {creator}",[h._param("creator",c)]);break;case"page_admin_note":a=h._("Ghi ch\u00fa c\u1ee7a {creator}",[h._param("creator",c)]);break;default:return b("React").createElement("span",null)}return b("React").createElement("span",null,a,b("React").createElement(b("HelpLink.react"),{tooltip:this.getHelpText()}))};a.prototype.getCreatorLink=function(){switch(this.props.creatorType){case"application":case"gray_account":case"indirect_admin":return b("React").createElement("a",{className:"uiLinkSubtle","data-hover":"tooltip","data-tooltip-content":this.getTooltipText()},this.props.creatorName);case"business_admin":return b("React").createElement("a",{className:"uiLinkSubtle",href:this.props.profileURI},this.props.creatorName);case"direct_admin":return this.getProfileLinkWithHovercard();case"former_admin":return b("React").createElement("span",{className:"uiLinkSubtle"},b("React").createElement(b("Image.react"),{src:"/images/privacy/cant-see.png",width:9,height:9,className:"_3-8_"}),this.getProfileLinkWithHovercard());default:return b("React").createElement("span",{className:"uiLinkSubtle"},this.props.creatorName)}};a.prototype.getTooltipText=function(){switch(this.props.creatorType){case"application":return this.getApplicationText();case"gray_account":return this.getGrayAccountText();case"indirect_admin":return this.getIndirectAdminText()}return null};a.prototype.getProfileLinkWithHovercard=function(){if(!this.props.profileURI)return b("React").createElement("span",null,this.props.creatorName);var a=new(b("URI"))("/ajax/hovercard/user.php").setQueryData({id:this.props.creatorID}).addQueryData({type:"page_admin",extragetparams:JSON.stringify({directed_target_id:this.props.pageID})});return b("React").createElement("a",{className:"uiLinkSubtle","data-hovercard":a,href:this.props.profileURI},this.props.creatorName)};a.prototype.getApplicationText=function(){switch(this.props.labelType){case"commented":return h._("B\u00ecnh lu\u1eadn n\u00e0y \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1edfi ai \u0111\u00f3 \u0111ang s\u1eed d\u1ee5ng {application}.",[h._param("application",this.props.creatorName)]);case"edited_comment":return h._("B\u00e0i vi\u1ebft n\u00e0y \u0111\u00e3 \u0111\u01b0\u1ee3c ai \u0111\u00f3 s\u1eed d\u1ee5ng {application} ch\u1ec9nh s\u1eeda.",[h._param("application",this.props.creatorName)]);case"sent_message":return h._("Tin nh\u1eafn n\u00e0y \u0111\u01b0\u1ee3c g\u1eedi b\u1edfi ai \u0111\u00f3 \u0111ang s\u1eed d\u1ee5ng {application}.",[h._param("application",this.props.creatorName)]);case"page_admin_note":return h._("\u0110\u00e2y l\u00e0 ghi ch\u00fa c\u1ee7a ai \u0111\u00f3 s\u1eed d\u1ee5ng {application}.",[h._param("application",this.props.creatorName)])}return null};a.prototype.getIndirectAdminText=function(){switch(this.props.labelType){case"commented":return h._("B\u00ecnh lu\u1eadn n\u00e0y \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1edfi ai \u0111\u00f3 t\u1eeb {page}.",[h._param("page",this.props.creatorName)]);case"edited_comment":return h._("B\u00e0i vi\u1ebft n\u00e0y \u0111\u00e3 \u0111\u01b0\u1ee3c ai \u0111\u00f3 t\u1eeb {page} ch\u1ec9nh s\u1eeda.",[h._param("page",this.props.creatorName)]);case"sent_message":return h._("Tin nh\u1eafn n\u00e0y \u0111\u01b0\u1ee3c g\u1eedi b\u1edfi ai \u0111\u00f3 t\u1eeb {page}.",[h._param("page",this.props.creatorName)]);case"page_admin_note":return h._("\u0110\u00e2y l\u00e0 ghi ch\u00fa c\u1ee7a ai \u0111\u00f3 t\u1eeb {page}.",[h._param("page",this.props.creatorName)])}return null};a.prototype.getGrayAccountText=function(){switch(this.props.labelType){case"commented":return h._("B\u00ecnh lu\u1eadn n\u00e0y \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n b\u1edfi ai \u0111\u00f3 kh\u00f4ng c\u00f3 t\u00e0i kho\u1ea3n Facebook c\u00e1 nh\u00e2n.");case"edited_comment":return h._("B\u00e0i vi\u1ebft n\u00e0y \u0111\u00e3 \u0111\u01b0\u1ee3c ai \u0111\u00f3 kh\u00f4ng c\u00f3 t\u00e0i kho\u1ea3n c\u00e1 nh\u00e2n tr\u00ean Facebook \u0111\u0103ng.");case"sent_message":return h._("Tin nh\u1eafn n\u00e0y \u0111\u01b0\u1ee3c g\u1eedi b\u1edfi ai \u0111\u00f3 kh\u00f4ng c\u00f3 t\u00e0i kho\u1ea3n Facebook c\u00e1 nh\u00e2n.");case"page_admin_note":return h._("\u0110\u00e2y l\u00e0 ghi ch\u00fa c\u1ee7a ai \u0111\u00f3 kh\u00f4ng c\u00f3 t\u00e0i kho\u1ea3n Facebook c\u00e1 nh\u00e2n.")}return null};a.prototype.getHelpText=function(){switch(this.props.labelType){case"commented":return h._("Ch\u1ec9 nh\u1eefng ng\u01b0\u1eddi qu\u1ea3n l\u00fd Trang n\u00e0y m\u1edbi c\u00f3 th\u1ec3 bi\u1ebft ai \u0111\u00e3 \u0111\u0103ng b\u00ecnh lu\u1eadn");case"edited_comment":return h._("Ch\u1ec9 nh\u1eefng ng\u01b0\u1eddi qu\u1ea3n l\u00fd Trang n\u00e0y m\u1edbi c\u00f3 th\u1ec3 bi\u1ebft ai \u0111\u00e3 ch\u1ec9nh s\u1eeda b\u00ecnh lu\u1eadn");case"sent_message":return h._("Ch\u1ec9 nh\u1eefng ng\u01b0\u1eddi qu\u1ea3n l\u00fd Trang n\u00e0y c\u00f3 th\u1ec3 xem ng\u01b0\u1eddi \u0111\u00e3 g\u1eedi tin nh\u1eafn");case"page_admin_note":return h._("Ch\u1ec9 nh\u1eefng ng\u01b0\u1eddi qu\u1ea3n l\u00fd Trang n\u00e0y c\u00f3 th\u1ec3 xem ng\u01b0\u1eddi \u0111\u00e3 t\u1ea1o ghi ch\u00fa")}return null};function a(){i.apply(this,arguments)}a.propTypes={creatorID:c.string.isRequired,creatorType:c.string.isRequired,creatorName:c.string.isRequired,labelType:c.string.isRequired,pageID:c.string.isRequired,profileURI:c.string};e.exports=a}),null);
__d("PagesMessengerCreatorInfo.react",["cx","React","UFICreatorInfo.react","XUIGrayText.react"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){return b("React").createElement(b("XUIGrayText.react"),{className:"_ajk"+(this.props.isNote?" _45l2":""),display:"inline",shade:"light",size:"meta1"},b("React").createElement(b("UFICreatorInfo.react"),{creatorID:this.props.creator_info.creatorID,creatorType:this.props.creator_info.creatorType,creatorName:this.props.creator_info.creatorName,labelType:this.props.creator_info.labelType,pageID:this.props.creator_info.pageID,profileURI:this.props.creator_info.profileURI}))};function a(){h.apply(this,arguments)}a.propTypes={creator_info:c.shape({creatorID:c.string.isRequired,creatorName:c.string.isRequired,creatorType:c.string.isRequired,labelType:c.string.isRequired,pageID:c.string.isRequired,profileURI:c.string}).isRequired};e.exports=a}),null);
__d("RepliedToMessageContent.react",["ix","cx","fbt","Bootloader","CurrentUser","FantaTabActions","FBLogger","Image.react","LineClamp.react","MercuryAttachmentType","MessengerTextWithEntities.react","React","RepliedToMessageStatusForGraphQL","asset"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j;c=babelHelpers.inherits(a,b("React").Component);j=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=j.constructor).call.apply(a,[this].concat(e)),this.$4=function(){this.$5();if(this.props.repliedToMessageData.status!==b("RepliedToMessageStatusForGraphQL").VALID)return;var a=this.props.threadID;this.props.isMessengerUI?this.props.scrollToRepliedMessage&&this.props.scrollToRepliedMessage(this.props.repliedToMessageData.message.message_id):a!==null&&a!==undefined&&b("FantaTabActions").jumpToMessage(a,this.props.repliedToMessageData.message.message_id)}.bind(this),c}a.prototype.render=function(){__p&&__p();var a=this.props,c=a.isFromViewer,d=a.isMessengerUI;a=a.repliedToMessageData;var e=a.status===b("RepliedToMessageStatusForGraphQL").VALID;if(e&&!a.message){b("FBLogger")("message_replies").mustfix("invalid message reply: Status is Valid but replied_to_message is missing");return null}e=e?a.message.body:this.$1(a);var f=null;!e&&a.message.attachments&&(f=this.$2(a.message.attachments,c,d),e=this.$3(a.message.attachments));c=b("React").createElement(b("LineClamp.react"),{className:"_4k7e",lines:2,lineHeight:d?16:13,fitHeightToShorterText:!0},b("React").createElement(b("MessengerTextWithEntities.react"),{renderEmoji:!0,renderEmoticons:!0,text:e}));if(!this.props.replyInOneBubble)return b("React").createElement("div",{className:(!!f&&d?"_6e7n":"")+(!!f&&!d?" _6e6m":"")},c,f);a=b("React").createElement("blockquote",{className:"_pye"+(!!f&&d?" _6e7n":"")+(!!f&&!d?" _6e6m":"")},b("React").createElement("div",{className:"_pyf"}),c,f);return!this.props.isLinkified?a:b("React").createElement("a",{className:"_6e6n",href:"#",onClick:this.$4},a)};a.prototype.$1=function(a){switch(a.status){case b("RepliedToMessageStatusForGraphQL").DELETED:return i._("Tin nh\u1eafn n\u00e0y \u0111\u00e3 b\u1ecb x\u00f3a").toString();case b("RepliedToMessageStatusForGraphQL").TEMPORARILY_UNAVAILABLE:default:return i._("Tin nh\u1eafn t\u1ea1m th\u1eddi kh\u00f4ng hi\u1ec3n th\u1ecb").toString()}};a.prototype.$2=function(a,c,d){d=d?"_6e6o":"_6e6y";if(a.length===1&&a[0].attach_type)switch(a[0].attach_type){case b("MercuryAttachmentType").PHOTO:case b("MercuryAttachmentType").STICKER:case b("MercuryAttachmentType").THIRDPARTYSTICKER:case b("MercuryAttachmentType").ANIMATED_IMAGE:return!this.props.replyInOneBubble?b("React").createElement(b("Image.react"),{className:d,src:g("602383")}):c===!0?b("React").createElement(b("Image.react"),{className:d,src:g("544881")}):b("React").createElement(b("Image.react"),{className:d,src:g("596859")});case b("MercuryAttachmentType").VIDEO:return!this.props.replyInOneBubble?b("React").createElement(b("Image.react"),{className:d,src:g("602399")}):c===!0?b("React").createElement(b("Image.react"),{className:d,src:g("504242")}):b("React").createElement(b("Image.react"),{className:d,src:g("596875")});default:return!this.props.replyInOneBubble?b("React").createElement(b("Image.react"),{className:d,src:g("562396")}):c===!0?b("React").createElement(b("Image.react"),{className:d,src:g("555222")}):b("React").createElement(b("Image.react"),{className:d,src:g("596853")})}else if(a.length>1)return!this.props.replyInOneBubble?b("React").createElement(b("Image.react"),{className:d,src:g("602390")}):c===!0?b("React").createElement(b("Image.react"),{className:d,src:g("504171")}):b("React").createElement(b("Image.react"),{className:d,src:g("596866")});else return null};a.prototype.$3=function(a){__p&&__p();var c=a.length;if(c===1&&a[0].attach_type)switch(a[0].attach_type){case b("MercuryAttachmentType").PHOTO:return i._("\u1ea2nh").toString();case b("MercuryAttachmentType").VIDEO:return i._("Video").toString();case b("MercuryAttachmentType").STICKER:case b("MercuryAttachmentType").THIRDPARTYSTICKER:return i._("Nh\u00e3n d\u00e1n").toString();case b("MercuryAttachmentType").ANIMATED_IMAGE:return i._("T\u1ec7p GIF").toString();default:return i._("T\u1ec7p \u0111\u00ednh k\u00e8m").toString()}else if(c>1)return i._({"*":"{number of attachments} t\u1ec7p \u0111\u00ednh k\u00e8m","_1":"{number of attachments} t\u1ec7p \u0111\u00ednh k\u00e8m"},[i._param("number of attachments",c),i._plural(c)]).toString();else return null};a.prototype.$5=function(){b("Bootloader").loadModules(["MessageReplyTypedLogger","MessageReplyEvent"],function(a,c){a=new a();a.setEvent(c.SCROLL_TO_ORIGINAL_MESSAGE).setIsWorkplace(b("CurrentUser").isWorkUser()).log()},"RepliedToMessageContent.react")};e.exports=a}),null);
__d("MessengerSharedPhoto.react",["cx","CssBackgroundImage.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;b("React").PropTypes;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.$1=function(a){a.preventDefault(),this.props.onClick(this.props.fbid)}.bind(this),b}a.prototype.render=function(){if(this.props.uri)return b("React").createElement("a",{className:this.props.className,href:this.props.uri,onClick:this.$1},b("React").createElement(b("CssBackgroundImage.react"),{imageURI:this.props.uri,className:this.props.className,backgroundPosition:"center",style:{height:"100%"}},this.props.isSpherical?b("React").createElement("div",{className:"_3603 _64ks"}):null));else return b("React").createElement("a",{className:this.props.className,onClick:this.$1})};e.exports=a}),null);
__d("ChatPhotoViewFooterHScroll.react",["cx","Animation","MessengerSharedPhoto.react","React","SphericalPhotoUtils"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("SphericalPhotoUtils").getThumbnailsFromPhotoEncodings;c=b("React").PropTypes;var j=200,k=74,l=140,m=30;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.$1=null,this.state={currentPhoto:"",prevScrollLeft:0,scrollLeft:0},this.$2=function(a){return a?Math.ceil((a-l*2)/k):m},b}a.prototype.componentDidMount=function(){this.props.width&&this.props.updateNumberInOneBatch(this.$2(this.props.width)),this.$1=new(b("Animation"))(this.refs.childContainer).to("scrollLeft",0).duration(j).go()};a.prototype.UNSAFE_componentWillReceiveProps=function(a){if(a.photoID!=this.state.currentPhoto||this.props.sharedPhotos.length!==a.sharedPhotos.length){var b=a.width?(a.width-k)/2-l:0,c=a.sharedPhotos.findIndex(function(b){return b.node.id===a.photoID});this.setState({currentPhoto:a.photoID,prevScrollLeft:this.state.scrollLeft,scrollLeft:c*k-b})}a.width!=this.props.width&&this.props.updateNumberInOneBatch(this.$2(a.width))};a.prototype.componentDidUpdate=function(){this.$1&&this.$1.from("scrollLeft",this.state.prevScrollLeft).to("scrollLeft",this.state.scrollLeft).duration(j).go()};a.prototype.componentWillUnmount=function(){this.$1&&this.$1.stop()};a.prototype.shouldComponentUpdate=function(a,b){return a.photoID!=this.state.currentPhoto||a.sharedPhotos.length!==this.props.sharedPhotos.length?!0:!1};a.prototype.render=function(){__p&&__p();var a=this.props.sharedPhotos;a=a.map(function(a){var c,d=a.node.photo_encodings?a.node.photo_encodings.length!==0:!1;c=(c=a)!=null?(c=c.node)!=null?(c=c.image1)!=null?c.uri:c:c:c;if(d){var e=i(a.node.photo_encodings);e=e.smallThumbnail;c=e||c}return!c?null:b("React").createElement("div",{className:"_1oyb",key:a.node.legacy_attachment_id},b("React").createElement(b("MessengerSharedPhoto.react"),{className:"_1oyc"+(this.state.currentPhoto!==a.node.id?" _1oyd":""),fbid:a.node.legacy_attachment_id,onClick:this.props.onScroll,photoID:a.node.id,uri:c,isSpherical:d}))}.bind(this));return b("React").createElement("div",{className:"_1oye"},b("React").createElement("div",{className:"_1oyf",ref:"childContainer"},b("React").createElement("div",{className:"_1oyh",ref:"scrollable"},a)))};a.propTypes={onScroll:c.func,photoID:c.string,sharedPhotos:c.array,updateNumberInOneBatch:c.func,width:c.number};e.exports=a}),null);
__d("XForwardingNUXSeenController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/chat/forwarding_nux_seen/",{})}),null);
__d("MessagingForwardingButtonNUX.react",["AsyncRequest","ChatConfig","React","XForwardingNUXSeenController","XUIAmbientNUX.react"],(function(a,b,c,d,e,f){__p&&__p();var g;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);g=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=g.constructor).call.apply(a,[this].concat(e)),this.state={showNUX:!b("ChatConfig").get("seen_forwarding_nux")},this.$1=function(){if(!this.state.showNUX)return;b("ChatConfig").set("seen_forwarding_nux",!0);new(b("AsyncRequest"))(b("XForwardingNUXSeenController").getURIBuilder().getURI()).send();this.setState({showNUX:!1})}.bind(this),this.close=function(){this.$1()}.bind(this),c}a.prototype.render=function(){"use strict";return b("React").createElement(b("XUIAmbientNUX.react"),{contextRef:this.props.contextRef,onCloseButtonClick:this.$1,position:"left",width:"auto",shown:this.state.showNUX},this.props.children)};a.propTypes={contextRef:c.func.isRequired};e.exports=a}),null);
__d("MessengerPhotoViewCloseLink.react",["cx","fbt","React","TooltipLink.react"],(function(a,b,c,d,e,f,g,h){"use strict";a=b("React").PropTypes;c=function(a){var c=a.customTooltip!==undefined?a.customTooltip:b("React").createElement("span",null,h._("Nh\u1ea5n Esc \u0111\u1ec3 \u0111\u00f3ng"));return b("React").createElement(b("TooltipLink.react"),{className:"_51ok _50-m _51an",onClick:a.onClick,tooltip:c},b("React").createElement("div",{className:"_387s"}))};c.propTypes={onClick:a.func,customTooltip:a.element};e.exports=c}),null);
__d("SpotlightViewerBottomBarLink",["cx","Link.react","React"],(function(a,b,c,d,e,f,g){__p&&__p();var h;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){"use strict";var a=this.props.className||"_4_8j _4_8k";return b("React").createElement(b("Link.react"),babelHelpers["extends"]({},this.props,{className:a}),this.props.children)};function a(){"use strict";h.apply(this,arguments)}e.exports=a}),null);
__d("ChatPhotoViewHeader.react",["cx","fbt","MessagingForwardingButtonNUX.react","MessengerPhotoViewCloseLink.react","React","SpotlightViewerBottomBarLink","WorkModeConfig"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").PureComponent);i=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.$3=function(){this.$2(),this.props.showForwardDialog&&this.props.showForwardDialog()}.bind(this),this.$4=function(){this.$2(),this.props.showShareDialog&&this.props.showShareDialog()}.bind(this),b}a.prototype.render=function(){return b("React").createElement("div",{className:"_51an _50-m _3h_t _5l-3",role:"banner"},this.$1(),b("React").createElement(b("MessengerPhotoViewCloseLink.react"),{onClick:this.props.onClose}))};a.prototype.$2=function(){this.refs.forwardNUX&&this.refs.forwardNUX.close()};a.prototype.$1=function(){var a,c,d;this.props.disableForward||(a=b("React").createElement(b("SpotlightViewerBottomBarLink"),{className:"_3h_u",onClick:this.$3,ref:"forwardButton"},b("React").createElement("div",{className:"_3h_v _3h_w"}),h._("Chuy\u1ec3n ti\u1ebfp")),c=b("React").createElement(b("MessagingForwardingButtonNUX.react"),{contextRef:function(){return this.refs.forwardButton}.bind(this),ref:"forwardNUX"},h._("G\u1eedi h\u00ecnh \u1ea3nh n\u00e0y cho ng\u01b0\u1eddi kh\u00e1c b\u1eb1ng tin nh\u1eafn ri\u00eang.")));this.props.enableShareToFB&&(d=b("React").createElement("div",{className:"_3h_u",onClick:this.$4,ref:"shareButton",role:"button",tabIndex:"0"},b("React").createElement("div",{className:"_3tth _3h_w"}),this.$5()));return b("React").createElement("div",{key:"buttonsContainer",ref:"buttons"},b("React").createElement(b("SpotlightViewerBottomBarLink"),{className:"_3h_u",rel:"async",ajaxify:this.props.url,ref:"downloadButton"},b("React").createElement("div",{className:"_3h_x _3h_w"}),h._("T\u1ea3i xu\u1ed1ng")),a,c,d,b("React").createElement("div",{className:"_3h_u",onClick:this.props.openInfo,ref:"moreInfo",role:"link",tabIndex:"0"},b("React").createElement("div",{className:"_3h_y _3h_w"}),h._("Th\u00f4ng tin")))};a.prototype.$5=function(){if(b("WorkModeConfig").is_work_user)return h._("Chia s\u1ebb v\u1edbi Workplace");else return h._("Chia s\u1ebb v\u1edbi Facebook")};a.propTypes={disableForward:c.bool,enableShareToFB:c.bool,onClose:c.func,openInfo:c.func,showForwardDialog:c.func,showShareDialog:c.func,url:c.object};e.exports=a}),null);
__d("ChatSpeakingSticker.react",["React","ReactDOM"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").PureComponent);g=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=g.constructor).call.apply(a,[this].concat(e)),this.$1=function(){var a=b("ReactDOM").findDOMNode(this.refs.stickerVideo);a.play()}.bind(this),c}a.prototype.render=function(){return b("React").createElement("div",{onClick:this.$1,role:"presentation"},b("React").createElement("video",{height:this.props.videoSize.height,ref:"stickerVideo",width:this.props.videoSize.width},b("React").createElement("source",{src:this.props.videoURI})))};a.propTypes={videoURI:c.string.isRequired,videoSize:c.shape({height:c.number,width:c.number}).isRequired};e.exports=a}),null);
__d("EmojiSticker.react",["cx","Image.react","React","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.componentDidMount=function(){this.props.onAttachmentLoad&&this.props.onAttachmentLoad()};a.prototype.render=function(){var a=this.props.emojiImage?this.props.emojiImage:b("React").createElement(b("Image.react"),{src:this.props.sourceURI});return b("React").createElement("div",{"aria-label":this.props.emoji,className:b("joinClasses")(this.props.className,"_383m"),tabIndex:"0"},a)};function a(){h.apply(this,arguments)}a.propTypes={emoji:c.string,emojiImage:c.any,onAttachmentLoad:c.func,sourceURI:c.string.isRequired};e.exports=a}),null);
__d("MessengerErrorBoundary.react",["cx","fbt","ChatReliabilityInstrumentation","ErrorBoundary.react","LogHistory","React","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("LogHistory").getInstance("messenger_error_boundary"),k=function(a){return h._({"conversation list":"Kh\u00f4ng th\u1ec3 hi\u1ec3n th\u1ecb danh s\u00e1ch cu\u1ed9c tr\u00f2 chuy\u1ec7n.","conversation":"Kh\u00f4ng th\u1ec3 hi\u1ec3n th\u1ecb cu\u1ed9c tr\u00f2 chuy\u1ec7n.","composer":"Kh\u00f4ng th\u1ec3 hi\u1ec3n th\u1ecb tr\u00ecnh bi\u00ean so\u1ea1n.","conversation information":"Kh\u00f4ng th\u1ec3 hi\u1ec7n th\u1ecb th\u00f4ng tin v\u1ec1 cu\u1ed9c tr\u00f2 chuy\u1ec7n.","attachment":"Kh\u00f4ng th\u1ec3 hi\u1ec3n th\u1ecb t\u1ec7p \u0111\u00ednh k\u00e8m.","pinned conversation list":"Kh\u00f4ng th\u1ec3 hi\u1ec3n th\u1ecb danh s\u00e1ch cu\u1ed9c tr\u00f2 chuy\u1ec7n \u0111\u00e3 ghim."},[h._enum(a,{"conversation list":"conversation list",conversation:"conversation",composer:"composer","conversation information":"conversation information",attachment:"attachment","pinned conversation list":"pinned conversation list"})])},l=function(a,c){return function(){return b("React").createElement("div",{className:b("joinClasses")("_5jpt",c)},a)}};c=babelHelpers.inherits(a,b("React").Component);i=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$1=function(a,c){var d="React error in "+c+" got "+a.message;j.error(d,JSON.stringify(a));b("ChatReliabilityInstrumentation").logERROR(d);this.props.onHandleError&&this.props.onHandleError(a,c)}.bind(this),c}a.prototype.render=function(){var a=this.props,c=a.className,d=a.component;a=babelHelpers.objectWithoutProperties(a,["className","component"]);return b("React").createElement(b("ErrorBoundary.react"),babelHelpers["extends"]({},a,{fallbackComponent:l(k(d),c),onHandleError:this.$1,bigRedBox:!0}))};e.exports=a}),null);
__d("MercuryShareAttachment.react",["cx","BootloadedComponent.react","DOM","Event","MercuryShareAttachmentReactShape","MercuryShareAttachmentRenderLocations","MercuryShareStyleMap","MessengerErrorBoundary.react","React","ReactDOM","emptyFunction","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.$3=function(a){this.$1(a),b("DOM").scry(b("ReactDOM").findDOMNode(this),"img").forEach(function(a){var c=b("Event").listen(a,"load",function(){this.$1(a.height),c.remove()}.bind(this))}.bind(this))}.bind(this),c}a.prototype.componentDidMount=function(){this.$1()};a.prototype.$2=function(a,c){this.props.location===b("MercuryShareAttachmentRenderLocations").MESSENGER&&!this.props.isSubattachment&&(c=b("joinClasses")("_52mr _2poz _ui9","_4skb",c));return b("React").createElement("div",{className:c},a,this.props.afterDecorators)};a.prototype.render=function(){var a=b("MercuryShareStyleMap").getStyleFactory(this.props.attachment);if(!a)return null;var c=a.attachment;a=a.factory;return this.$2(b("React").createElement(b("MessengerErrorBoundary.react"),babelHelpers["extends"]({},this.props,{component:"attachment"}),b("React").createElement(b("BootloadedComponent.react"),babelHelpers["extends"]({},this.props,{attachment:c,bootloadLoader:a.componentLoader,bootloadPlaceholder:b("React").createElement("div",null),key:(c=this)!=null?(c=c.props)!=null?(c=c.attachment)!=null?c.share_id:c:c:c,module:a.componentName,onComponentLoad:this.$3}))),a.cx&&a.cx.get(this.props.location))};a.prototype.$1=function(a){this.props.onComponentLoaded(a)};a.propTypes={attachment:b("MercuryShareAttachmentReactShape"),isFromViewer:c.bool,isPageMessage:c.bool,isSponsored:c.bool,isSubattachment:c.bool,isVisible:c.bool,location:c.oneOf(b("MercuryShareAttachmentRenderLocations").getValues()),messageID:c.string,onComponentLoaded:c.func.isRequired,onSelect:c.func,pageID:c.string,threadID:c.string.isRequired,afterDecorators:c.array,timestamp:c.number,author:c.string};a.defaultProps={onComponentLoaded:b("emptyFunction")};e.exports=a}),null);
__d("MessengerErrorAttachment.react",["cx","fbt","CurrentUser","React"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.render=function(){var a=this.props.attachment.error_msg||h._("Kh\u00f4ng th\u1ec3 t\u1ea3i t\u1ec7p \u0111\u00ednh k\u00e8m n\u00e0y.");return b("React").createElement("div",{className:"_1o12 _52mr"},b("React").createElement("div",{className:"_1o13"},a,this.$1()))};a.prototype.$1=function(){return!this.props.attachment.error_msg&&b("CurrentUser").isEmployee()&&b("CurrentUser").hasWorkUser()&&!b("CurrentUser").isWorkUser()?b("React").createElement("div",null,h._("T\u1ec7p \u0111\u00ednh k\u00e8m c\u00f3 th\u1ec3 d\u00e0nh cho t\u00e0i kho\u1ea3n \u0040workplace c\u1ee7a b\u1ea1n.")):null};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("MessengerFileAttachment.react",["cx","Link.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").PureComponent);h&&h.prototype;a.prototype.render=function(){return b("React").createElement(b("Link.react"),{className:"_4pcn _2uf4",target:"_blank",href:this.props.attachment.url},b("React").createElement("div",{className:"_2uf5"}),this.props.attachment.name)};function a(){h.apply(this,arguments)}a.propTypes={attachment:c.object.isRequired};e.exports=a}),null);
__d("MessengerFromViewerUtils",["CurrentUser","MercuryIDs"],(function(a,b,c,d,e,f){"use strict";function a(a){return a.author===b("MercuryIDs").getParticipantIDFromUserID(b("CurrentUser").getID())}e.exports={isFromViewer:a}}),null);
__d("MessengerHotLikePreview.react",["cx","Animation","ChatConfig","EmojiLikeConstants","HotLikeSound","MessengerHotLikePreviewEvents","MessengerHotLikeSVG.react","MessengerHotLikeUtils","MessengerSupportedEmojiUtils","React","ReactDOM","StickerConstants","SubscriptionsHandler","gkx"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.$5=function(){this.$6=new(b("Animation"))(b("ReactDOM").findDOMNode(this)),b("ChatConfig").getBool("chat_tab_has_gradients")||(this.$7(-2,2,150,1e3),this.$7(-4,4,100,1e3),this.$7(-10,10,75,1e3)),this.$6.go()}.bind(this),this.$2=function(a,c){__p&&__p();var d=c?b("MessengerHotLikePreviewEvents").FINISH_EMOJI_ANIMATION:b("MessengerHotLikePreviewEvents").FINISH_ANIMATION;if(this.$8)return;this.$8=!0;c=Date.now()-this.props.since;var e=null;this.props.customLike&&(e=b("MessengerHotLikeUtils").getEmojiSizeForTime(c));var f=b("MessengerHotLikeUtils").getStickerIDForTime(c);b("HotLikeSound").snap(f);c=b("MessengerHotLikeUtils").getMetadataForHotLike(e||f);this.$6.stop();var g=30,h=-10;(f===b("StickerConstants").HOT_LIKE_SMALL_STICKER_ID||b("ChatConfig").getBool("chat_tab_has_gradients"))&&(g=0,h=0);this.$4.stop().to("width",c.width*1.2).to("height",c.height*1.2).to("rotateZ",g).duration(100).checkpoint().to("width",c.width*.9).to("height",c.height*.9).to("rotateZ",h).duration(100).checkpoint().to("width",c.width).to("height",c.height).to("rotateZ",0).duration(100).ondone(function(){this.props.forGameChat||b("MessengerHotLikePreviewEvents").emit(d,a,f,e)}.bind(this)).go()}.bind(this),this.$3=function(a){b("HotLikeSound").pop(),this.$4.stop().to("width",0).to("height",0).duration(100).ondone(function(){b("MessengerHotLikePreviewEvents").emit(b("MessengerHotLikePreviewEvents").REMOVE,a)}).go()}.bind(this),c}a.prototype.componentDidMount=function(){this.$1=new(b("SubscriptionsHandler"))(),this.$1.addSubscriptions(b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").STOP,this.$2),b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").STOP_EMOJI,this.$2),b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").POP,this.$3)),b("HotLikeSound").start(),this.$4=new(b("Animation"))(b("ReactDOM").findDOMNode(this)).to("width",80).to("height",80).duration(3e3).go(),this.$5()};a.prototype.componentWillUnmount=function(){this.$1&&this.$1.release()};a.prototype.render=function(){if(this.props.customLike){var a=this.props.customLike,c=b("MessengerSupportedEmojiUtils").getNewEmojiData(a.emoji,b("EmojiLikeConstants").size.LARGE);c=c?c.url:this.props.customLike.large;a.uri&&(c=a.uri);return b("React").createElement("div",{className:"_4a9g _383m",style:{backgroundImage:"url("+c+")"}})}return b("React").createElement("div",{className:"_4a9g _576q"},b("React").createElement(b("MessengerHotLikeSVG.react"),{color:this.props.customColor}))};a.prototype.$7=function(a,b,c,d){d=Math.floor(d/c);var e;for(var f=0;f<d;f++)e=f%2?a:b,this.$6.to("rotateZ",e).duration(c).checkpoint()};a.propTypes={customLike:c.object,forGameChat:c.bool,since:c.number};e.exports=a}),null);
__d("ChatSpeakingStickerReact.bs",["ReasonReact.bs","ChatSpeakingSticker.react"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d){return b("ReasonReact.bs").wrapJsForReason(b("ChatSpeakingSticker.react"),{videoURI:a,videoSize:c},d)}f.make=a}),null);
__d("MercuryAttachmentPayload.bs",[],(function(a,b,c,d,e,f){"use strict";function a(a,b,c){b=b?b[0]:null;return{app_attribution:null,attach_type:a,deduplication_key:null,description:null,icon_type:null,key:b,large_preview_height:null,large_preview_width:null,large_preview_url:null,media:null,metadata:null,message_file_fbid:null,name:null,photo_encodings:null,preview_height:null,preview_uploading:null,preview_url:null,preview_width:null,rel:null,share:null,source:null,target:null,thumbnail_url:null,upload_id:null,uri:null,url:c,video_title:null}}f.create=a}),null);
__d("MessengerAttachmentViewer",["Bootloader","MessagesViewer","React","Run","emptyFunction"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={renderVideo:function(a){b("Bootloader").loadModules(["MessagingVideoViewer.react","MessengerForwardAttachmentDialogReact.bs"],function(c,d){d=d.jsComponent;b("MessagesViewer").renderVideo(b("React").createElement(c,babelHelpers["extends"]({},a,{forwardDialogComponent:d})))},"MessengerAttachmentViewer")},bootstrapWithConfig:function(a,c){b("Bootloader").loadModules(["SpotlightMessagesViewer","MessengerForwardAttachmentDialogReact.bs"],function(d,e){e=e.jsComponent;b("MessagesViewer").renderSpotlight(a,c,d,e)},"MessengerAttachmentViewer")},preload:function(){b("Run").onAfterLoad(function(){b("Bootloader").loadModules(["MessagingVideoViewer.react","SpotlightMessagesViewer","MessengerForwardAttachmentDialogReact.bs"],b("emptyFunction"),"MessengerAttachmentViewer")})}};e.exports=a}),null);
__d("SphericalPhotoViewerInMessengerThreadBootloaded.react",["cx","BootloadedComponent.react","CssBackgroundImage.react","JSResource","PhotoProjection","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("PhotoProjection").PERSPECTIVE;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){__p&&__p();if(this.props.photoEncodings&&this.props.thumbnail){var a=this.props.photoEncodings.find(function(a){return a.projection_type===i}),c=null,d=null;if(a&&a.thumbnails&&a.thumbnails.length>0){a=a.thumbnails;c=a[0]?a[0].uri:null;d=a[1]?a[1].uri:null}if(this.props.useRenderer&&this.props.width&&this.props.height&&this.props.fbid){a=d||c||this.props.thumbnail;return b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("SphericalPhotoViewerInMessengerThreadWrapper.react").__setRef("SphericalPhotoViewerInMessengerThreadBootloaded.react"),bootloadPlaceholder:b("React").createElement(b("CssBackgroundImage.react"),{backgroundPosition:"center",imageURI:a,className:"_3v3t"}),height:this.props.height,width:this.props.width,fbid:this.props.fbid,thumbnail:a,photoEncodings:this.props.photoEncodings,isVisible:this.props.isVisible,onClickHandler:this.props.onClickHandler})}else{a=c||d||this.props.thumbnail;return b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("SphericalPhotoMessengerThumbnail.react").__setRef("SphericalPhotoViewerInMessengerThreadBootloaded.react"),bootloadPlaceholder:b("React").createElement(b("CssBackgroundImage.react"),{backgroundPosition:"center",imageURI:a,className:"_3v3t"}),photoEncodings:this.props.photoEncodings,thumbnail:a})}}return null};function a(){h.apply(this,arguments)}e.exports=a}),null);
__d("MessengerSphericalPhotoReact.bs",["Utils.bs","ReasonReact.bs","bs_js_null_undefined","SphericalPhotoViewerInMessengerThreadBootloaded.react"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e,f,g,h,i,j){return b("ReasonReact.bs").wrapJsForReason(b("SphericalPhotoViewerInMessengerThreadBootloaded.react"),{height:b("bs_js_null_undefined").fromOption(a),width:b("bs_js_null_undefined").fromOption(c),fbid:b("bs_js_null_undefined").fromOption(d),thumbnail:b("bs_js_null_undefined").fromOption(e),photoEncodings:b("bs_js_null_undefined").fromOption(f),isVisible:b("Utils.bs").optionBoolToBool(g),onClickHandler:h,useRenderer:i},j)}f.make=a}),null);
__d("MessengerPhotoReact.bs",["cx","fbt","bs_curry","React","Utils.bs","LinkReact.bs","cssURL","ImageReact.bs","ReasonReact.bs","joinClasses","bs_js_primitive","bs_caml_primitive","MercuryAttachmentType","MessengerSpinnerReact.bs","bs_caml_builtin_exceptions","MessengerSphericalPhotoReact.bs"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();function i(a,c){__p&&__p();var d=a.metadata;if(d==null)return null;else if(a.attach_type===b("MercuryAttachmentType").VIDEO){var e=c&&!(d.large_preview==null);if(e)return d.large_preview;else return d.inbox_preview}else if(c)return a.large_preview_url;else return a.preview_url}function j(a){if(a==null)return[null,null];else return[a.width,a.height]}function k(a){__p&&__p();var c=window.screen.width>1800;if(b("Utils.bs").isTruthy(a.preview_uploading)){var d=function(b,c){var a=!(b==null);if(a)return b;else return c},e=c&&!(a.large_preview_url==null);if(e)return[[d(a.large_preview_width,480),d(a.large_preview_height,480),a.large_preview_url,c]];else return[[d(a.preview_width,280),d(a.preview_height,280),a.preview_url,c]]}else{e=i(a,c);d=!(e==null);var f=a.metadata;if(d&&!(f==null)){d=c&&!(f.large_size==null);d=d?f.large_size:f.inbox_size;f=j(d);return[[f[0],f[1],e,c]]}else d=1;if(d===1)if(a.preview_url==null){f=a.media;if(f==null)return 0;else{e=!(f.playable==null)&&!(f.animated_image==null);if(e){d=j(f.animated_image_size);return[[d[0],d[1],f.animated_image,c]]}else{e=j(f.image_size);return[[e[0],e[1],f.image,c]]}}}else{d=c&&!(a.large_preview_url==null);if(d)return[[a.large_preview_width,a.large_preview_height,a.large_preview_url,c]];else return[[a.preview_width,a.preview_height,a.preview_url,c]]}}}function l(a){__p&&__p();var c=function(a){return[""+(String(a)+"")]};if(b("Utils.bs").isTruthy(a.preview_uploading)){var d=!(a.preview_url==null);return c(d?0:280)}else{var e=function(a){var b=a[1];a=a[0];if(!(a==null)&&!(b==null))return[[a,b]];else return 0};d=function(a){if(a){a=a[0];return e([a[0],a[1]])}else return 0};var f=!(a.media==null);f=f?d(k(a)):e([a.preview_width,a.preview_height]);if(f){d=f[0];return c(b("bs_caml_primitive").caml_float_min(d[1]*b("bs_caml_primitive").caml_float_min(1,450/d[0]),450))}else return 0}}function m(a,c,d,e,f){b("Utils.bs").isTruthy(e.preview_uploading);e=a[2];if(e==null||!f)return null;else{f=a[3];a=f?window.screen.height*.7:window.screen.height*.65;f={maxHeight:""+(String(a)+""),maxWidth:"100%",width:"100%"};return b("ReasonReact.bs").element(0,0,b("ImageReact.bs").make([b("joinClasses")(d,c?"":"_5pf5")],[""],0,0,[e],0,0,0,[f],[]))}}var n=b("ReasonReact.bs").statelessComponent("MessengerPhoto");function a(a,c,d,e,f,g,i){__p&&__p();var j=a?a[0]:"";return[n[0],n[1],n[2],n[3],function(){if(f)return b("bs_curry")._1(f[0],0);else return 0},n[5],n[6],n[7],function(){__p&&__p();var a=k(c);if(a){a=a[0];var f=c.attach_type===b("MercuryAttachmentType").ANIMATED_IMAGE,n=!(c.app_attribution==null),o=c.photo_encodings;o=o==null?!1:o.length!==0;var p=(!f||!d)&&!o;if(p){p=a[2];p=p==null?0:[b("cssURL")(p)];var q=d?l(c):0;p=[p,q]}else p=[0,0];q={};var r=p[0];r&&(q.backgroundImage=r[0]);r=p[1];r&&(q.minHeight=r[0]);p=q;r=b("Utils.bs").isTruthy(c.preview_uploading);q=r?b("ReasonReact.bs").element(0,0,b("MessengerSpinnerReact.bs").make(0,0,0,[])):null;r=f?[b("MercuryAttachmentType").ANIMATED_IMAGE]:0;var s=function(){if(g)return b("bs_curry")._1(g[0],c);else return 0},t=function(a){a.preventDefault();return s(0)};if(o){var u=a[2],v=c.metadata,w;if(v==null)w=0;else{v=v.fbid;w=v==null?0:[v]}v=c.photo_encodings;w=b("ReasonReact.bs").element(0,0,b("MessengerSphericalPhotoReact.bs").make([400],[400],w,u==null?0:[u],v==null?0:[v],e,s,d,[]))}else w=m(a,d&&f,(n?"_mxz":"")+(d&&!n?" _52mr":"")+(d&&!n?" _1byr":""),c,d);return b("React").cloneElement(b("React").createElement("div",{className:b("joinClasses")(j,"_4tsk"+(n?" _mxz":"")+(d&&!n?" _52mr":"")+(d&&!n?" _1byr":"")+(b("Utils.bs").isTruthy(c.preview_uploading)&&a[2]==null?" _3etv":"")+(o&&!d?" _3603":"")),role:"presentation",style:p,onClick:t}),{"data-testid":r},b("React").createElement("div",{className:o&&!d?"_64ks":""}),b("ReasonReact.bs").element(0,0,b("LinkReact.bs").make(0,0,[h._("M\u1edf \u1ea3nh")],["_4tsl"],0,0,0,0,0,b("bs_js_primitive").null_undefined_to_opt(a[2]),0,0,0,0,0,0,0,0,0,0,[i])),w,q)}else return null},n[9],n[10],n[11],n[12]]}c=280;d=480;e=1800;g=450;f.preview_thumbnail_size=c;f.preview_large_size=d;f.large_window_width=e;f.max_photo_width=g;f.getSrcFromAttachment=i;f.sizeToWidthHeight=j;f.extractPreviewMetadata=k;f.getMinHeightForAttachment=l;f.getImageFromMetadata=m;f.component=n;f.make=a}),null);
__d("MessengerThreadSharedMediaAfterWebGraphQLQuery",["WebGraphQLQueryBase"],(function(a,b,c,d,e,f){"use strict";__p&&__p();e.exports=function(){__p&&__p();var a;a=babelHelpers.inherits(c,b("WebGraphQLQueryBase"));a&&a.prototype;c.__getDocID=function(){"use strict";return"1668947383157276"};c.getQueryID=function(){"use strict";return"515216185516880"};function c(){"use strict";a.apply(this,arguments)}return c}()}),null);
__d("MessengerThreadSharedMediaBeforeWebGraphQLQuery",["WebGraphQLQueryBase"],(function(a,b,c,d,e,f){"use strict";__p&&__p();e.exports=function(){__p&&__p();var a;a=babelHelpers.inherits(c,b("WebGraphQLQueryBase"));a&&a.prototype;c.__getDocID=function(){"use strict";return"1712143858865110"};c.getQueryID=function(){"use strict";return"1694317194012102"};function c(){"use strict";a.apply(this,arguments)}return c}()}),null);
__d("MessengerThreadSharedMediaFindWebGraphQLQuery",["WebGraphQLQueryBase"],(function(a,b,c,d,e,f){"use strict";__p&&__p();e.exports=function(){__p&&__p();var a;a=babelHelpers.inherits(c,b("WebGraphQLQueryBase"));a&&a.prototype;c.__getDocID=function(){"use strict";return"1651653431616462"};c.getQueryID=function(){"use strict";return"162652081095038"};function c(){"use strict";a.apply(this,arguments)}return c}()}),null);
__d("MessengerSharedMediaReducer",["JSReliabilityFixesGatingConfig","MessengerSharedMediaActions","MessengerThreadSharedMediaHelper"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("MessengerSharedMediaActions").Types;function a(a,c){__p&&__p();switch(c.type){case g.LOAD_CURRENT:var d=a.get("sharedMedia").get(c.threadFBID);if(d){d=d.edges.find(function(a){return a.node.legacy_attachment_id===c.photoID});if(d)return a}d=a.get("isLoading").get(c.threadFBID);if(!!d&&d.curr)return a;d=l(a,c.threadFBID,"curr",!0);b("MessengerThreadSharedMediaHelper").search(c.threadFBID,c.photoID,function(a){return b("MessengerSharedMediaActions").currentLoaded(a)});return d}return a}function c(a,c){__p&&__p();switch(c.type){case g.LOAD_MORE_PREVIOUS:var d=a.get("isLoading").get(c.threadFBID);if(!!d&&d.prev)return a;d=l(a,c.threadFBID,"prev",!0);if(d===null)return a;b("MessengerThreadSharedMediaHelper").loadMorePrevious(c.threadFBID,c.afterCursor,c.first,function(a){return b("MessengerSharedMediaActions").previousLoaded(a)});return d}return a}function d(a,c){__p&&__p();switch(c.type){case g.LOAD_MORE_LATEST:var d=a.get("isLoading").get(c.threadFBID);if(!!d&&d.latest)return a;d=l(a,c.threadFBID,"latest",!0);if(d===null)return a;b("MessengerThreadSharedMediaHelper").loadMoreLatest(c.threadFBID,c.beforeCursor,c.last,function(a){return b("MessengerSharedMediaActions").latestLoaded(a)});return d}return a}function f(a,c){__p&&__p();var d;switch(c.type){case g.CURRENT_LOADED:c=c.data;var e=Object.keys(c)[0],f=b("JSReliabilityFixesGatingConfig").should_get_fix;d=f?(d=c[e])!=null?d.message_shared_media:d:c[e].message_shared_media;f=f?(c=d)!=null?(c=c.edges)!=null?c.length:c:c:d.edges.length;c=l(a,e,"curr",!1);if(f!==0){f=k(a.get("sharedMedia").get(e),d,0);f=a.get("sharedMedia").set(e,f);c=c.set("sharedMedia",f);f=d.edges[0];b("MessengerThreadSharedMediaHelper").loadMorePrevious(e,f.cursor,10,function(a){return b("MessengerSharedMediaActions").previousLoaded(a)});b("MessengerThreadSharedMediaHelper").loadMoreLatest(e,f.cursor,10,function(a){return b("MessengerSharedMediaActions").latestLoaded(a)})}return c}return a}function h(a,b){__p&&__p();switch(b.type){case g.PREVIOUS_LOADED:b=b.data;var c=Object.keys(b)[0];b=b[c].message_shared_media;var d=l(a,c,"prev",!1);b=k(a.get("sharedMedia").get(c),b,1);c=a.get("sharedMedia").set(c,b);d=d.set("sharedMedia",c);return d}return a}function i(a,b){__p&&__p();switch(b.type){case g.LATEST_LOADED:b=b.data;var c=Object.keys(b)[0];b=b[c].message_shared_media;var d=l(a,c,"latest",!1);b=k(a.get("sharedMedia").get(c),b,-1);c=a.get("sharedMedia").set(c,b);d=d.set("sharedMedia",c);return d}return a}function j(a,b){__p&&__p();switch(b.type){case g.DELETE_PHOTOS:var c=b.threadFBID;b=b.photoFBIDs;var d=a.get("sharedMedia").get(c);if(!d||!d.edges)break;var e=new Set(b.map(function(a){return a.toString()}));d.edges=d.edges.filter(function(a){return!e.has(a.node.legacy_attachment_id)});b=a.get("sharedMedia").set(c,d);c=a.set("sharedMedia",b);return c}return a}function k(a,b,c){__p&&__p();var d={};d.count=b.count;if(c===1&&a){var e=a.edges;d.has_previous_page=a.has_previous_page;d.has_next_page=b.page_info.has_next_page;b.edges.length>0?d.edges=e.concat(b.edges):d.edges=e}else if(c===-1&&a){e=a.edges;d.has_previous_page=b.page_info.has_previous_page;d.has_next_page=a.has_next_page;b.edges.length>0?d.edges=b.edges.concat(e):d.edges=e}else d.has_previous_page=b.page_info.has_previous_page,d.has_next_page=b.page_info.has_next_page,b.edges.length>0&&(d.edges=b.edges);return d}function l(a,b,c,d){var e=a.get("isLoading").get(b);e===undefined?(e={},e[c]=d):e[c]=d;c=a.set("isLoading",a.get("isLoading").set(b,e));return c}f={currentLoaded:f,deletePhotos:j,latestLoaded:i,loadCurrent:a,loadMoreLatest:d,loadMorePrevious:c,previousLoaded:h};e.exports=f}),null);
__d("MessengerSharedMediaState",["immutable"],(function(a,b,c,d,e,f){"use strict";var g;c={sharedMedia:b("immutable").Map({}),isLoading:b("immutable").Map({})};g=babelHelpers.inherits(a,b("immutable").Record(c));g&&g.prototype;function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("MessengerSharedMediaStore",["FluxReduceStore","MessengerFluxReduceDispatcher","MessengerSharedMediaActions","MessengerSharedMediaReducer","MessengerSharedMediaState"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=Object.keys(b("MessengerSharedMediaReducer"));g=babelHelpers.inherits(a,b("FluxReduceStore"));g&&g.prototype;a.prototype.getInitialState=function(){return new(b("MessengerSharedMediaState"))()};a.prototype.reduce=function(a,c){if(c.namespace!==b("MessengerSharedMediaActions").Namespace)return a;h.forEach(function(d){a=b("MessengerSharedMediaReducer")[d](a,c)});return a};function a(){g.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("MessengerFluxReduceDispatcher"))}),null);
__d("MessengerSharedPhotosAlbumViewPhotoReact.bs",["bs_curry","React","cssURL","ReasonReact.bs"],(function(a,b,c,d,e,f){"use strict";var g=b("ReasonReact.bs").statelessComponent("MessengerSharedPhotosAlbumViewPhotoReact");function a(a,c,d,e,f){return[g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],function(){return b("React").createElement("a",{className:a,style:{backgroundImage:b("cssURL")(e)},href:"#",onClick:function(){return b("bs_curry")._1(d,c)}},f)},g[9],g[10],g[11],g[12]]}f.component=g;f.make=a}),null);
__d("MessengerSharedPhotosAlbumViewVScrollReact.bs",["cx","bs_array","bs_curry","React","bs_string","ReactDOM","Animation","bs_caml_array","ReasonReact.bs","bs_caml_builtin_exceptions","MessengerSharedMediaActions","MessengerSharedPhotosAlbumViewPhotoReact.bs"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function h(a){var c=a[1],d=c.length;if(d<48){b("MessengerSharedMediaActions").loadMorePrevious(a[0],b("bs_caml_array").caml_array_get(c,c.length-1|0).cursor,48);return 0}else return 0}function i(a){if(a){a=a[0];return(a.scrollTop+a.clientHeight|0)>=(a.scrollHeight-20|0)}else throw b("bs_caml_builtin_exceptions").not_found}function j(a){if(a)return a[0].scrollTop<=20;else throw b("bs_caml_builtin_exceptions").not_found}function k(a){if(a)return a[0].clientHeight;else throw b("bs_caml_builtin_exceptions").not_found}function l(a,c){if(a){new(b("Animation"))(a[0]).to("scrollTop",c).duration(200).go();return 0}else return 0}function m(a){var c=a[2][0];if(c)return l(a[1][0],b("ReactDOM").findDOMNode(c[0]).offsetTop-70|0);else return 0}function n(a,c){__p&&__p();a=c[2];var d=a[3],e=a[1],f=a[0];c=c[1];var g=e.length;if(i(c[1][0]))if(g<a[2]&&!d.prev){b("MessengerSharedMediaActions").loadMorePrevious(f,b("bs_caml_array").caml_array_get(e,e.length-1|0).cursor,48);return 0}else return 0;else if(j(c[1][0])&&!d.latest){b("MessengerSharedMediaActions").loadMoreLatest(f,b("bs_caml_array").caml_array_get(e,0).cursor,48);return 0}else return 0}function o(a){__p&&__p();var c=a[1],d=c[1][0];if(d){var e=b("bs_curry")._1(a[0],n);d[0].addEventListener("scroll",e);b("bs_curry")._1(a[4],function(){var a=c[1][0];if(a)return a[0].removeEventListener("scroll",e);else return 0})}h(a[2]);d=function(){__p&&__p();if(k(c[3][0])>0){m(c);var a=c[0][0];if(a){clearInterval(a[0]);c[0][0]=0;return 0}else return 0}else return 0};c[0][0]=[setInterval(d,200)];return 0}function p(a){a=a[1][0][0];if(a){clearInterval(a[0]);return 0}else return 0}var q=b("ReasonReact.bs").reducerComponentWithRetainedProps("MessengerSharedPhotosAlbumViewVScrollReact");function r(a,b){b[1][1][0]=a==null?0:[a];return 0}function s(a,b){b[1][3][0]=a==null?0:[a];return 0}function t(a,b){b[1][2][0]=a==null?0:[a];return 0}function u(a,c,d,e,f,g,h){__p&&__p();var i=function(a){__p&&__p();return b("bs_array").map(function(d){__p&&__p();d=d.node;var e=d.photo_encodings;e=e==null?!1:e.length!==0;var f=d.photo_encodings;if(e&&!(f==null)){f=f.find(function(a){return a.projection_type==="perspective"});if(f!==undefined&&f.thumbnails.length!==0){f=f.thumbnails;f=b("bs_caml_array").caml_array_get(f,0).uri}else f=d.image1.uri}else f=d.image1.uri;var h=d.legacy_attachment_id===g;return b("ReasonReact.bs").element([d.legacy_attachment_id],h?[b("bs_curry")._1(a[0],t)]:0,b("MessengerSharedPhotosAlbumViewPhotoReact.bs").make("_3bly"+(e?" _3603":""),d.legacy_attachment_id,c,f,[b("React").createElement("div",{key:b("bs_string").concat("_",[d.legacy_attachment_id,["spherical_gradient",0]]),className:e?"_64ks":""})]))},d)};return[q[0],q[1],q[2],q[3],o,q[5],p,q[7],function(a){return b("React").createElement("div",{ref:b("bs_curry")._1(a[0],r),className:"_3xo8",onScroll:b("bs_curry")._1(a[0],n)},b("React").createElement("div",{ref:b("bs_curry")._1(a[0],s),className:"_3xoa"},i(a)))},function(){return[[0],[0],[0],[0]]},[e,d,f,a],function(a,b){return 0},q[12]]}a=b("ReasonReact.bs").wrapReasonForJs(q,function(a){return u(a.isLoading,a.onClick,a.sharedPhotos,a.threadID,a.totalCount,a.viewedPhoto,[])});c=200;d=48;e=6;g=20;var v=70;f.animationDuration=c;f.imagesToLoad=d;f.photosPerRow=e;f.scrollToEdgeTolerance=g;f.headerHeight=v;f.graduallyLoadPhotos=h;f.isScrolledToBottom=i;f.isScrolledToTop=j;f.getScrollHeight=k;f.scrollTo=l;f.autoScrollWhenLoaded=m;f.handleScroll=n;f.didMount=o;f.willUnmount=p;f.component=q;f.setRefChildContainer=r;f.setRefScrollable=s;f.setRefChild=t;f.make=u;f.jsComponent=a}),null);
__d("MessengerSharedPhotosAlbumView.react",["cx","fbt","MessengerPhotoViewCloseLink.react","MessengerSharedPhotosAlbumViewVScrollReact.bs","React","ShimButton.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("MessengerSharedPhotosAlbumViewVScrollReact.bs").jsComponent;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.$2=function(){this.props.onClick(this.props.viewedPhoto)}.bind(this),b}a.prototype.render=function(){return b("React").createElement("div",{className:"_3bl- _5l-3",ref:"window"},this.$1(),b("React").createElement(j,{isLoading:this.props.isLoading,onClick:this.props.onClick,sharedPhotos:this.props.sharedPhotos,threadID:this.props.threadID,totalCount:this.props.totalCount,viewedPhoto:this.props.viewedPhoto}))};a.prototype.$1=function(){return b("React").createElement("div",{className:"_3bm0 _5l-3",ref:"header"},b("React").createElement(b("ShimButton.react"),{className:"_3bm2",onClick:this.$2},b("React").createElement("div",{className:"_3bm3"}),h._("Quay l\u1ea1i \u1ea3nh")),b("React").createElement("div",{className:"_3bm4"},h._("\u1ea2nh \u0111\u00e3 chia s\u1ebb")),b("React").createElement(b("MessengerPhotoViewCloseLink.react"),{onClick:this.props.onCloseSharedPhotos}))};a.propTypes={onClick:c.func.isRequired,onCloseSharedPhotos:c.func.isRequired,sharedPhotos:c.arrayOf(c.object).isRequired,totalCount:c.number.isRequired,viewedPhoto:c.string.isRequired,threadID:c.string.isRequired,isLoading:c.object.isRequired};e.exports=a}),null);
__d("MessengerSharedPhotosAlbumViewContainer.react",["FluxContainer","MessengerSharedMediaStore","MessengerSharedPhotosAlbumView.react","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").PureComponent);g=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this.state={edges:[],count:0,isLoading:{}},b}a.getStores=function(){return[b("MessengerSharedMediaStore")]};a.calculateState=function(a,c){a=b("MessengerSharedMediaStore").getState();var d=a.sharedMedia;return{edges:d.get(c.threadID).edges,count:d.get(c.threadID).count,isLoading:a.isLoading.get(c.threadID)}};a.prototype.render=function(){return this.state.edges.length===0?null:b("React").createElement(b("MessengerSharedPhotosAlbumView.react"),{onClick:this.props.onClick,onCloseSharedPhotos:this.props.onCloseSharedPhotos,sharedPhotos:this.state.edges,totalCount:this.state.count,viewedPhoto:this.props.viewedPhoto,threadID:this.props.threadID,isLoading:this.state.isLoading})};a.propTypes={onClick:c.func.isRequired,onCloseSharedPhotos:c.func.isRequired,viewedPhoto:c.string.isRequired,threadID:c.string};e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("MessageShareType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({IMAGE:"image",PLATFORM_SHARE_CTA:"platform_share_CTA"})}),null);
__d("MessengerComposeViewHeaderReact.bs",["ReasonReact.bs","bs_js_null_undefined","MessengerComposeViewHeader.react"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e,f,g,h,i,j,k){return b("ReasonReact.bs").wrapJsForReason(b("MessengerComposeViewHeader.react"),{className:b("bs_js_null_undefined").fromOption(a),forceHideClearButton:c,onClear:b("bs_js_null_undefined").fromOption(d),onAddRecipient:e,onRemoveRecipient:f,onResize:g,recipients:h,viewer:i,isWorkUser:j},k)}f.make=a}),null);
__d("XMessagingForwardAttachmentController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/mercury/attachments/forward/",{})}),null);
__d("XMessengerPlatformShareCTAController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messages/platform/share/",{})}),null);
__d("MessengerForwardAttachmentDialogReact.bs",["ix","cx","fbt","bs_block","bs_curry","React","immutable","ImageReact.bs","CurrentUser","fbglyph","ReasonReact.bs","AsyncRequest","bs_js_primitive","MercuryLocalIDs","MessageShareType","MessengerDialogs.bs","MessengerDialogReact.bs","MessengerSpinnerReact.bs","MessengerDialogBodyReact.bs","MessengerComposeViewHeaderReact.bs","XMessengerPlatformShareCTAController","XMessagingForwardAttachmentController"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=i._("G\u1eedi"),k=b("ReasonReact.bs").reducerComponent("MessengerForwardAttachmentDialogReact");function l(a,c,d){new(b("AsyncRequest"))(a.getURIBuilder().getURI()).setMethod("POST").setHandler(d).setData(c).send();return 0}function m(a,c,d,e,f,h,m){__p&&__p();var n=function(a){if(a)return 0;else{b("MessengerDialogs.bs").removeDialog(0);return b("bs_curry")._1(c,0)}},o=function(c,e){__p&&__p();var f=e[3];c=function(a){if(a.payload.success)return b("bs_curry")._1(f,2);else return b("bs_curry")._1(f,b("bs_block").__(2,[b("bs_js_primitive").null_undefined_to_opt(a.payload.error)]))};var g={};e[1][0].forEach(function(c,a,d){g[String(b("MercuryLocalIDs").generateOfflineThreadingID(undefined))]=c.getUniqueID();return!0});var i=0;h&&d&&h[0]===b("MessageShareType").PLATFORM_SHARE_CTA?l(b("XMessengerPlatformShareCTAController"),{cta_id:a,message_id:d[0],recipient_map:g},c):i=1;i===1&&l(b("XMessagingForwardAttachmentController"),{attachment_id:a,recipient_map:g},c);return b("bs_curry")._1(e[3],1)};return[k[0],k[1],k[2],k[3],k[4],k[5],k[6],k[7],function(a){__p&&__p();var c=a[1],d=c[2],h=c[1];if(d)d=b("React").createElement("div",undefined,b("ReasonReact.bs").element(0,0,b("MessengerSpinnerReact.bs").make(0,0,0,[])),b("React").createElement("span",{className:"_1e1n _3-99"},i._("\u0110ang g\u1eedi")));else if(h){var k=g("141787");d=b("React").createElement("div",{className:"_1e1n"},b("ReasonReact.bs").element(0,0,b("ImageReact.bs").make(0,0,0,0,[k],0,0,0,0,[])),b("React").createElement("span",{className:"_3-99"},h[0]))}else d=null;return b("ReasonReact.bs").element(0,0,b("MessengerDialogReact.bs").Dialog[0](0,[n],0,[e],0,0,[560],[b("ReasonReact.bs").element(0,0,b("MessengerDialogReact.bs").Header[0](0,0,b("ReasonReact.bs").element(0,0,b("MessengerDialogReact.bs").Title[0](0,[f])))),b("ReasonReact.bs").element(0,0,b("MessengerDialogBodyReact.bs").make(0,[b("ReasonReact.bs").element(0,0,b("MessengerComposeViewHeaderReact.bs").make(["_1e1o"],!1,[function(){return b("bs_curry")._1(a[3],0)}],function(c){return b("bs_curry")._1(a[3],b("bs_block").__(0,[c]))},function(c){return b("bs_curry")._1(a[3],b("bs_block").__(1,[c]))},function(){return 0},c[0],b("CurrentUser").getID(),b("CurrentUser").isWorkUser(),[]))])),b("ReasonReact.bs").element(0,0,b("MessengerDialogReact.bs").Footer[0](0,[d],[b("ReasonReact.bs").element(0,0,b("MessengerDialogReact.bs").CancelButton[0](0,[])),b("ReasonReact.bs").element(0,0,b("MessengerDialogReact.bs").Button[0]([2],[j],[c[0].isEmpty()||c[2]],0,[b("bs_curry")._1(a[0],o)],[0],0,0,[]))]))]))},function(){return[b("immutable").List([]),0,!1]},k[10],function(a){__p&&__p();if(typeof a==="number")switch(a){case 0:return function(a){return b("bs_block").__(0,[[b("immutable").List([]),a[1],a[2]]])};case 1:return function(a){return b("bs_block").__(0,[[a[0],0,!0]])};case 2:b("bs_curry")._1(c,0);return function(){return b("bs_block").__(0,[[b("immutable").List([]),0,!1]])}}else switch(a.tag|0){case 0:var d=a[0];return function(a){return b("bs_block").__(0,[[a[0].push(d),a[1],a[2]]])};case 1:var e=a[0];return function(a){return b("bs_block").__(0,[[a[0].filter(function(a){return a!==e}),a[1],a[2]]])};case 2:var f=a[0];return function(a){return b("bs_block").__(0,[[a[0],f,!1]])}}},k[12]]}a=b("ReasonReact.bs").wrapReasonForJs(k,function(a){return m(a.attachmentID,a.onClose,b("bs_js_primitive").null_undefined_to_opt(a.messageID),a.shown,a.title,b("bs_js_primitive").null_undefined_to_opt(a.shareType),[])});f.sendButtonLabel=j;f.component=k;f.sendData=l;f.make=m;f.jsComponent=a}),null);
__d("MessengerPhotoInfoDialog.react",["cx","fbt","MercuryIDs","MercuryTimestamp","MessengerContactImageReact.bs","MessengerDialog.react","MessengerDialogButton.react","MessengerDialogHeader.react","MessengerDialogs.bs","MessengerDialogTitle.react","MessengerEnvironment","MessengerParticipants.bs","MessengerSpinner.react","React","RelayClassic_DEPRECATED","XUIDialog.react","XUIDialogHeader.react","XUIDialogHeaderTitle.react","react-relay/classic/query/RelayQL"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("MessengerContactImageReact.bs").jsComponent;c=b("React").PropTypes;var k=54;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$5=function(event){event.preventDefault(),this.props.showHeader&&this.props.showHeader(),b("MessengerDialogs.bs").removeDialog()}.bind(this),this.$4=function(a){a||(this.props.showHeader&&this.props.showHeader(),this.props.closeInfo())}.bind(this),c}a.prototype.render=function(){return!this.props.fullMedia?null:b("MessengerEnvironment").messengerui?this.$1():this.$2()};a.prototype.$3=function(){var a=this.props.fullMedia;a=a.creator;return a?a.name:b("MessengerParticipants.bs").getDefaultName().toString()};a.prototype.$1=function(){var a=this.props.fullMedia;return b("React").createElement(b("MessengerDialog.react"),{onToggle:this.$4,ref:"dialog",type:"default",width:504},b("React").createElement(b("MessengerDialogHeader.react"),null,b("React").createElement(b("MessengerDialogTitle.react"),null,h._("Th\u00f4ng tin")),b("React").createElement(b("MessengerDialogButton.react"),{action:"cancel",label:h._("Xong"),onClick:this.$5,type:"primary"})),b("React").createElement("div",{className:"_2zn1"},b("React").createElement("div",{className:"_2zn2"},h._("\u0110\u01b0\u1ee3c t\u1ea3i l\u00ean b\u1edfi")),b("React").createElement("div",{className:"_2zn4"},b("React").createElement("div",{className:"_2zn5"},this.$3()),b("React").createElement("div",{className:"_2zn6"},b("MercuryTimestamp").getPreciseTimestamp(a.creation_time*1e3))),b("React").createElement("div",{className:"_2zn7"},this.showProfilePic())),this.$6(),this.$7())};a.prototype.$2=function(){var a=this.props.fullMedia;return b("React").createElement(b("XUIDialog.react"),{onToggle:this.$4,shown:this.props.infoOpen,ref:"dialog",type:"serif",width:504},b("React").createElement(b("XUIDialogHeader.react"),null,b("React").createElement(b("XUIDialogHeaderTitle.react"),null,h._("Th\u00f4ng tin"))),b("React").createElement("div",{className:"_2zn1"},b("React").createElement("div",{className:"_2zn2"},h._("\u0110\u01b0\u1ee3c t\u1ea3i l\u00ean b\u1edfi")),b("React").createElement("div",{className:"_2zn4"},b("React").createElement("div",{className:"_2zn5"},this.$3()),b("React").createElement("div",{className:"_2zn6"},b("MercuryTimestamp").getPreciseTimestamp(a.creation_time*1e3))),b("React").createElement("div",{className:"_2zn7"},this.showProfilePic())),this.$6(),this.$7())};a.prototype.$7=function(){__p&&__p();var a=this.props.fullMedia.exif_data,c="";if(a){a.aperture&&(c=a.aperture+" ");if(a.focal_length){var d=a.focal_length.split("/");d=parseInt(d[0],10)/(parseInt(d[1],10)||1);c+=d+"mm "}a.iso&&(c+="ISO "+a.iso)}return!c.length?null:b("React").createElement("div",{className:"_2zn1"},b("React").createElement("div",{className:"_2zn2"},h._("M\u00e1y \u1ea3nh")),b("React").createElement("div",{className:"_2zn4"},b("React").createElement("div",{className:"_2zn5"},a.model||"Camera"),b("React").createElement("div",{className:"_2zn6"},c)))};a.prototype.$6=function(){var a=this.props.fullMedia,c="";a.filesize>1e6?c=(a.filesize/1e6).toFixed(2)+"MB":a.filesize>1e3?c=(a.filesize/1e3).toFixed(2)+"KB":a.filesize>0&&(c=a.filesize+"B");var d=a.__typename==="MessageImage"?(a.original_dimensions.x*a.original_dimensions.y/1e6).toFixed(2)+"MP":"";return b("React").createElement("div",{className:"_2zn1"},b("React").createElement("div",{className:"_2zn2"},h._("Chi ti\u1ebft")),b("React").createElement("div",{className:"_2zn4"},b("React").createElement("div",{className:"_2zn5"},a.filename),b("React").createElement("div",{className:"_2zn6"},d+" "+a.original_dimensions.x+" x "+a.original_dimensions.y+" "+c)))};a.prototype.showProfilePic=function(){__p&&__p();var a=this.props.fullMedia;if(!a)return b("React").createElement(b("MessengerSpinner.react"),null);else{a=a.creator;if(!a)return b("React").createElement(b("MessengerSpinner.react"),null);a=b("MercuryIDs").getParticipantIDFromUserID(a.id);a=b("MessengerParticipants.bs").getNow(a);return a?b("React").createElement(j,{isMessengerUser:a.is_messenger_user,size:k,src:a.big_image_src||a.image_src}):b("React").createElement(b("MessengerSpinner.react"),null)}};a.propTypes={closeInfo:c.func,fullMedia:c.object,infoOpen:c.bool,photoID:c.string,showHeader:c.func};e.exports=b("RelayClassic_DEPRECATED").createContainer(a,{fragments:{fullMedia:function(a){return function(){return{children:[{fieldName:"__typename",kind:"Field",metadata:{isRequisite:!0},type:"String"},{fieldName:"id",kind:"Field",metadata:{isRequisite:!0},type:"ID"},{children:[{fieldName:"creation_time",kind:"Field",metadata:{},type:"Time"},{children:[{fieldName:"id",kind:"Field",metadata:{isRequisite:!0},type:"ID"},{fieldName:"name",kind:"Field",metadata:{},type:"String"},{fieldName:"__typename",kind:"Field",metadata:{isGenerated:!0,isRequisite:!0},type:"String"}],fieldName:"creator",kind:"Field",metadata:{canHaveSubselections:!0,inferredRootCallName:"node",inferredPrimaryKey:"id",isAbstract:!0},type:"Actor"},{fieldName:"filename",kind:"Field",metadata:{},type:"String"},{children:[{fieldName:"x",kind:"Field",metadata:{},type:"Float"},{fieldName:"y",kind:"Field",metadata:{},type:"Float"}],fieldName:"original_dimensions",kind:"Field",metadata:{canHaveSubselections:!0},type:"Vect2"},{fieldName:"filesize",kind:"Field",metadata:{},type:"Int"},{children:[{fieldName:"iso",kind:"Field",metadata:{},type:"Int"},{fieldName:"aperture",kind:"Field",metadata:{},type:"String"},{fieldName:"focal_length",kind:"Field",metadata:{},type:"String"},{fieldName:"model",kind:"Field",metadata:{},type:"String"}],fieldName:"exif_data",kind:"Field",metadata:{canHaveSubselections:!0},type:"MessageImageExifData"},{fieldName:"id",kind:"Field",metadata:{isGenerated:!0,isRequisite:!0},type:"ID"}],id:b("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{},name:"MessageImage",type:"MessageImage"},{children:[{fieldName:"creation_time",kind:"Field",metadata:{},type:"Time"},{children:[{fieldName:"id",kind:"Field",metadata:{isRequisite:!0},type:"ID"},{fieldName:"name",kind:"Field",metadata:{},type:"String"},{fieldName:"__typename",kind:"Field",metadata:{isGenerated:!0,isRequisite:!0},type:"String"}],fieldName:"creator",kind:"Field",metadata:{canHaveSubselections:!0,inferredRootCallName:"node",inferredPrimaryKey:"id",isAbstract:!0},type:"Actor"},{fieldName:"filename",kind:"Field",metadata:{},type:"String"},{children:[{fieldName:"x",kind:"Field",metadata:{},type:"Float"},{fieldName:"y",kind:"Field",metadata:{},type:"Float"}],fieldName:"original_dimensions",kind:"Field",metadata:{canHaveSubselections:!0},type:"Vect2"},{fieldName:"id",kind:"Field",metadata:{isGenerated:!0,isRequisite:!0},type:"ID"}],id:b("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{},name:"MessageVideo",type:"MessageVideo"}],id:b("react-relay/classic/query/RelayQL").__id(),kind:"Fragment",metadata:{isAbstract:!0},name:"MessengerPhotoInfoDialog_FullMediaRelayQL",type:"Node"}}()}}})}),null);
__d("SpotlightMessagesViewerContainerRoute",["react-relay/classic/query/RelayQL","react-relay/classic/route/RelayRoute"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("react-relay/classic/route/RelayRoute"));g&&g.prototype;function a(){g.apply(this,arguments)}a.routeName="SpotlightMessagesViewerContainerRoute";a.paramDefinition={photoID:{type:"String",required:!0}};a.queries={fullMedia:function(a){return function(a){return{calls:[{kind:"Call",metadata:{type:"ID!"},name:"id",value:{kind:"CallVariable",callVariableName:"photoID"}}],children:[].concat.apply([],[{fieldName:"id",kind:"Field",metadata:{isGenerated:!0,isRequisite:!0},type:"ID"},{fieldName:"__typename",kind:"Field",metadata:{isGenerated:!0,isRequisite:!0},type:"String"},b("react-relay/classic/query/RelayQL").__frag(a)]),fieldName:"node",kind:"Query",metadata:{isAbstract:!0,identifyingArgName:"id",identifyingArgType:"ID!"},name:"SpotlightMessagesViewerContainerRoute",type:"Node"}}(a.getFragment("fullMedia"))}};e.exports=a}),null);
__d("MessengerPhotoInfoDialogContainer.react",["MessengerPhotoInfoDialog.react","React","SpotlightMessagesViewerContainerRoute","react-relay/classic/container/RelayRootContainer"],(function(a,b,c,d,e,f){"use strict";a=b("React").PropTypes;c=b("React").createClass({displayName:"MessengerPhotoInfoDialogContainer",proptypes:{photoID:a.string.isRequired,showHeader:a.func},render:function(){var a=new(b("SpotlightMessagesViewerContainerRoute"))({photoID:this.props.photoID});return b("React").createElement(b("react-relay/classic/container/RelayRootContainer"),{Component:b("MessengerPhotoInfoDialog.react"),route:a,renderFetched:function(a){return b("React").createElement(b("MessengerPhotoInfoDialog.react"),babelHelpers["extends"]({},a,{closeInfo:this.props.closeInfo,photoID:this.props.photoID,infoOpen:this.props.infoOpen,showHeader:this.props.showHeader}))}.bind(this)})}});e.exports=c}),null);
__d("MessengerPhotoViewBottomBar.react",["cx","React"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){return b("React").createElement("div",{className:"_51an _50-m _16zz"},a.children)};e.exports=a}),null);
__d("MessengerPhotoViewHScroll.react",["cx","Animation","MessengerSharedPhoto.react","React","SphericalPhotoUtils"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("SphericalPhotoUtils").getThumbnailsFromPhotoEncodings,j=200,k=80;c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.$1=null,b}a.prototype.componentDidMount=function(){this.$2()};a.prototype.componentDidUpdate=function(){this.$2()};a.prototype.componentWillUnmount=function(){this.$1&&this.$1.stop(),this.$1=null};a.prototype.render=function(){__p&&__p();var a=this.props.sharedPhotos;a=a.reduce(function(a,c){__p&&__p();var d=c.node.image1===null?c.node.image:c.node.image1,e=c.node.photo_encodings?c.node.photo_encodings.length!==0:!1;if(d){d=d.uri;if(e){var f=i(c.node.photo_encodings);f=f.smallThumbnail;d=f||d}a.push(b("React").createElement("div",{className:"_4dy9",key:c.node.legacy_attachment_id},b("React").createElement(b("MessengerSharedPhoto.react"),{className:"_42rl"+(this.props.photoID!==c.node.legacy_attachment_id?" _q1a":""),fbid:c.node.legacy_attachment_id,onClick:this.props.onScroll,uri:d,isSpherical:e})))}return a}.bind(this),[]);var c=(this.props.width-k)/2;return b("React").createElement("div",{className:"_463g"},b("React").createElement("div",{className:"_463h",ref:"childContainer"},b("React").createElement("div",{className:"_463j",style:{paddingLeft:c,paddingRight:c},ref:"scrollable"},a)))};a.prototype.$2=function(){var a=this.refs.childContainer?this.refs.childContainer.scrollLeft:0,c=this.props.sharedPhotos.findIndex(function(a){return a.node.legacy_attachment_id===this.props.photoID}.bind(this));c=c*k;this.$1||(this.$1=new(b("Animation"))(this.refs.childContainer));this.$1.from("scrollLeft",a).to("scrollLeft",c).duration(j).go()};e.exports=a}),null);
__d("MessengerPhotoViewHeader.react",["cx","fbt","MessagingForwardingButtonNUX.react","MessengerPhotoViewCloseLink.react","React","SpotlightViewerBottomBarLink"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").PureComponent);i=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.$3=function(){this.refs.forwardNUX&&this.refs.forwardNUX.close(),this.props.showForwardDialog&&this.props.showForwardDialog()}.bind(this),b}a.prototype.render=function(){return b("React").createElement("div",{className:"_51an _50-m _3c1i _5l-3",role:"banner"},this.$1(),this.$2())};a.prototype.$2=function(){return b("React").createElement(b("MessengerPhotoViewCloseLink.react"),{onClick:this.props.onClose})};a.prototype.$1=function(){var a,c;this.props.disableForward||(a=b("React").createElement(b("SpotlightViewerBottomBarLink"),{className:"_3c1o",onClick:this.$3,ref:"forwardButton"},b("React").createElement("div",{className:"_2msr _3oo2"}),h._("Chuy\u1ec3n ti\u1ebfp")),c=b("React").createElement(b("MessagingForwardingButtonNUX.react"),{contextRef:function(){return this.refs.forwardButton}.bind(this),ref:"forwardNUX"},h._("G\u1eedi h\u00ecnh \u1ea3nh n\u00e0y cho ng\u01b0\u1eddi kh\u00e1c b\u1eb1ng tin nh\u1eafn ri\u00eang.")));return b("React").createElement("div",{key:"buttonsContainer",ref:"buttons"},b("React").createElement(b("SpotlightViewerBottomBarLink"),{ajaxify:this.props.url,className:"_3c1o",rel:"async"},b("React").createElement("div",{className:"_3ooo _2msr"}),h._("T\u1ea3i xu\u1ed1ng")),a,c,b("React").createElement(b("SpotlightViewerBottomBarLink"),{className:"_3c1o",href:"#",onClick:this.props.openInfo,ref:"moreInfo"},b("React").createElement("div",{className:"_3c1k _2msr"}),h._("Th\u00f4ng tin")))};a.propTypes={disableForward:c.bool,onClose:c.func,openInfo:c.func,photoID:c.string,showForwardDialog:c.func,url:c.object};e.exports=a}),null);
__d("XMessagingVideoAttachmentController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/mercury/attachments/video/",{video_id:{type:"String",required:!0},video_container_id:{type:"String",required:!0},width:{type:"Int",required:!0},height:{type:"Int",required:!0},start_muted:{type:"Bool",defaultValue:!1},no_fullscreen:{type:"Bool",defaultValue:!1},load_player_controller:{type:"Bool",defaultValue:!1},hide_controls_on_finish:{type:"Bool",defaultValue:!1},hide_url_menu_option:{type:"Bool",defaultValue:!1},is_share:{type:"Bool",defaultValue:!1},render_play_button:{type:"Bool",defaultValue:!1},start_timestamp:{type:"Int",defaultValue:0}})}),null);
__d("MessengerVideoPlayer.react",["cx","ActorURI","AsyncRequest","BackgroundImage.react","Event","FullScreen","MessengerSpinner.react","React","ShimButton.react","SpotlightMercurySharedMediaViewer.react","SubscriptionsHandler","Vector","VideoPlayerReason","VideoPlayerReasonTransitionHelper","VideoPlayerStates","XMessagingVideoAttachmentController","cssURL","getFullScreenElement","guid","joinClasses","setImmediate"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;var i="_ox1";d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(a){__p&&__p();h.constructor.call(this,a),this.$2=!0,this.$3=[],this.$4=-1,this.$5=!1,this.$6=!1,this.state={playerAPI:null,forcePause:!1},this.$10=function(a){if(!this.isVideoClicked(a))return;a.preventDefault();this.props.isOnStage?(a.stopPropagation(),this.isState(b("VideoPlayerStates").PLAYING)?this.pause(b("VideoPlayerReason").USER):this.play(b("VideoPlayerReason").USER)):(this.pause(b("VideoPlayerReason").USER),this.props.onClick&&this.props.onClick())}.bind(this),this.$11=function(a){if(!this.isRightClick(a))return;a.stopPropagation();a.preventDefault();b("setImmediate")(function(){this.props.onSelect&&this.props.onSelect()}.bind(this))}.bind(this),this.$8=function(){if(!this.$2||this.state.forcePause)return;this.$6&&(this.play(new(b("VideoPlayerReasonTransitionHelper"))(b("VideoPlayerReason").PAGE_VISIBILITY)),this.$6=!1)}.bind(this),this.$7=function(){if(!this.$2||this.state.forcePause||!(this.state.playerAPI&&this.state.playerAPI.isMuted()))return;this.$6=!!this.state.playerAPI&&this.state.playerAPI.isState(b("VideoPlayerStates").PLAYING);this.pause()}.bind(this),this.$1=b("guid")(),this.props.isInThread&&(this.listeners=new(b("SubscriptionsHandler"))(),this.listeners.addSubscriptions(b("Event").listen(window,"blur",this.$7),b("Event").listen(window,"focus",this.$8)))}a.prototype.shouldComponentUpdate=function(a){var c=document.getElementById(this.$1.toString()),d=b("FullScreen").isFullScreen();if(c!=null&&d&&c.children[0].children[0]===b("getFullScreenElement")())return!1;d=!!(a.stageDimensions&&a.stageDimensions!==this.props.stageDimensions);d&&(this.$4=this.getCurrentTimePosition(),this.$5=!this.isState(b("VideoPlayerStates").PLAYING));return!this.props.videoData||a.videoData.id!==this.props.videoData.id||d};a.prototype.UNSAFE_componentWillReceiveProps=function(a){if(!this.$2)return;this.props.isInThread&&a.isVisible!==this.props.isVisible&&(a.isVisible&&!this.state.forcePause?this.play(new(b("VideoPlayerReasonTransitionHelper"))(b("VideoPlayerReason").VIDEO_VISIBILITY)):this.pause())};a.prototype.componentDidMount=function(){this.props.videoData&&this.$9()};a.prototype.componentDidUpdate=function(){this.$3.forEach(function(a){return a.abandon()}),this.$3=[],this.props.videoData&&this.$9()};a.prototype.componentWillUnmount=function(){this.pause(b("VideoPlayerReason").UNLOADED),this.seek(0),this.$3.forEach(function(a){return a.abandon()}),this.listeners&&this.listeners.release(),this.state.playerAPI&&this.state.playerAPI.detachRootNode(),this.state.playerAPI&&this.state.playerAPI.destroy&&this.state.playerAPI.destroy()};a.prototype.isVideoLoaded=function(){var a=!!this.state.playerAPI;a||!1;return this.isState(b("VideoPlayerStates").FALLBACK)?!1:a};a.prototype.isVideoClicked=function(a){return a.target instanceof HTMLElement?a.target.classList.contains(i):!1};a.prototype.isRightClick=function(a){a=a||window.event;return a.button===2};a.prototype.play=function(a){if(!this.isVideoLoaded())return;this.state.playerAPI&&this.state.playerAPI.play(a)};a.prototype.pause=function(a){if(!this.isVideoLoaded())return;this.state.playerAPI&&this.state.playerAPI.pause(a)};a.prototype.seek=function(a){if(!this.isVideoLoaded())return;this.state.playerAPI&&this.state.playerAPI.seek(a)};a.prototype.getCurrentTimePosition=function(){return this.isVideoLoaded()&&this.state.playerAPI?this.state.playerAPI.getCurrentTimePosition():-1};a.prototype.render=function(){var a=this.props.videoData,c=b("React").createElement("div",{ref:"placeholder"},b("React").createElement(b("MessengerSpinner.react"),{color:"blue",size:b("MessengerSpinner.react").large_size})),d={};if(a&&a.url){var e=a.original_dimensions;d.backgroundImage=b("cssURL")(a.url);c=b("React").createElement("div",{ref:"placeholder"},b("React").createElement(b("BackgroundImage.react"),{className:this.props.className,width:e.x,height:e.y,loadingIndicatorStyle:"large",backgroundSize:"cover",ref:"placeholder",style:d,src:a.url}))}return b("React").createElement(b("ShimButton.react"),{className:b("joinClasses")(this.props.className,"_4-od"),id:this.$1,onClick:this.$10,onMouseDown:this.$11,style:d},c)};a.prototype.$9=function(){__p&&__p();var a=this.props.videoData;if(a){var c=a.original_dimensions;this.props.stageDimensions&&(c=b("SpotlightMercurySharedMediaViewer.react").getImageDimensionsForStage(new(b("Vector"))(a.original_dimensions.x,a.original_dimensions.y),this.props.stageDimensions));c=b("XMessagingVideoAttachmentController").getURIBuilder().setString("video_id",a.legacy_attachment_id).setString("video_container_id",this.$1).setInt("width",c.x).setInt("height",c.y).setInt("start_timestamp",this.$4>0?Math.round(this.$4):0).setBool("start_muted",a.start_muted).setBool("no_fullscreen",a.no_fullscreen).setBool("load_player_controller",!0).setBool("hide_controls_on_finish",a.hide_controls_on_finish).setBool("hide_url_menu_option",Boolean(a.hide_url_menu_option)).setBool("is_share",a.is_share).setBool("render_play_button",this.props.isInThread).getURI();a=this.props.attachment;a&&a.metadata&&a.metadata.pageid&&(c=b("ActorURI").create(c,a.metadata.pageid));a=new(b("AsyncRequest"))();this.$3.push(a);a.setMethod("GET").setStatusElement(this.refs.placeholder).setURI(c).setRelativeTo(this).setReadOnly(!0).setHandler(function(a){}).send()}};a.prototype.$12=function(){this.props.isVisible&&this.isState(b("VideoPlayerStates").FINISHED)?(this.seek(0),this.play(b("VideoPlayerReason").LOOP)):this.props.isVisible&&this.isState(b("VideoPlayerStates").PAUSED)&&!this.$6?this.setState({forcePause:!0}):this.isState(b("VideoPlayerStates").PLAYING)&&this.setState({forcePause:!1})};a.prototype.onVideoLoaded=function(){if(!this.$2)return;this.state.playerAPI&&this.state.playerAPI.addListener("stateChange",function(){return this.$12()}.bind(this));this.props.isVisible&&!this.$5&&!this.state.forcePause?this.play(b("VideoPlayerReason").AUTOPLAY):this.pause();this.$4=-1;this.$5=!1};a.prototype.isState=function(a){return!!(this.state.playerAPI&&this.state.playerAPI.isState(a))};a.propTypes={attachment:c.object,className:c.string,isInThread:c.bool,isVisible:c.bool,isOnStage:c.bool,stageDimensions:c.instanceOf(b("Vector")),videoData:c.object,onClick:c.func,onSelect:c.func};a.invokeVideoLoaded=function(a,c,d){a.$2=d,c.setAllowCrossPageTransition(!0),c.isState(b("VideoPlayerStates").LOADING)?a.stateChangeListener=c.addListener("stateChange",function(){if(!c.isState(b("VideoPlayerStates").LOADING)){if(a.state&&a.state.playerAPI)return;a.setState({playerAPI:c},a.onVideoLoaded);a.stateChangeListener&&a.stateChangeListener.remove()}}):a.setState({playerAPI:c},a.onVideoLoaded)};e.exports=a}),null);
__d("MessagingForwardAttachmentDialog.react",["BootloadOnRender.react","JSResource","LazyComponent.react","React"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.prototype.render=function(){return b("React").createElement(b("BootloadOnRender.react"),{component:b("React").createElement(b("LazyComponent.react"),this.props),loader:b("JSResource")("MessagingForwardAttachmentDialogImpl.react").__setRef("MessagingForwardAttachmentDialog.react"),placeholder:b("React").createElement("div",null)})};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("SpotlightMessagesViewerPagers.react",["cx","LeftRight.react","Link.react","React"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){return b("React").createElement(b("LeftRight.react"),null,b("React").createElement(b("Link.react"),{className:"_322u"+(a.disablePrevArrow?"":" _2bbb")+" _50-m"},b("React").createElement("div",{className:(a.disablePrevArrow?"":"_4ksl")+(a.disablePrevArrow?"":" _4ksm")})),b("React").createElement(b("Link.react"),{className:"_322u"+(a.disableNextArrow?"":" _2bbc")+" _50-m"},b("React").createElement("div",{className:(a.disableNextArrow?"":"_4ksl")+(a.disableNextArrow?"":" _4kso")})))};e.exports=a}),null);
__d("XMessagingPhotoDownloadController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/mercury/attachments/photo/",{photo_id:{type:"String",required:!0}})}),null);
__d("XMessagingShareAttachmentDialogController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/mercury/attachments/share/dialog/",{__asyncDialog:{type:"Int"}})}),null);
__d("SpotlightMercurySharedMediaViewer.react",["csx","cx","fbt","invariant","ActorURI","AsyncDialog","AsyncRequest","BootloadedComponent.react","ChatPhotoViewFooterHScroll.react","ChatPhotoViewHeader.react","Event","FunnelLogger","JSResource","KeyEventController","MessagingForwardAttachmentDialog.react","MessengerPhotoInfoDialogContainer.react","MessengerThreadSharedMediaHelper","MessengerVideoPlayer.react","Parent","PhotoUtils","React","SpotlightMessagesViewerPagers.react","SpotlightViewer","SpotlightViewerImage","SpotlightViewport","SubscriptionsHandler","Vector","XMessagingPhotoDownloadController","XMessagingShareAttachmentDialogController"],(function(a,b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k;a=b("React").PropTypes;var l=88,m=30,n="WWW_MESSENGER_SHARE_TO_FB_FUNNEL",o="_4-og";c=babelHelpers.inherits(p,b("React").Component);k=c&&c.prototype;function p(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=k.constructor).call.apply(a,[this].concat(e)),this.$1=undefined,this.$2=[],this.state={hasPrevPage:!1,hasNextPage:!1,firstPhotoLoaded:!1,isLoading:!1,mediaData:[],numberInOneBatch:m,photoData:null,showForward:!1,showInfo:!1,stageDimensions:new(b("Vector"))()},this.$11=function(){return!this.state.photoData?null:b("React").createElement(b("ChatPhotoViewFooterHScroll.react"),{onScroll:this.$18,photoID:this.state.photoData.node.id,sharedPhotos:this.state.mediaData,updateNumberInOneBatch:this.$19,width:this.state.stageDimensions.x})}.bind(this),this.$19=function(a){this.setState({numberInOneBatch:a})}.bind(this),this.$18=function(a){if(!this.state.mediaData||this.state.isLoading)return;var b=this.state.mediaData.findIndex(function(b){return b.node.legacy_attachment_id===a});if(b<0)return;var c=this.state.mediaData[b];this.setState({photoData:c});this.$22(b)}.bind(this),this.$5=function(a,event){__p&&__p();if(this.state.photoData==null||this.state.isLoading)return;if(event&&!!b("Parent").bySelector(event.target,"._170l"))return;event&&event.target instanceof HTMLElement&&event.target.className===o&&this.$10();var c=this.state.mediaData.findIndex(function(a){this.state.photoData!=null||j(0,undefined);return a.node.legacy_attachment_id===this.state.photoData.node.legacy_attachment_id}.bind(this));if(c<0||c===this.state.mediaData.length-1&&!this.state.hasNextPage&&a)return;if(c===0&&!a){this.setState({isLoading:!0},function(){return this.$7(this.state.photoData,1,function(b){if(b===0)return;this.$5(a)}.bind(this))}.bind(this));return}var d=a?this.state.mediaData[c+1]:this.state.mediaData[c-1];this.setState({photoData:d});this.$22(c)}.bind(this),this.$10=function(){if(this.props.photoID===null)return;this.setState({photoData:null});this.props.onClosePhotoView()}.bind(this),this.$16=function(){this.setState({showForward:!0})}.bind(this),this.$20=function(){this.setState({showForward:!1})}.bind(this),this.$15=function(){this.setState({showInfo:!0})}.bind(this),this.$21=function(){this.setState({showInfo:!1})}.bind(this),this.$17=function(){this.setState({showForward:!1,showInfo:!1});b("FunnelLogger").appendAction(n,"click");var a=this.state.photoData;if(!this.$14()||!(a&&a.node))return;a=a.node.legacy_attachment_id;var c=b("XMessagingShareAttachmentDialogController").getURIBuilder().getURI();c=new(b("AsyncRequest"))(c).setData({attachment_id:a}).setMethod("POST");b("AsyncDialog").send(c)}.bind(this),this.$23=function(a,b,c){__p&&__p();var d=Object.keys(a)[0];a=a[d].message_shared_media;d=a.page_info;var e=a.edges.length;if(e!==0){var f=this.state.mediaData;switch(b){case 0:this.setState({photoData:a.edges[0],mediaData:[a.edges[0]],firstPhotoLoaded:!0});break;case 1:f=f.concat(a.edges);this.setState({hasNextPage:d.has_next_page,mediaData:f});break;case-1:f=a.edges;f=f.concat(this.state.mediaData);this.setState({mediaData:f,hasPrevPage:d.has_previous_page});break}}this.setState({isLoading:!1});c(e)}.bind(this),this.$3=function(){var a=new(b("Vector"))(b("Vector").getViewportDimensions().x,b("Vector").getViewportDimensions().y-l);return a},c}p.prototype.getDefaultProps=function(){return{enableShareToFB:!1}};p.prototype.componentDidMount=function(){this.setState({isLoading:!0,stageDimensions:this.$3()},function(){return this.$4(this.props.photoID)}.bind(this)),this.$1=new(b("SubscriptionsHandler"))(),this.$1.addSubscriptions(b("Event").listen(window,"resize",function(){this.setState({stageDimensions:this.$3()})}.bind(this)),b("KeyEventController").registerKey("LEFT",function(){this.$5(!1);return!1}.bind(this)),b("KeyEventController").registerKey("RIGHT",function(){this.$5(!0);return!1}.bind(this))),this.props.enableShareToFB&&b("FunnelLogger").startFunnel(n)};p.prototype.UNSAFE_componentWillUpdate=function(a,b){b.firstPhotoLoaded!==this.state.firstPhotoLoaded&&this.setState({isLoading:!0},function(){this.$6(b.photoData,b.numberInOneBatch,function(){}),this.$7(b.photoData,b.numberInOneBatch,function(){})}.bind(this)),b.numberInOneBatch!=this.state.numberInOneBatch&&!b.isLoading&&this.setState({isLoading:!0},function(){return this.$6(b.mediaData[b.mediaData.length-1],b.numberInOneBatch,function(){})}.bind(this))};p.prototype.componentWillUnmount=function(){this.$1&&this.$1.release(),this.$1=null,this.$2.forEach(function(a){return a.abandon()})};p.prototype.render=function(){var a=this.$8(),c=this.state.stageDimensions,d=this.state.isLoading||this.props.useloadingindicator&&!this.state.photoData;if(this.state.photoData==null)return null;var e=this.state.mediaData.findIndex(function(a){this.state.photoData!=null||j(0,undefined);return a.node.id===this.state.photoData.node.id}.bind(this));e=b("React").createElement("div",null,this.$9(),this.props.disablepaging?null:b("React").createElement(b("SpotlightMessagesViewerPagers.react"),{disablePrevArrow:e<=0&&!this.state.hasPrevPage,disableNextArrow:!this.state.hasNextPage&&e>=this.state.mediaData.length-1}));return b("React").createElement("span",null,b("React").createElement(b("SpotlightViewer"),{className:"_53vs",onHide:this.$10,open:this.props.photoID!==null,ref:"spotlightViewer",rootClassName:this.props.rootClassName},b("React").createElement(b("SpotlightViewport"),{active:!1,fadeInNOut:!0,media:a,onClick:this.$5,ref:"viewport",showLoadingIndicator:d,stageDimensions:c,useWidth:!0},e),this.$11()),this.$12(),this.$13())};p.prototype.$9=function(){if(!this.state.photoData)return null;var a=this.state.photoData;a=a.node.legacy_attachment_id;a=b("XMessagingPhotoDownloadController").getURIBuilder().setString("photo_id",a).getURI();this.props.actorid&&(a=b("ActorURI").create(a,this.props.actorid));return b("React").createElement(b("ChatPhotoViewHeader.react"),{disableForward:this.props.disableForward,enableShareToFB:this.$14(),onClose:this.$10,openInfo:this.$15,ref:"photoviewheader",showForwardDialog:this.$16,showShareDialog:this.$17,url:a})};p.prototype.$12=function(){if(!this.state.photoData||!this.state.showForward)return null;var a=i._("Chuy\u1ec3n ti\u1ebfp qua nhi\u1ec1u tin nh\u1eafn ri\u00eang");return b("React").createElement(b("MessagingForwardAttachmentDialog.react"),{attachmentID:this.state.photoData.node.legacy_attachment_id,onClose:this.$20,shown:this.state.showForward,title:a})};p.prototype.$13=function(){return this.state.showInfo?b("React").createElement(b("MessengerPhotoInfoDialogContainer.react"),{closeInfo:this.$21,infoOpen:this.state.showInfo,photoID:this.state.photoData.node.id}):b("React").createElement("xhp",null)};p.prototype.$14=function(){var a=this.state.photoData;return!a?!1:!!this.props.enableShareToFB&&a.node.__typename==="MessageImage"&&a.node.image1.uri.indexOf(".gif")<0};p.prototype.$22=function(a){var b=this.state.numberInOneBatch,c=this.state.mediaData;a<=b/2?this.setState({isLoading:!0},function(){return this.$7(c[0],b,function(){})}.bind(this)):a>=c.length-b/2&&this.state.hasNextPage&&this.setState({isLoading:!0},function(){return this.$6(c[c.length-1],b,function(){})}.bind(this))};p.prototype.$4=function(a){a=b("MessengerThreadSharedMediaHelper").search(this.props.threadID,String(a),function(a){return this.$23(a,0,function(){})}.bind(this));this.$2.push(a)};p.prototype.$6=function(a,c,d){a=b("MessengerThreadSharedMediaHelper").loadMorePrevious(this.props.threadID,a.cursor,c||1,function(a){return this.$23(a,1,d)}.bind(this));this.$2.push(a)};p.prototype.$7=function(a,c,d){a=a?a.cursor:null;a=b("MessengerThreadSharedMediaHelper").loadMoreLatest(this.props.threadID,a,c||1,function(a){return this.$23(a,-1,d)}.bind(this));this.$2.push(a)};p.prototype.$8=function(){__p&&__p();if(this.state.photoData&&this.state.photoData.node){var a=this.state.photoData.node;if(a.__typename&&a.__typename==="MessageVideo")return this.$24();var c=this.state.stageDimensions,d=this.$25(a,c);if(!d)return null;if(a.photo_encodings&&a.photo_encodings.length!==0)return this.$26(a.legacy_attachment_id,d,a.photo_encodings,c);a=p.getImageDimensionsForStage(new(b("Vector"))(d.width,d.height),c);return this.$27(d,a)}else return null};p.prototype.$24=function(){return this.state.photoData?b("React").createElement(b("MessengerVideoPlayer.react"),{isOnStage:!0,isVisible:!0,videoData:this.state.photoData.node,stageDimensions:this.state.stageDimensions}):null};p.prototype.$27=function(a,c){return b("React").createElement(b("SpotlightViewerImage"),{dimensions:c,ref:"image",src:a.uri})};p.prototype.$26=function(a,c,d,e){return b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("SpotlightViewerSphericalPhoto.react").__setRef("SpotlightMercurySharedMediaViewer.react"),bootloadPlaceholder:b("React").createElement("div",null),height:e.y,width:e.x,fbid:a,thumbnail:c.uri,photoEncodings:d,stageDimensions:this.state.stageDimensions})};p.prototype.$25=function(a,c){var d=null;a=b("PhotoUtils").getImagesFromData(a);a=a.sort(function(a,b){return b.width-a.width});window.devicePixelRatio&&window.devicePixelRatio>1&&(c=new(b("Vector"))(c.x*window.devicePixelRatio,c.y*window.devicePixelRatio));for(var e=0;e<a.length;e++)(!d||a[e].width>=c.x||a[e].height>=c.y)&&(d=a[e]);return d};p.propTypes={disableForward:a.bool,enableShareToFB:a.bool,onClosePhotoView:a.func,photoID:a.string,rootClassName:a.string,threadID:a.string};p.getImageDimensionsForStage=function(a,c){var d=a.x;a=a.y;var e=c.x;c=c.y;var f=d/a,g=e/c;d>=e||a>=c?g<f?(d=e,a=Math.round(e/f)):g>f?(d=Math.round(c*f),a=c):(d=e,a=c):f<g?d=Math.round(a*f):a=Math.round(d/f);return new(b("Vector"))(d,a)};e.exports=p}),null);
__d("SpotlightMessengerSharedMediaViewer.react",["csx","cx","fbt","invariant","ActorURI","BootloadedComponent.react","Event","JSResource","KeyEventController","MessengerForwardAttachmentDialogReact.bs","MessengerPhotoInfoDialogContainer.react","MessengerPhotoViewBottomBar.react","MessengerPhotoViewHeader.react","MessengerPhotoViewHScroll.react","MessengerSharedMediaActions","MessengerVideoPlayer.react","Parent","PhotoUtils","React","SpotlightMessagesViewerPagers.react","SpotlightViewer","SpotlightViewerImage","SpotlightViewport","SubscriptionsHandler","Vector","XMessagingPhotoDownloadController"],(function(a,b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k,l=b("MessengerForwardAttachmentDialogReact.bs").jsComponent;a=b("React").PropTypes;var m=88,n=80,o=30,p="_4-og";c=babelHelpers.inherits(q,b("React").Component);k=c&&c.prototype;function q(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=k.constructor).call.apply(a,[this].concat(e)),this.$1=undefined,this.$2=[],this.state={photoData:null,showForward:!1,showInfo:!1,stageDimensions:new(b("Vector"))()},this.$14=function(a){if(!this.props.sharedMedia)return;var b=this.props.sharedMedia.findIndex(function(b){return b.node.legacy_attachment_id===a});if(b<0)return;var c=this.props.sharedMedia[b];this.setState({photoData:c});this.$17(b)}.bind(this),this.$4=function(a,event){__p&&__p();if(this.state.photoData==null)return;var c=this.state.photoData;if(event&&!!b("Parent").bySelector(event.target,"._170l"))return;event&&event.target instanceof HTMLElement&&event.target.className===p&&this.$7();var d=this.props.sharedMedia.findIndex(function(a){return a.node.legacy_attachment_id===c.node.legacy_attachment_id});if(d<0||d===this.props.sharedMedia.length-1&&!this.props.hasNextPage&&a)return;if(d===0&&!a){b("MessengerSharedMediaActions").loadMoreLatest(this.props.threadID,this.props.sharedMedia[0].cursor,o);return}a=a?this.props.sharedMedia[d+1]:this.props.sharedMedia[d-1];this.setState({photoData:a});this.$17(d)}.bind(this),this.$7=function(){if(this.props.photoID===null)return;this.setState({photoData:null});this.props.onClosePhotoView()}.bind(this),this.$12=function(){this.setState({showForward:!0})}.bind(this),this.$15=function(){this.setState({showForward:!1})}.bind(this),this.$11=function(){this.setState({showInfo:!0})}.bind(this),this.$16=function(){this.setState({showInfo:!1})}.bind(this),c}q.prototype.componentDidMount=function(){__p&&__p();var a=this.props.sharedMedia.find(function(a){return a.node.legacy_attachment_id===this.props.photoID}.bind(this));this.setState({photoData:a,stageDimensions:this.$3()});this.$1=new(b("SubscriptionsHandler"))();this.$1.addSubscriptions(b("Event").listen(window,"resize",function(){this.setState({stageDimensions:this.$3()})}.bind(this)),b("KeyEventController").registerKey("LEFT",function(){this.$4(!1);return!1}.bind(this)),b("KeyEventController").registerKey("RIGHT",function(){this.$4(!0);return!1}.bind(this)))};q.prototype.componentWillUnmount=function(){this.$1&&this.$1.release(),this.$1=null,this.$2.forEach(function(a){return a.abandon()})};q.prototype.render=function(){var a=this.$5(),c=this.state.stageDimensions,d=this.props.useloadingindicator&&!this.state.photoData;if(this.state.photoData==null)return null;var e=this.props.sharedMedia.findIndex(function(a){this.state.photoData!=null||j(0,undefined);return a.node.id===this.state.photoData.node.id}.bind(this));e=b("React").createElement("div",null,this.$6(),this.props.disablepaging?null:b("React").createElement(b("SpotlightMessagesViewerPagers.react"),{disablePrevArrow:e<=0&&!this.props.hasPrevPage,disableNextArrow:!this.props.hasNextPage&&e>=this.props.sharedMedia.length-1}));return b("React").createElement("span",null,b("React").createElement(b("SpotlightViewer"),{className:"_53vs",onHide:this.$7,open:this.props.photoID!==null,ref:"spotlightViewer",rootClassName:this.props.rootClassName},b("React").createElement(b("SpotlightViewport"),{active:!1,fadeInNOut:!0,media:a,onClick:this.$4,ref:"viewport",showLoadingIndicator:d,stageDimensions:c,useWidth:!0},e),this.$8()),this.$9(),this.$10())};q.prototype.$6=function(){if(!this.state.photoData)return null;var a=this.state.photoData.node.legacy_attachment_id;a=b("XMessagingPhotoDownloadController").getURIBuilder().setString("photo_id",a).getURI();this.props.actorid&&(a=b("ActorURI").create(a,this.props.actorid));return b("React").createElement(b("MessengerPhotoViewHeader.react"),{disableForward:this.props.disableForward,onClose:this.$7,openInfo:this.$11,photoID:this.props.photoID,ref:"photoviewheader",showForwardDialog:this.$12,url:a})};q.prototype.$13=function(a){return a?Math.ceil(a/n):o};q.prototype.$8=function(){if(!this.state.photoData)return null;var a=this.state.photoData,c=b("React").createElement("button",{className:"_2n5b",onClick:function(){return this.props.openAlbum(a.node.legacy_attachment_id)}.bind(this),type:"button"},b("React").createElement("div",{"aria-label":i._("Th\u01b0 vi\u1ec7n \u1ea3nh to\u00e0n m\u00e0n h\u00ecnh"),className:"_3por"}));return b("React").createElement(b("MessengerPhotoViewBottomBar.react"),null,b("React").createElement(b("MessengerPhotoViewHScroll.react"),{onScroll:this.$14,photoID:a.node.legacy_attachment_id,sharedPhotos:this.props.sharedMedia,width:this.state.stageDimensions.x}),c)};q.prototype.$9=function(){if(!this.state.photoData||this.props.disableForward)return null;var a=i._("Chuy\u1ec3n ti\u1ebfp qua nhi\u1ec1u tin nh\u1eafn ri\u00eang");return b("React").createElement(l,{attachmentID:this.state.photoData.node.legacy_attachment_id,onClose:this.$15,shown:this.state.showForward,title:a})};q.prototype.$10=function(){return this.state.showInfo?b("React").createElement(b("MessengerPhotoInfoDialogContainer.react"),{closeInfo:this.$16,infoOpen:this.state.showInfo,photoID:this.state.photoData.node.id}):b("React").createElement("xhp",null)};q.prototype.$17=function(a){var c=this.$13(this.state.stageDimensions.x),d=this.props.sharedMedia;a<=c/2?(b("MessengerSharedMediaActions").loadMoreLatest(this.props.threadID,d[0].cursor,c),d.length<c&&this.props.hasNextPage&&b("MessengerSharedMediaActions").loadMorePrevious(this.props.threadID,d[d.length-1].cursor,c)):a>=d.length-c/2&&this.props.hasNextPage&&b("MessengerSharedMediaActions").loadMorePrevious(this.props.threadID,d[d.length-1].cursor,c)};q.prototype.$3=function(){var a=new(b("Vector"))(b("Vector").getViewportDimensions().x,b("Vector").getViewportDimensions().y-m);return a};q.prototype.$5=function(){__p&&__p();if(this.state.photoData&&this.state.photoData.node){var a=this.state.photoData.node;if(a.__typename&&a.__typename==="MessageVideo")return this.$18();var c=this.state.stageDimensions,d=this.$19(a,c);if(!d)return null;if(a.photo_encodings&&a.photo_encodings.length!==0)return this.$20(a.legacy_attachment_id,d,a.photo_encodings,c);a=q.getImageDimensionsForStage(new(b("Vector"))(d.width,d.height),c);return this.$21(d,a)}else return null};q.prototype.$18=function(){return this.state.photoData?b("React").createElement(b("MessengerVideoPlayer.react"),{isVisible:!0,isOnStage:!0,videoData:this.state.photoData.node,stageDimensions:this.state.stageDimensions}):null};q.prototype.$21=function(a,c){return b("React").createElement(b("SpotlightViewerImage"),{dimensions:c,ref:"image",src:a.uri})};q.prototype.$20=function(a,c,d,e){return b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("SpotlightViewerSphericalPhoto.react").__setRef("SpotlightMessengerSharedMediaViewer.react"),bootloadPlaceholder:b("React").createElement("div",null),height:e.y,width:e.x,fbid:a,thumbnail:c.uri,photoEncodings:d,stageDimensions:this.state.stageDimensions})};q.prototype.$19=function(a,c){c=b("PhotoUtils").getImagesFromData(a);return c[c.length-1]};q.propTypes={disableForward:a.bool,hasPrevPage:a.bool,hasNextPage:a.bool,onClosePhotoView:a.func,openAlbum:a.func,photoID:a.string,rootClassName:a.string,threadID:a.string,sharedMedia:a.arrayOf(a.object)};q.getImageDimensionsForStage=function(a,c){var d=a.x;a=a.y;var e=c.x;c=c.y;var f=d/a,g=e/c;d>=e||a>=c?g<f?(d=e,a=Math.round(e/f)):g>f?(d=Math.round(c*f),a=c):(d=e,a=c):f<g?d=Math.round(a*f):a=Math.round(d/f);return new(b("Vector"))(d,a)};e.exports=q}),null);
__d("SpotlightMessengerSharedMediaViewerContainer.react",["FluxContainer","MessengerSharedMediaActions","MessengerSharedMediaStore","React","SpotlightMessengerSharedMediaViewer.react"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.getStores=function(){return[b("MessengerSharedMediaStore")]};a.calculateState=function(a,c){a=b("MessengerSharedMediaStore").getState();var d=a.sharedMedia.get(c.threadID);a=a.isLoading.get(c.threadID);return{sharedMedia:d,isLoading:a}};a.prototype.componentDidMount=function(){b("MessengerSharedMediaActions").loadCurrent(this.props.threadID,this.props.photoID)};a.prototype.render=function(){if(!this.state.sharedMedia)return null;var a=this.state.sharedMedia&&this.state.sharedMedia.edges.find(function(a){return a.node.legacy_attachment_id===this.props.photoID}.bind(this));return!a?null:b("React").createElement(b("SpotlightMessengerSharedMediaViewer.react"),{disableForward:this.props.disableForward,hasPrevPage:this.state.sharedMedia&&this.state.sharedMedia.has_previous_page,hasNextPage:this.state.sharedMedia&&this.state.sharedMedia.has_next_page,onClosePhotoView:this.props.onClosePhotoView,openAlbum:this.props.openAlbum,photoID:this.props.photoID,rootClassName:this.props.rootClassName,sharedMedia:this.state.sharedMedia&&this.state.sharedMedia.edges,threadID:this.props.threadID})};function a(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("MessengerThreadSharedPhotos.react",["cx","MessengerSharedPhotosAlbumViewContainer.react","React","SpotlightMessengerSharedMediaViewerContainer.react","SpotlightViewer"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.state={photoView:this.props.findFBID,albumView:""},this.$3=function(a){this.setState({albumView:a,photoView:""})}.bind(this),this.$4=function(){this.setState({albumView:""})}.bind(this),this.$5=function(a){this.setState({albumView:"",photoView:a})}.bind(this),this.$6=function(){this.setState({photoView:""})}.bind(this),this.$7=function(a){this.setState({photoView:a})}.bind(this),b}a.prototype.componentDidUpdate=function(){!this.state.photoView&&!this.state.albumView&&this.props.onCloseSharedPhotos()};a.prototype.render=function(){var a=this.state.photoView?this.$1():null,c=this.state.albumView?this.$2():null;return b("React").createElement("div",null,c,a)};a.prototype.$1=function(){return b("React").createElement(b("SpotlightMessengerSharedMediaViewerContainer.react"),{disableForward:!1,onClosePhotoView:this.$6,openAlbum:this.$3,photoID:this.state.photoView,rootClassName:"",threadID:this.props.threadFBID})};a.prototype.$2=function(){return b("React").createElement(b("SpotlightViewer"),{className:"_3ode",onHide:this.$4,open:!0,ref:"spotlightViewer"},b("React").createElement(b("MessengerSharedPhotosAlbumViewContainer.react"),{onClick:this.$5,onCloseSharedPhotos:this.props.onCloseSharedPhotos,threadID:this.props.threadFBID,viewedPhoto:this.state.albumView}))};a.propTypes={findFBID:c.string,onCloseSharedPhotos:c.func,threadFBID:c.string};e.exports=a}),null);
__d("MessengerThreadSharedPhotosReact.bs",["ReasonReact.bs","MessengerThreadSharedPhotos.react"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e){return b("ReasonReact.bs").wrapJsForReason(b("MessengerThreadSharedPhotos.react"),{findFBID:a,onCloseSharedPhotos:c,threadFBID:d},e)}f.make=a}),null);
__d("MessengerVideoPlayerReact.bs",["ReasonReact.bs","bs_js_null_undefined","MessengerVideoPlayer.react"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e,f,g,h,i,j,k){return b("ReasonReact.bs").wrapJsForReason(b("MessengerVideoPlayer.react"),{attachment:b("bs_js_null_undefined").fromOption(a),className:b("bs_js_null_undefined").fromOption(c),isInThread:b("bs_js_null_undefined").fromOption(d),isVisible:b("bs_js_null_undefined").fromOption(e),isOnStage:b("bs_js_null_undefined").fromOption(f),stageDimensions:b("bs_js_null_undefined").fromOption(g),videoData:h,onClick:b("bs_js_null_undefined").fromOption(i),onSelect:b("bs_js_null_undefined").fromOption(j)},k)}f.make=a}),null);
__d("MessengerVideoReact.bs",["cx","ix","bs_curry","React","ImageReact.bs","ReasonReact.bs","joinClasses","bs_js_primitive","MessengerPhotoReact.bs","MessengerVideoPlayerReact.bs"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("ReasonReact.bs").statelessComponent("MessengerVideo");function j(a){__p&&__p();a=a.metadata;var b;if(a==null||a.fbid==null)b=1;else{var c=window.screen.width>1800&&!(a.large_size==null)&&!(a.large_preview==null),d=a.fbid,e=c?a.large_size:a.inbox_size;e=e==null?{x:0,y:0}:{x:e.width,y:e.height};c=c?a.large_preview:a.inbox_preview;return{legacy_attachment_id:d,original_dimensions:e,start_muted:!0,hide_controls_on_finish:!0,url:c,is_share:!1}}if(b===1)return{legacy_attachment_id:null,original_dimensions:null,start_muted:!0,hide_controls_on_finish:!0,url:null,is_share:!1}}function k(a){var b=a%60,c=b<10;return String(a/60|0)+(":"+((c?"0":"")+String(b)))}function a(a,c,d,e,f,g,l,m){__p&&__p();var n=a?a[0]:"",o=function(){var a=c.metadata,d=c.media;d=a==null?d==null?0:b("bs_js_primitive").null_undefined_to_opt(d.duration):b("bs_js_primitive").null_undefined_to_opt(a.duration);if(d)return k(d[0]);else return null},p=function(){if(g)return b("bs_curry")._1(g[0],c);else return 0},q=function(a){var e=a.legacy_attachment_id;if(e==null)return 0;else return[b("ReasonReact.bs").element(0,0,b("MessengerVideoPlayerReact.bs").make([c],[b("joinClasses")(n,"_ccq","_4tsk","_3o67",d?"_52mr":"",d?"_1byr":"")],[!0],f,0,0,a,[p],l,[]))]};return[i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],function(){var a=j(c);a=q(a);if(a)return a[0];else return b("ReasonReact.bs").element(0,0,b("MessengerPhotoReact.bs").make([b("joinClasses")(n,"_ccq")],c,d,0,e,g,[b("ReasonReact.bs").element(0,0,b("ImageReact.bs").make(["_ccr"],0,0,0,[h("27983")],0,0,0,0,[])),b("React").createElement("span",{className:"_ccs"},o(0))]))},i[9],i[10],i[11],i[12]]}c=1800;f.component=i;f.large_window_width=c;f.constructVideoData=j;f.formatDuration=k;f.make=a}),null);
__d("MessengerLivingRoomCTAContainer.react",["fbt","CurrentEnvironment","ErrorBoundary.react","JSResource","MercuryIDs","Placeholder.react","React","ShortProfiles","gkx","lazyLoadComponent"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("lazyLoadComponent")(b("JSResource")("MessengerLivingRoomCTA.react").__setRef("MessengerLivingRoomCTAContainer.react"));c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.state={threadType:null,otherUserName:null},b}a.prototype.componentDidMount=function(){__p&&__p();var a=this.props.threadID;if(a==null)return;a=b("MercuryIDs").tokenize(a);if(a.type==="thread"){this.setState({threadType:"group"});return}if(a.type!=="user")return;b("ShortProfiles").get(a.value,function(a){this.setState({otherUserName:a.firstName,threadType:"user"})}.bind(this))};a.prototype.render=function(){__p&&__p();var a=this.props,c=a.threadID,d=a.isFromViewer;a=a.attachment;var e=this.state,f=e.threadType;e=e.otherUserName;if(!b("gkx")("AT7q3aHYWfCdtda6ohMfMogLcTHxJRgdV1Lu1QhCwF5SJWpGrsEizBx5vSU_98OU5R93Btse32LwWBuhKBhJm8d5dXnUPw0qeWc6kOtDqsMtXQ")||a==null||d!=!0||c==null||f==null||f==="user"&&e==null||b("CurrentEnvironment").messengerdotcom)return null;a=a==null?void 0:(d=a.target)==null?void 0:d.video_messenger_cta_payload;d=a==null?void 0:a.cta_type;a=a==null?void 0:(a=a.video)==null?void 0:a.id;if(d!=="CREATE_LIVING_ROOM"||a==null)return null;var h;switch(f){case"user":h=g._("Xem v\u1edbi {name of the other user in the thread}",[g._param("name of the other user in the thread",e)]);break;case"group":h=g._("Xem v\u1edbi nh\u00f3m");break}return h==null?null:b("React").createElement(b("ErrorBoundary.react"),null,b("React").createElement(b("Placeholder.react"),{fallback:b("React").createElement("div",null)},b("React").createElement(i,{threadFBID:b("MercuryIDs").getThreadFBIDFromThreadID(c),videoID:a,buttonText:h})))};e.exports=a}),null);
__d("MessengerXMATextBlock.react",["cx","LineClamp.react","MessengerLivingRoomCTAContainer.react","React","ShimButton.react","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;var i=26;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.$1=function(){this.props.url&&window.open(this.props.url)}.bind(this),b}a.prototype.render=function(){if(!this.props)return b("React").createElement("div",{className:"__6j"});var a=this.props.width?{maxWidth:this.props.width-i,textAlign:"left"}:{textAlign:"left"},c={textDecoration:"none"};return b("React").createElement("div",{className:b("joinClasses")(this.props.className,"__6j _43kk _6ude"),style:a},b("React").createElement(b("ShimButton.react"),{form:"link",onClick:this.$1,style:c},this.renderTitle(),this.renderDescription(),this.renderSource()),b("React").createElement(b("MessengerLivingRoomCTAContainer.react"),{threadID:this.props.threadID,isFromViewer:this.props.isFromViewer,attachment:this.props.attachment}))};a.prototype.renderTitle=function(){return!this.props.title?null:b("React").createElement("div",{className:"__6k"},b("React").createElement(b("LineClamp.react"),{lines:2,lineHeight:16},this.props.title))};a.prototype.renderDescription=function(){if(!this.props.description)return null;var a=this.props.width?{maxWidth:this.props.width-i}:{};return b("React").createElement("div",{className:"__6l",style:a},b("React").createElement(b("LineClamp.react"),{lines:2,lineHeight:15},this.props.description))};a.prototype.renderSource=function(){return!this.props.source?null:b("React").createElement("div",{className:"__6m"},b("React").createElement(b("LineClamp.react"),{lines:1,lineHeight:14},this.props.source))};a.propTypes={className:c.string,description:c.string,source:c.string,title:c.string,url:c.string,width:c.number,isFromViewer:c.bool,attachment:c.object};e.exports=a}),null);
__d("MessengerXMATextBlockReact.bs",["ReasonReact.bs","bs_js_null_undefined","MessengerXMATextBlock.react"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e,f,g,h,i,j,k){return b("ReasonReact.bs").wrapJsForReason(b("MessengerXMATextBlock.react"),{className:b("bs_js_null_undefined").fromOption(a),description:b("bs_js_null_undefined").fromOption(c),source:b("bs_js_null_undefined").fromOption(d),title:b("bs_js_null_undefined").fromOption(e),url:b("bs_js_null_undefined").fromOption(f),width:b("bs_js_null_undefined").fromOption(g),threadID:b("bs_js_null_undefined").fromOption(h),isFromViewer:b("bs_js_null_undefined").fromOption(i),attachment:b("bs_js_null_undefined").fromOption(j)},k)}f.make=a}),null);
__d("MessengerVideoXMAReact.bs",["cx","React","ReasonReact.bs","joinClasses","bs_js_primitive","MessengerVideoPlayerReact.bs","MessengerXMATextBlockReact.bs"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("ReasonReact.bs").statelessComponent("MessengerVideoXMA");function i(a){__p&&__p();if(a==null)return null;else{var b=a.width>a.height?a.width:a.height,c=window.screen.width>1800;c=c?640:450;if(b<=c)return{x:a.width,y:a.height};else{c=c/b;b=a.width*c|0;a=a.height*c|0;return{x:b,y:a}}}}function j(a){var b=a.media;a=a.target;if(b==null||a==null||b.image_size==null||a.video_id==null)return 0;else{var c=b.image_size;return[{legacy_attachment_id:a.video_id,original_dimensions:i(c),start_muted:!0,hide_controls_on_finish:!0,url:b.image,is_share:!0}]}}function a(a,c,d,e,f,g,i){var k=a?a[0]:"",l=function(a){if(a)return b("ReasonReact.bs").element(0,0,b("MessengerVideoPlayerReact.bs").make([c],[b("joinClasses")(k,"_ccq","_4tsk","_3o67","_52mr","_1byr")],[!0],d,0,0,a[0],0,e,[]));else return null},m=function(a){return b("ReasonReact.bs").element(0,0,b("MessengerXMATextBlockReact.bs").make(["_2f5n _4br2 _29ew _3dug"],b("bs_js_primitive").null_undefined_to_opt(c.description),b("bs_js_primitive").null_undefined_to_opt(c.source),b("bs_js_primitive").null_undefined_to_opt(c.video_title),b("bs_js_primitive").null_undefined_to_opt(c.uri),a?[a[0].x]:0,f,g,[c],[]))};return[h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],function(){var a=j(c),d=l(a);return b("React").createElement("div",{className:"_3duc"},d,m(a?b("bs_js_primitive").null_undefined_to_opt(a[0].original_dimensions):0))},h[9],h[10],h[11],h[12]]}c=640;d=450;e=1800;f.large_preview_dim=c;f.thumbinail_inbox_dim=d;f.large_window_width=e;f.component=h;f.adjustSize=i;f.constructVideoData=j;f.make=a}),null);
__d("MessengerPhotosGroupReact.bs",["cx","URI","bs_block","bs_curry","React","Utils.bs","ActorURI","bs_belt_Array","LogHistory","MercuryIDs","bs_belt_Option","ReasonReact.bs","joinClasses","bs_js_primitive","bs_caml_primitive","bs_js_null_undefined","MessagesViewerSetID","MessengerPhotoReact.bs","MessengerVideoReact.bs","MercuryAttachmentType","getPageIDFromThreadID","MessengerVideoXMAReact.bs","bs_caml_builtin_exceptions","ChatSpeakingStickerReact.bs","MercuryAttachmentPayload.bs","MessengerAttachmentViewer","MessengerThreadSharedPhotosReact.bs"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h="empty-spacer",i=b("LogHistory").getInstance("messenger_photo_group"),j=b("ReasonReact.bs").reducerComponent("MessengerPhotosGroup");function k(a,c,d,e,f,g,k,l,m,n,o,p,q,r){__p&&__p();var s=d?d[0]:"",t=function(a){a=a.length;var c=a===2||a===4;return b("joinClasses")(s,"_2n8h",a===1?"_2n8i":"",c?"_4ksk":"",a>1&&!c?"_2n8k":"","_5fk1")},u=function(){__p&&__p();if(l){var a=l[0],c=a.thread_fbid;if(c==null)return b("MercuryIDs").getThreadFBIDFromThreadID(a.thread_id);else{var d=b("bs_caml_primitive").caml_string_compare(c,"")===0;if(d)return b("MercuryIDs").getThreadFBIDFromThreadID(a.thread_id);else return c}}else return null},v=function(a,c){var d=u(0);c=c.metadata;c=c==null?null:c.fbid;return b("ReasonReact.bs").element(0,0,b("MessengerThreadSharedPhotosReact.bs").make(c,function(){return b("bs_curry")._1(a[3],0)},d,[]))},w=function(a){a=JSON.stringify(a);if(a!==undefined)return a;else return""},x=function(d,j,l,s){__p&&__p();var t=j.deduplication_key,v=j.metadata;if(t==null)if(v==null){var x=j.upload_id;x=x==null?"":x}else{v=v.fbid;x=v==null?"":v}else x=t;var y=function(b,a){i.debug("just_open_uri",w(j));return window.open(b)},z;if(!l&&!b("Utils.bs").isSomeTrue(f)){var A=j.metadata;v=0;if(A==null||A.fbid==null)v=1;else{t=j.app_attribution==null;z=t?[function(a){i.debug("open_share_view",w(a));return b("bs_curry")._1(d[3],[a])}]:[function(c){__p&&__p();var d=A;c=c;i.debug("on_child_clicked",w(c));if(b("Utils.bs").isTruthy(c.preview_uploading))return 0;else if(c.attach_type===b("MercuryAttachmentType").VIDEO){var f=d.dimensions;f=f==null?{x:null,y:null}:{x:f.width,y:f.height};b("MessengerAttachmentViewer").renderVideo({pageID:b("bs_js_null_undefined").fromOption(o),rootClassName:"_1j1h",videoID:d.fbid,videoSize:f,videoURI:c.url});return 0}else if(c.attach_type===b("MercuryAttachmentType").PHOTO||c.attach_type===b("MercuryAttachmentType").THIRDPARTYSTICKER||c.attach_type===b("MercuryAttachmentType").ANIMATED_IMAGE){f=a.length===1;var h=c.url;if(!b("Utils.bs").isSomeTrue(g)&&c.attach_type===b("MercuryAttachmentType").PHOTO&&e!==0){var j=u(0),k=e===[1];j=new(b("URI"))("/ajax/messaging/attachments/sharedphotos.php").setQueryData({thread_id:j,image_id:d.fbid});j=o?new(b("ActorURI").create)(j,o[0]):j;j=[b("MessagesViewerSetID").MESSAGES_VIEW_ALL_IN_THREAD,j,k]}else j=[null,h,f];b("MessengerAttachmentViewer").bootstrapWithConfig({actorid:b("bs_js_null_undefined").fromOption(o),dimensions:d.dimensions,disableForward:o!==0,disablePaging:j[2],endpoint:j[1],fbid:d.fbid,rootClassName:"_1j1h",setID:j[0],snapToPhoto:!0,src:c.preview_url});return 0}else if(c.uri==null)return 0;else return window.open(c.uri)}]}if(v===1){l=j.uri==null;if(l)z=0;else{var B=j.uri;z=[function(a){return y(B,a)}]}}}else{t=j.large_preview_url==null;if(t)z=0;else{var C=j.large_preview_url;z=[function(a){return y(C,a)}]}}v=b("bs_belt_Option").getWithDefault(c,j.attach_type);if(v===b("MercuryAttachmentType").PHOTO||v===b("MercuryAttachmentType").ANIMATED_IMAGE||v===b("MercuryAttachmentType").THIRDPARTYSTICKER)return b("ReasonReact.bs").element([x],0,b("MessengerPhotoReact.bs").make(0,j,s,k,m,z,[]));else if(v===b("MercuryAttachmentType").VIDEO){l=j.metadata;if(l==null||!b("Utils.bs").isTruthy(l.render_as_sticker))t=1;else{l=l.dimensions;l=l==null?{height:null,width:null}:{height:l.height,width:l.width};var D=j.url;return b("ReasonReact.bs").element(0,0,b("ChatSpeakingStickerReact.bs").make(D,l,[]))}if(t===1)if(b("Utils.bs").isSomeTrue(g))return b("ReasonReact.bs").element([x],0,b("MessengerVideoXMAReact.bs").make(0,j,k,n,p,q,[]));else return b("ReasonReact.bs").element([x],0,b("MessengerVideoReact.bs").make(0,j,s,m,k,z,n,[]))}else if(v===h){D={className:"_4tsk _4rf-"};l=b("bs_js_primitive").null_undefined_to_opt(j.key);l&&(D.key=l[0]);return b("React").createElement("div",D)}else throw[b("bs_caml_builtin_exceptions").invalid_argument,v+" is not handled by MessengerPhotosGroup"]},y=function(c,a,d){__p&&__p();if(a.length!==1){var e=a.length===2||a.length===4,f=e?2:3;e=[];var g=[0],i=a.length;while(g[0]<i){var j=b("bs_caml_primitive").caml_int_min(f,i-g[0]|0);j=b("bs_belt_Array").makeBy(f,function(e){return function(j){var i=j<e;if(i)return x(c,a[g[0]+j|0],d,!1);else{i="ghost"+String(f-j|0);j=b("MercuryAttachmentPayload.bs").create(h,[i],new(b("URI"))(""));return x(c,j,d,!1)}}}(j));e.push(b("React").createElement("div",{key:String(g[0]),className:"_2n8g"},j));g[0]=g[0]+f|0}return e}else{j=a[0];return x(c,j,d,!0)}};return[j[0],j[1],j[2],j[3],function(){b("MessengerAttachmentViewer").preload();return 0},j[5],j[6],j[7],function(c){var d=l?!(b("getPageIDFromThreadID")(l[0].thread_id)==null):!1;d=y(c,a,d);var e=c[1][0];c=e?v(c,e[0]):null;return b("React").createElement("div",{className:t(a),tabIndex:0},c,d)},function(){return[0]},j[10],function(c,a){if(c)return b("bs_block").__(0,[[[c[0]]]]);else return b("bs_block").__(0,[[0]])},j[12]]}a=b("ReasonReact.bs").wrapReasonForJs(j,function(a){return k(a.attachments,b("bs_js_primitive").null_undefined_to_opt(a.attachType),b("bs_js_primitive").null_undefined_to_opt(a.className),b("bs_js_primitive").null_undefined_to_opt(a.count),b("bs_js_primitive").null_undefined_to_opt(a.isPageMessage),b("bs_js_primitive").null_undefined_to_opt(a.isXMA),b("bs_js_primitive").null_undefined_to_opt(a.isVisible),b("bs_js_primitive").null_undefined_to_opt(a.message),b("bs_js_primitive").null_undefined_to_opt(a.onAttachmentLoad),b("bs_js_primitive").null_undefined_to_opt(a.onSelect),b("bs_js_primitive").null_undefined_to_opt(a.pageID),b("bs_js_primitive").null_undefined_to_opt(a.threadID),b("bs_js_primitive").null_undefined_to_opt(a.isFromViewer),[])});c=b("bs_belt_Option").getWithDefault;f.$pipe$unknown=c;f.empty_spacer_type=h;f.history=i;f.component=j;f.make=k;f.jsComponent=a}),null);
__d("MessengerPhotosGroup.react",["MessengerPhotosGroupReact.bs"],(function(a,b,c,d,e,f){"use strict";a=b("MessengerPhotosGroupReact.bs").jsComponent;e.exports=a}),null);
__d("MessengerStickerUtils",["MercuryAttachmentType"],(function(a,b,c,d,e,f){"use strict";function g(a){return!!(a&&a.attach_type===b("MercuryAttachmentType").STICKER)}function h(a){var b=a.attachments;return!!(a.is_like_preview||a.sticker_id||b&&b.length===1&&g(b[0]))}function a(a){return a.size===1&&h(a.first())}e.exports={isStickerMessageGroup:a,isStickerMessage:h,isStickerAttachment:g}}),null);
__d("MessengerVoiceClipAttachment.react",["cx","MercuryAttachmentAudioClip.react","MercuryShareAttachmentRenderLocations","React","messengerCustomColorUtils"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").PureComponent);h&&h.prototype;a.prototype.render=function(){var a=this.props.attachment,c=a.metadata.duration/1e3,d=!!a.app_attribution,e={};this.props.customColor&&(e.backgroundColor=this.props.customColor);return b("React").createElement("div",{className:"_hh7 _s1-"+(this.props.customColor?" _5sxi":"")+(d?"":" _52mr")+(d?" _mxz":"")+" _1fz8"+(d?" _1-wa":"")+" _1nqp",style:e},b("React").createElement(b("MercuryAttachmentAudioClip.react"),{customColor:this.props.customColor,src:a.url,duration:c,key:"audio:"+this.props.message.message_id,showHelp:!1,width:200,location:b("MercuryShareAttachmentRenderLocations").MESSENGER,rootClassName:"_3czg"+(d?" _4yjw":"")+" _2poz _ui9"}))};function a(){h.apply(this,arguments)}a.propTypes={attachment:c.object.isRequired,customColor:c.string,message:c.object.isRequired,onUnwrap:c.func};e.exports=a}),null);
__d("XStickerInTrayController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/stickers/in_tray/",{pack_id:{type:"Int",required:!0}})}),null);
__d("StickersPackInTray",["Promise","AsyncRequest","XStickerInTrayController","react-relay/classic/query/createRelayQuery","react-relay/classic/query/RelayQL","react-relay/classic/store/RelayStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={onIsPackInTray:function(a,c,d){__p&&__p();c=b("react-relay/classic/query/createRelayQuery")(function(){return{children:[{children:[{calls:[{kind:"Call",metadata:{type:"StickerInterfaces"},name:"interface",value:{kind:"CallVariable",callVariableName:"stickerInterface"}},{kind:"Call",metadata:{type:"Int"},name:"first",value:{kind:"CallValue",callValue:1e4}}],children:[{children:[{children:[{fieldName:"id",kind:"Field",metadata:{isRequisite:!0},type:"ID"}],fieldName:"node",kind:"Field",metadata:{canHaveSubselections:!0,inferredRootCallName:"node",inferredPrimaryKey:"id",isRequisite:!0},type:"StickerPack"},{fieldName:"cursor",kind:"Field",metadata:{isGenerated:!0,isRequisite:!0},type:"ID"}],fieldName:"edges",kind:"Field",metadata:{canHaveSubselections:!0,isPlural:!0},type:"PacksInTrayEdge"},{children:[{fieldName:"has_next_page",kind:"Field",metadata:{isGenerated:!0,isRequisite:!0},type:"Boolean"},{fieldName:"has_previous_page",kind:"Field",metadata:{isGenerated:!0,isRequisite:!0},type:"Boolean"}],fieldName:"page_info",kind:"Field",metadata:{canHaveSubselections:!0,isGenerated:!0,isRequisite:!0},type:"PageInfo"}],fieldName:"tray_packs",kind:"Field",metadata:{canHaveSubselections:!0,isConnection:!0},type:"PacksInTrayConnection"}],fieldName:"sticker_store",kind:"Field",metadata:{canHaveSubselections:!0},type:"StickerStore"}],fieldName:"viewer",kind:"Query",metadata:{},name:"StickersPackInTray",type:"Viewer"}}(),{stickerInterface:c});var e=b("react-relay/classic/store/RelayStore").readQuery(c);e=e&&e.length>0?e[0]:null;if(e&&e.sticker_store&&e.sticker_store.tray_packs&&e.sticker_store.tray_packs.edges)return new(b("Promise"))(function(b,c){return b({in_sticker_tray:e.sticker_store.tray_packs.edges.filter(function(b){return b.node.id===a}).length>0})}).then(d);var f=b("XStickerInTrayController").getURIBuilder().setInt("pack_id",a).getURI();return new(b("Promise"))(function(a,c){return new(b("AsyncRequest"))(f).setHandler(function(b){return a(b.getPayload())}).setAllowCrossPageTransition(!0).send()}).then(d)}};e.exports=a}),null);
__d("isRetina",[],(function(a,b,c,d,e,f){"use strict";e.exports=function(){return(window.devicePixelRatio||1)>1}}),null);
__d("MessengerAttachmentRenderer",["cx","EmojiSticker.react","MercuryAttachment","MercuryAttachmentType","MercuryAudioType","MercuryIDs","MercuryShareAttachment.react","MercuryShareAttachmentRenderLocations","MessengerErrorAttachment.react","MessengerFileAttachment.react","MessengerFromViewerUtils","MessengerHotLikePreview.react","MessengerHotLikeUtils","MessengerPhotosGroup.react","MessengerStickerUtils","MessengerSupportedEmojiUtils","MessengerVoiceClipAttachment.react","MessengerWebDriverTestIDs","React","Sticker.react","StickerAssetType","StickerConstants","StickerInterfaces","StickersActions","StickersPackInTray","StickersStoreController","StickerUtils","StoryAttachmentStyle","XStickerAssetController","isRetina"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=700,i="sticker:",j="share:",k="_1c_u",l="_3o6m",m=function(a){return a===Object(a)};a={getAttachmentsInsideBubble:function(a,c){var d=b("MercuryAttachment").get(a).filter(m).filter(function(a){return!this.attachmentShouldAppearOutsideBubble(a)}.bind(this));return this._getAttachmentComponents(d,a,c)},getAttachmentsOutsideBubble:function(a,c,d,e){var f=b("MercuryAttachment").get(a).filter(m).filter(function(a){return this.attachmentShouldAppearOutsideBubble(a)}.bind(this));return this._getAttachmentComponents(f,a,c,d,e)},_getAttachmentComponents:function(a,c,d,e,f){var g=this._getPhotosGroup(a.filter(b("MercuryAttachment").isPhotoGroupAttachment),c,d,e);a=a.filter(function(a){return!b("MercuryAttachment").isPhotoGroupAttachment(a)}).map(function(a){return this._getAttachmentComponent(a,c,d,e,f)}.bind(this));g&&a.push(g);return a},_getAttachmentComponent:function(a,c,d,e,f){__p&&__p();var g=e&&e.customColor,h=e&&e.onUnwrap,i=e&&e.isVisible,j=e&&e.isFromViewer,k=e&&e.isPageMessage;e=e&&e.onSelect;if(b("MessengerStickerUtils").isStickerAttachment(a))return this._getStickerComponent(a,c,g,h);if(this.isEmojiLikeAttachment(a))return this._getEmojiLikeAttachment(a,c,h);if(this.isVoiceClip(a))return this._getVoiceClip(a,c,g,h);if(this.isFileAttchment(a))return this._getFileComponent(a,c);if(this.isP2P(a)||this.isShareAttachment(a))return this._getShareAttachment(a,c,d,i,j,k,e,f);return this.isErrorAttachment(a)?this._getErrorAttachment(a,c):null},_getStickerComponent:function(a,c,d,e){__p&&__p();if(c.is_like_preview)return b("React").createElement(b("MessengerHotLikePreview.react"),{customColor:d,customLike:c.customLike,key:"hlp:"+c.like_preview_since,since:c.like_preview_since});e=a.metadata;if(!e){e=b("MessengerHotLikeUtils").getMetadataForHotLike(c.sticker_id);if(!e){e={};a=b("StickerUtils").getScaledDimensions(b("StickerConstants").THREAD_SIZE,b("StickerConstants").THREAD_SIZE,b("StickerConstants").THREAD_SIZE);var f=a.height;a=a.width;e.height=f;e.width=a}e.stickerID=c.sticker_id}f=b("XStickerAssetController").getURIBuilder().setInt("sticker_id",e.stickerID);a=null;var g=null;b("isRetina")()?(a=e.paddedSpriteURI2x,g=e.spriteURI2x):(a=e.paddedSpriteURI,g=e.spriteURI);var h=e.stickerID.toString();d=b("React").createElement(b("Sticker.react"),{accessibilityLabel:e.accessibilityLabel,className:"_2poz _ui9",animationTrigger:"hover",customColor:d,frameCount:e.frameCount||1,frameRate:e.frameRate||b("StickerConstants").DEFAULT_FRAME_RATE,framesPerCol:e.framesPerCol||1,framesPerRow:e.framesPerRow||1,key:i+c.message_id,onStickerClick:function(d,a){b("StickersPackInTray").onIsPackInTray(d,b("StickerInterfaces").MESSAGES,function(a){a.in_sticker_tray?(b("StickersActions").selectTrayPack(d),b("StickersActions").showStickerFlyout(c.thread_id)):b("StickersStoreController").showStore(d)})},packID:e.packID&&e.packID.toString(),paddedSpriteURI:a,sourceHeight:e.height,sourceURI:f.setEnum("image_type",b("StickerAssetType").IMAGE).getURI().toString(),sourceWidth:e.width,spriteURI:g,stickerID:h,testID:b("MessengerWebDriverTestIDs").STICKER});return d},_getEmojiLikeAttachment:function(a,c,d){d=b("MessengerSupportedEmojiUtils").transferSize(a.size);d=b("MessengerSupportedEmojiUtils").getHotLikeEmojiData(c.body,d)||b("MessengerSupportedEmojiUtils").getHotLikeEmojiDataTransition(c.body,d);if(!d)return this._getErrorAttachment(a,c);a=d.emoji;d=b("React").createElement(b("EmojiSticker.react"),{className:"_2poz _ui9",key:i+c.message_id,emoji:c.body,emojiImage:a,sourceURI:""});return d},_getShareAttachment:function(a,c,d,e,f,g,i,k){var l,m,n=null;c&&c.platform_xmd&&(n=JSON.parse(c.platform_xmd));m=(m=a)!=null?(m=m.share)!=null?(m=m.messenger_ctas)!=null?(m=m[0])!=null?m.page_id:m:m:m:m;l=(l=a)!=null?(l=l.share)!=null?(l=l.target)!=null?(l=l.items)!=null?(l=l[0])!=null?(l=l.call_to_actions)!=null?(l=l[0])!=null?l.page_id:l:l:l:l:l:l:l;m=m||l;l=m?b("MercuryIDs").getParticipantIDFromUserID(m):c.author;return b("React").createElement(b("MercuryShareAttachment.react"),{attachment:a.share,isFromViewer:f,isPageMessage:g,isSponsored:c.is_sponsored,isVisible:!!e,key:j+c.message_id,location:b("MercuryShareAttachmentRenderLocations").MESSENGER,maxWidth:h,messageID:c.message_id,mnMessageType:n&&n.template_type,onComponentLoaded:d,onSelect:i,pageID:l,threadID:c.thread_id,afterDecorators:k,timestamp:c.timestamp,author:c.author})},_getVoiceClip:function(a,c,d,e){d=b("MessengerFromViewerUtils").isFromViewer(c)?d||undefined:undefined;return b("React").createElement(b("MessengerVoiceClipAttachment.react"),{attachment:a,customColor:d,key:"audio:"+c.message_id,message:c,onUnwrap:function(b){function a(){return b.apply(this,arguments)}a.toString=function(){return b.toString()};return a}(function(){e&&e()})})},_getErrorAttachment:function(a,c){return b("React").createElement(b("MessengerErrorAttachment.react"),{attachment:a,key:"error:"+c.message_id})},_getPhotosGroup:function(a,c,d,e){__p&&__p();if(!a.length)return null;var f=e&&e.onUnwrap;d=e&&e.isVisible;var g=e&&e.onSelect,h=e&&e.isPageMessage;e=e&&e.pageID;return b("React").createElement(b("MessengerPhotosGroup.react"),{attachments:a,className:"_2poz _52mr _ui9",count:a.length,isPageMessage:h,isVisible:!!d,key:"photos:"+c.message_id,message:c,onSelect:g,onUnwrap:function(b){function a(){return b.apply(this,arguments)}a.toString=function(){return b.toString()};return a}(function(){f&&f()}),pageID:e})},getVideoElem:function(a,b){b=b.getMessageElement(a);if(!b)return null;a=b.getElementsByClassName(k);return a&&a.length?a[0]:b},getSphericalPhotoElem:function(a,b){b=b.getMessageElement(a);if(!b)return null;a=b.getElementsByClassName(l);return a&&a.length?a[0]:b},_rendersWithoutAttribution:function(a){return a.length!=1||!b("MercuryAttachment").hasAttribution(a[0])},_getFileComponent:function(a,c){return b("React").createElement(b("MessengerFileAttachment.react"),{attachment:a,className:"_2poz",key:"file:"+a.url})},attachmentShouldAppearOutsideBubble:function(a){return b("MessengerStickerUtils").isStickerAttachment(a)||b("MercuryAttachment").isPhotoGroupAttachment(a)||this.isShareAttachment(a)||this.isP2P(a)||this.isVoiceClip(a)||this.isErrorAttachment(a)||this.isEmojiLikeAttachment(a)},isPhotosGroupAttachment:function(a){a=a.props.attachments;return!!a&&a.length>1&&a.some(function(a){return!!a&&b("MercuryAttachment").isPhotoGroupAttachment(a)})},isRenderedShareAttachment:function(a){return!!(a.key&&a.key.startsWith(j))},isFileAttchment:function(a){return a.attach_type===b("MercuryAttachmentType").FILE},isShareAttachment:function(a){return!!(this._isStoryBased(a)&&!this.isP2P(a)&&(a.share.style_list.indexOf(b("StoryAttachmentStyle").SHARE)>-1||a.share.style_list.indexOf(b("StoryAttachmentStyle").FALLBACK)>-1))},isSharedVideoAttachment:function(a){a=a.attach_type===b("MercuryAttachmentType").SHARE&&a.share&&a.share.subattachments&&a.share.subattachments[0];return!!(a&&a.target&&a.target.video_id)},isP2P:function(a){return!!(this._isStoryBased(a)&&a.share.style_list.indexOf(b("StoryAttachmentStyle").ORION)>-1)},_isStoryBased:function(a){return!!(a.attach_type===b("MercuryAttachmentType").SHARE&&a.share&&a.share.style_list)},isEmojiLikeAttachment:function(a){return a.attach_type===b("MercuryAttachmentType").EMOJI_LIKE},isVoiceClip:function(a){a=a.metadata;return!!a&&(!!a.isAudio||a.type===b("MercuryAudioType").AudioClip||a.type===b("MercuryAudioType").VoiceMessageWithTranscript)},isVoiceClipAttachment:function(a){a=b("MercuryAttachment").get(a).filter(m).filter(function(a){return this.isVoiceClip(a)}.bind(this));return!!a.length},isP2PAttachment:function(a){a=b("MercuryAttachment").get(a).filter(function(a){return m(a)&&this.isP2P(a)}.bind(this));return!!a.length},isSingleVideoAttachment:function(a){a=b("MercuryAttachment").get(a).filter(m).filter(function(a){return b("MercuryAttachment").isVideoAttachment(a)});return a.length===1},isSharedVideoAttachmentMessage:function(a){a=b("MercuryAttachment").get(a).filter(m).filter(function(a){return this.isSharedVideoAttachment(a)||this.isGenieSharedVideoAttachment(a)}.bind(this));return a.length===1},isGenieSharedVideoAttachment:function(a){return!!(a.attach_type===b("MercuryAttachmentType").SHARE&&a.share&&a.share.style_list.indexOf(b("StoryAttachmentStyle").GENIE_MESSAGE)>-1&&a.share.target&&a.share.target.attachment&&this.isSharedVideoAttachment(a.share.target.attachment))},isSingleSphericalPhotoAttachment:function(a){a=b("MercuryAttachment").get(a).filter(m);if(a.length!==1)return!1;a=a.filter(function(a){return a.photo_encodings&&a.photo_encodings.length!==0}).length===1;return a},isErrorAttachment:function(a){return a.attach_type===b("MercuryAttachmentType").ERROR}};e.exports=a}),null);
__d("MessengerCodePasteUtils",["cx","BanzaiODS","MessengerBubble.react","MessengerFormattingUtils","React","gkx"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=/`{3,}/,i=3,j=/^\s+/,k=/\s+$/;function a(a){return!!(a&&a.search(h)!==-1)}function l(a,b){__p&&__p();var c=0;if(b-2>=0){c+=a[b-2].trim().length;var d=a[b-2].match(k);d&&(c+=d[0].length)}b-1>=0&&(c+=a[b-1].length+2*i);d=a[b].match(j);d&&(c+=d[0].length);return c}function m(a,b,c){if(a)return a.map(function(a){return Object.assign(Object.assign({},a),{offset:a.offset-b})}).filter(function(a){return 0<=a.offset&&a.offset<c});else return a}function n(a){a=a.split("\n");return a.length===1?{language:"",code:a[0]}:{language:a[0].replace(/[^a-zA-Z]+/g,""),code:a.slice(1).join("\n")}}function o(a){__p&&__p();if(!b("gkx")("AT6J6ondgT8iNbYZdUdZ_iCHDy_jffttgvnJfgt3bymyc0_d3Pum36cWXiYBVs6gf_1_O3A2csvVdjRwKwvFjfDs"))return a.split(h);var c=b("MessengerFormattingUtils").getRanges(a).filter(function(a){return a.formatter===b("MessengerFormattingUtils").formatConfigs.blockquote.formatter||a.formatter===b("MessengerFormattingUtils").formatConfigs.blockcode.formatter}).sort(function(a,b){return a.offset!==b.offset?a.offset-b.offset:b.length-a.length}),d=[],e=0,f=0;for(var g=0;g<c.length;g++){var i=c[g];if(i.offset<f)continue;i.formatter===b("MessengerFormattingUtils").formatConfigs.blockcode.formatter&&(d.push(a.substring(e,i.offset)),d.push(i.innerText),e=i.offset+i.length);f=i.offset+i.length}d.push(a.substring(e));return d}function c(a,c,d,e,f){__p&&__p();a=o(a);var g=[],h=0;for(var i=0;i<a.length;i+=2){var j=a[i].trim();if(j&&j.length>0){h+=l(a,i);var k=c?m(c,h,j.length):c;g.push(b("React").createElement(b("MessengerBubble.react"),{key:i,body:j,customColor:e||undefined,className:"clearfix _3058 _ui9",isFromViewer:f,ranges:k,threadID:d}))}if(i+1<a.length&&a[i+1]){j=n(a[i+1]);k=j.language;j=j.code;b("BanzaiODS").bumpEntityKey("messenger_code_paste","render_bubble");g.push(b("React").createElement("div",{key:i+1,className:"_3058 _wu0 _52mr"},b("React").createElement("div",{ref:"syntaxTarget"+i,className:"language-"+k},j)))}}return g}e.exports={containsCodeBlock:a,getCodeAndMessageBubbles:c}}),null);
__d("shouldNotRenderSegoe",["MessengerConfig","UserAgent"],(function(a,b,c,d,e,f){"use strict";var g=new RegExp("[\u0530-\u05f4\u10a0-\u10ff]"),h=b("UserAgent").isBrowser("Chrome")&&b("UserAgent").isPlatform("Windows 10");e.exports=function(a){return!b("MessengerConfig").SegoeUIDisabled&&h&&g.test(a)}}),null);
__d("MessengerBubble.react",["cx","fbt","invariant","EmojiOnlyMessage.react","MercuryIDs","MercuryMessageBody.react","MercuryMessageRenderLocations","MessageReplyPermissions","MessengerActions","MessengerCodeBubble.react","MessengerContactActions.bs","MessengerDecorator","MessengerEnvironment","MessengerInnerDecorators.react","MessengerSupportedEmojiUtils","React","RepliedToMessageContent.react","SimpleXUIDialog","goURI","immutable","joinClasses","shouldNotRenderSegoe"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k=b("MessengerContactActions.bs").actions;c=b("React").PropTypes;f=babelHelpers.inherits(a,b("React").PureComponent);j=f&&f.prototype;function a(){__p&&__p();var a,c;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return c=(a=j.constructor).call.apply(a,[this].concat(f)),this.state={emojis:undefined},this.$1=function(a,c,e){__p&&__p();switch(a){case k.MESSAGE:this.$2(c,e);break;case k.PROFILE:a=b("MercuryIDs").getParticipantIDFromUserID(c.id);a=this.props.participants&&this.props.participants.get(a);if(a&&a.href){var f=b("MessengerEnvironment").messengerdotcom;f?window.open(a.href):b("goURI")(a.href)}else this.$2(c,e);break;case k.FREE_CALL:d(["FBRTCCore","MNRTCCallabilityStore"],function(a,d){var e=c.id;e||i(0,undefined);a.isAvailableForWebrtcCalling(e)||d.isCallable(e)?a.startOutgoingCall(e,"messenger_bubble_free_call",!1):b("SimpleXUIDialog").show(h._("Hi\u1ec7n kh\u00f4ng th\u1ec3 li\u00ean h\u1ec7 v\u1edbi {firstname}.",[h._param("firstname",c.contactName)]),h._("Kh\u00f4ng th\u1ec3 k\u1ebft n\u1ed1i cu\u1ed9c g\u1ecdi"))});break}}.bind(this),c}a.prototype.componentDidMount=function(){if(!this.props.emojis){var a=this.props.body||"";a=b("MessengerSupportedEmojiUtils").getEmojiOnlyContents(a);a&&a.length&&this.setState({emojis:a})}};a.prototype.render=function(){__p&&__p();var a=!1,c=null;this.state.emojis?c=b("React").createElement(b("EmojiOnlyMessage.react"),{contents:this.state.emojis}):(a=!0,c=b("React").createElement(b("MercuryMessageBody.react"),{ref:this.props.bodyRef,body:this.props.body,className:"_3oh-"+(b("shouldNotRenderSegoe")(this.props.body||"")?" _2por":"")+" _58nk",threadCustomColor:this.props.threadCustomColor,isFromViewer:this.props.isFromViewer,ranges:this.props.ranges,metaRanges:this.props.metaRanges,plainText:this.props.plainText,threadID:this.props.threadID,customLike:this.props.customLike,onContactSelect:this.$1,renderLocation:b("MercuryMessageRenderLocations").MESSENGER}));var d=[],e=[],f=this.props.message,g=!!this.props.isFromViewer;f&&!this.props.excludeAfterDecorators&&(b("MessengerDecorator").getAfterDecorators().forEach(function(a){a.check(f)&&(d.push(a.render(f,g,this.props)),e.push(a.getAdditionalClassNames()))}.bind(this)),b("MessengerDecorator").getBeforeDecorators().forEach(function(a){a.check(f)&&e.push(a.getAdditionalClassNames())}));var h=e.join(" "),i=null;this.props.body&&(this.props.containsCode?i=b("React").createElement(b("MessengerCodeBubble.react"),babelHelpers["extends"]({},this.props,{attachments:this.props.attachments,body:this.props.body,customColor:this.props.customColor,isFromViewer:this.props.isFromViewer,ranges:this.props.ranges||[],threadID:this.props.threadID||""})):i=b("React").createElement("div",{className:"_aok",tabIndex:0,"aria-label":this.props.body},c,this.props.attachments));var j=this.props.repliedToMessage&&b("MessageReplyPermissions").bubbleContainsRepliedToMessage(this.props.repliedToMessage,!!(!this.props.containsCode&&this.state.emojis))?b("React").createElement(b("RepliedToMessageContent.react"),{isFromViewer:this.props.isFromViewer,isLinkified:!0,isMessengerUI:!0,repliedToMessageData:this.props.repliedToMessage,scrollToRepliedMessage:this.props.scrollToRepliedMessage,replyInOneBubble:!0}):null;return b("React").createElement("div",babelHelpers["extends"]({},this.props,{className:b("joinClasses")(h,this.props.className,(this.props.containsCode?"":"_hh7")+(this.props.containsCode?" _4qoc":"")+(!this.props.isFromViewer&&this.props.containsCode?" _65sp":"")+(this.props.isFromViewer&&this.props.containsCode?" _65sq":"")+(this.props.containsCode?"":" _s1-")+(!this.props.containsCode&&!this.props.notBubblish?" _52mr":"")+(!this.props.containsCode&&this.props.isP2PAttachment?" _4z55":"")+(!this.props.containsCode&&!!this.state.emojis?" _2f5r":"")+(!this.props.containsCode&&!!this.state.emojis?" _581a":"")+(this.props.isFromViewer&&!this.state.emojis&&!this.props.containsCode?" _43by":"")+(!this.props.containsCode&&a?" _3oh-":"")+(j?" _6uum":""))}),!f||this.props.isPageMessage?null:b("React").createElement(b("MessengerInnerDecorators.react"),{className:"_1z_2",message:f,isFromViewer:!!this.props.isFromViewer,hovered:this.props.isHovered,onReplyToMessage:this.props.onReplyToMessage,messageProps:babelHelpers["extends"]({},this.props,{handleToggleOriginal:this.props.handleToggleOriginal,hasFormatting:this.props.hasFormatting,isShowingOriginal:this.props.plainText}),isSavedView:this.props.isSavedView}),j,i,i?null:c,i?null:this.props.attachments,d)};a.prototype.$2=function(a,c){c&&c.preventDefault();c=b("MercuryIDs").getThreadIDFromUserID(a.id);c&&b("MessengerActions").selectThread(c)};a.propTypes={attachments:c.instanceOf(b("immutable").List),body:c.string,customColor:c.string,customLike:c.object,excludeAfterDecorators:c.bool,isFromViewer:c.bool,message:c.object,metaRanges:c.array,notBubblish:c.bool,onUnwrap:c.func,participants:c.object,plainText:c.bool,ranges:c.array,threadID:c.string,threadCustomColor:c.string,onReplyToMessage:c.func,isHovered:c.bool,handleToggleOriginal:c.func,hasFormatting:c.func,isPageMessage:c.bool,isSavedView:c.bool,repliedToMessage:c.object,scrollToRepliedMessage:c.func};e.exports=a}),null);
__d("MessengerCodeBubble.react",["Bootloader","MessengerCodePasteUtils","React","ReactDOM"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.prototype.componentDidMount=function(){b("Bootloader").loadModules(["Prism.Complete"],function(a){for(var c in this.refs){var d=b("ReactDOM").findDOMNode(this.refs[c]);a.highlightElement(d)}}.bind(this),"MessengerCodeBubble.react")};a.prototype.render=function(){var a=b("MessengerCodePasteUtils").getCodeAndMessageBubbles(this.props.body,this.props.ranges,this.props.threadID,this.props.customColor,this.props.isFromViewer);return b("React").createElement("div",{className:this.props.className},a)};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("MNCommerceDialogStateActions",["MessengerDispatcher","MNCommerceActionTypes"],(function(a,b,c,d,e,f){"use strict";a={showDialog:function(a,c){b("MessengerDispatcher").dispatch({type:b("MNCommerceActionTypes").DIALOG.SHOW,dialogContainer:a,state:c})},hideDialog:function(){b("MessengerDispatcher").dispatch({type:b("MNCommerceActionTypes").DIALOG.HIDE})}};e.exports=a}),null);
__d("MercuryAttachmentAttribution.react",["cx","fbt","Image.react","ImmutableObject","Link.react","React","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.render=function(){var a=this.$1();return!a?null:b("React").createElement("div",{className:b("joinClasses")(this.props.className,"_29ew")},b("React").createElement(b("Image.react"),{src:a.icon_url,className:"_29ex"}),b("React").createElement("span",{className:"_29ey"},a.name),this.$2())};a.prototype.$1=function(){return this.props.attachment&&this.props.attachment.app_attribution};a.prototype.$2=function(){var a=this.$1();if(!a||!a.metadata)return null;var c="_439n";try{a=JSON.parse(a.metadata)}catch(a){return null}return a.spotify_link?b("React").createElement(b("Link.react"),{className:c,href:a.spotify_link,target:"_blank"},h._("M\u1edf")):null};function a(){i.apply(this,arguments)}a.propTypes={attachment:c.instanceOf(b("ImmutableObject"))};e.exports=a}),null);
__d("MessengerAttachmentAttribution.react",["cx","ImmutableObject","MercuryAttachmentAttribution.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){return b("React").createElement(b("MercuryAttachmentAttribution.react"),{attachment:this.props.attachment,className:"_2f5n _4br2"})};function a(){h.apply(this,arguments)}a.propTypes={attachment:c.instanceOf(b("ImmutableObject"))};e.exports=a}),null);
__d("MessengerBubbleBlock.react",["cx","React"],(function(a,b,c,d,e,f,g){"use strict";var h;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){return b("React").createElement("div",{className:"_52mr _4h13 _3058"},this.props.children)};function a(){h.apply(this,arguments)}e.exports=a}),null);
__d("MessengerCollapsedLogMessageGroup.react",["cx","fbt","Link.react","React"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.state={collapsed:!0},b}a.prototype.render=function(){var a=h._("Xem ho\u1ea1t \u0111\u1ed9ng m\u1edbi nh\u1ea5t"),c=h._("\u1ea8n b\u1edbt ho\u1ea1t \u0111\u1ed9ng");return b("React").createElement("div",{className:"_497p"},b("React").createElement(b("Link.react"),{className:"_4ea1",onClick:function(){return this.setState({collapsed:!this.state.collapsed})}.bind(this)},this.state.collapsed?a:c),this.state.collapsed?null:b("React").createElement("div",null,b("React").createElement("div",{className:"_4ea2"}),this.props.children,b("React").createElement("div",{className:"_4ea2"})))};e.exports=a}),null);
__d("MessengerDateBreak.react",["cx","FBLogger","React","formatDate","joinClasses"],(function(a,b,c,d,e,f,g){__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.shouldComponentUpdate=function(a){"use strict";return this.props.date.getTime()!==a.date.getTime()};a.prototype.render=function(){"use strict";try{var a=b("formatDate")(this.props.date,{today:"g:ia",withinWeek:"D g:ia",thisYear:"M jS, g:ia",older:"m/d/Y g:ia"});return b("React").createElement("h4",{className:b("joinClasses")(this.props.className,"_497p _2lpt")},b("React").createElement("time",{className:"_3oh-"},a))}catch(a){b("FBLogger")("messaging").mustfix("invalid timestamp: "+this.props.date.getTime());return null}};function a(){"use strict";h.apply(this,arguments)}a.propTypes={date:c.instanceOf(Date).isRequired};e.exports=a}),null);
__d("MessengerMessageActionsWrapper.react",["React"],(function(a,b,c,d,e,f){"use strict";a=b("React").PropTypes;c=b("React").createClass({displayName:"MessengerMessageActionsWrapper",propTypes:{message:a.object.isRequired,onShowMenu:a.func.isRequired},render:function(){return b("React").createElement("div",babelHelpers["extends"]({onMouseEnter:this._handleShowMenu,onMouseLeave:this._handleHideMenu},this.props),this.props.children)},_handleShowMenu:function(){this.props.onShowMenu(this.props.message.message_id,!0)},_handleHideMenu:function(){this.props.onShowMenu(this.props.message.message_id,!1)}});e.exports=c}),null);
__d("MessengerMessageSeenHeadsReact.bs",["cx","fbt","cssVar","React","immutable","ImageReact.bs","ReasonReact.bs","joinClasses","MessengerConfig","MercuryTimestamp","MessengerMessage.bs","MercuryAttachment","getViewportDimensions"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=b("MessengerConfig").MaxSeenHeadCount;function k(){var a=b("getViewportDimensions")().width;if(a<parseInt("920px".replace("px",""),10))if(j<8)return j;else return 8;else if(a<parseInt("1211px".replace("px",""),10)&&j>=3)return 3;else return j}var l=b("ReasonReact.bs").statelessComponent("MessengerMessageSeenHeadsReact");function m(a,c,d,e,f,g,i){__p&&__p();return[l[0],l[1],l[2],l[3],l[4],l[5],l[6],l[7],function(){__p&&__p();if(b("MessengerMessage.bs").isSending(d)||g.isEmpty()||b("MessengerMessage.bs").hasError(d))return null;else{var i=b("immutable").Seq(g).filter(function(a){a=a.watermark>=d.timestamp&&a.watermark<e;if(a)return!0;else return!1}).sort(function(a,b){return a.action-b.action|0});if(i.isEmpty())return null;else{var l=c?j:k(0),m=i.count()>(l+1|0),n=m?i.slice(0,l):i;n=n.map(function(c,d,a){a=f.get(d);if(a==null)return null;else{c=h._("{full name} \u0111\u00e3 xem l\u00fac {seen time}",[h._param("full name",a.name),h._param("seen time",b("MercuryTimestamp").getPreciseTimestamp(c.action))]);return b("ReasonReact.bs").element([String(d)],0,b("ImageReact.bs").make(["_jf2"],[c],0,0,[a.image_src],0,[c],0,0,[]))}}).toArray();var o=n.length;if(o===0)return null;else{m=m?i.slice(l,undefined).count():0;if(m>0){i=i.slice(l,undefined).map(function(a,b,c){a=f.get(b);if(a==null)return"";else return a.name}).filter(function(a){a=a==="";if(a)return!1;else return!0}).join("\n")+" ";n.unshift(b("React").createElement("span",{key:"overflow",className:"_jf3",title:i},"+"+String(m)))}return b("React").createElement("span",{className:b("joinClasses")(a,"_jf4"+((o+m|0)===1?" _jf5":"")+(b("MercuryAttachment").isSinglePhotoGroupAttachment(d)?" _ba3":""))},n)}}}},l[9],l[10],l[11],l[12]]}a=b("ReasonReact.bs").wrapReasonForJs(l,function(a){return m(a.className,a.isFromViewer,a.message,a.nextTimestamp,a.participants,a.readReceipts,[])});f.maxSeenHeads=j;f.calculateSliceNumber=k;f.component=l;f.make=m;f.jsComponent=a}),null);
__d("MessengerMessage.react",["cssVar","cx","fbt","EmojiLikeUtils","FluxContainer","ImmutableObject","MercuryAttachment","MercuryDisplayTimeFilterMessageRenderer","MercuryMessageDeliveryState","MercuryMessageError.react","MercuryTimestamp","MessengerAttachmentAttribution.react","MessengerAttachmentRenderer","MessengerBubble.react","MessengerBubbleBlock.react","MessengerCodePasteUtils","MessengerDecorator","MessengerInnerDecorators.react","MessengerMessage.bs","MessengerMessageActionsWrapper.react","MessengerMessageSeenHeadsReact.bs","MessengerSettingsStore","MessengerURIUtils.bs","MessengerVideoAutoplayStore","MNCommerceMessageType","React","TooltipData","emptyFunction","getViewportDimensions","ifRequired","immutable","joinClasses","messengerRTLClasses"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k=b("MessengerMessageSeenHeadsReact.bs").jsComponent;c=b("React").PropTypes;function l(a){switch(a){case b("MercuryMessageDeliveryState").SENDING:return i._("\u0110ang g\u1eedi");case b("MercuryMessageDeliveryState").SENT:return i._("\u0110\u00e3 g\u1eedi");case b("MercuryMessageDeliveryState").DELIVERED:return i._("\u0110\u00e3 chuy\u1ec3n");case b("MercuryMessageDeliveryState").ERROR:return i._("L\u1ed7i")}return null}d=babelHelpers.inherits(a,b("React").Component);j=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=j.constructor).call.apply(a,[this].concat(e)),this.state={isVisible:!1,plainText:!1,shown:{}},this.$13=function(a){this.messageBody=a}.bind(this),this.$14=function(a){a.stopPropagation(),this.props.onSelect(this.props.message.message_id)}.bind(this),this.$4=function(a,b){var c;this.setState({shown:babelHelpers["extends"]({},this.state.shown,(c={},c[a]=b,c))})}.bind(this),this.$10=function(){this.setState({plainText:!this.state.plainText})}.bind(this),this.$9=function(){this.props.onSelect(this.props.message.message_id)}.bind(this),this.$11=function(){return b("MessengerCodePasteUtils").containsCodeBlock(this.props.message.body)||!!this.messageBody&&this.messageBody.hasFormatting()}.bind(this),c}a.getStores=function(){var a=[b("MessengerVideoAutoplayStore")],c=b("ifRequired")("MessengerSphericalRendererStore",function(a){return a},function(){return null});c&&a.push(c);return a};a.calculateState=function(a,c){return{isVisible:b("MessengerVideoAutoplayStore").isVisible(c.message.thread_id,c.message.message_id)||b("ifRequired")("MessengerSphericalRendererStore",function(a){return a.isVisible(c.message.thread_id,c.message.message_id)},function(){return!1})}};a.prototype.shouldComponentUpdate=function(a,c){return a.isActive!==this.props.isActive||a.isFromViewer!==this.props.isFromViewer||a.message!==this.props.message||a.nextTimestamp!==this.props.nextTimestamp||a.showDeliveryState!==this.props.showDeliveryState||a.deliveryTimestamp!==this.props.deliveryTimestamp||!b("immutable").is(a.readReceipts,this.props.readReceipts)||!b("immutable").is(a.participants,this.props.participants)||a.customColor!==this.props.customColor||c.isVisible!==this.state.isVisible};a.prototype.render=function(){__p&&__p();var a=this.props,c=a.isActive,d=a.isFromViewer;a=a.message;var e=i._("{time}",[i._param("time",b("MercuryTimestamp").getPreciseTimestamp(a.timestamp))]);e=b("TooltipData").propsFor(e,m(d));var f=[],g=[],h=this.props.message,j=d||!1,l=this.props.scrollToRepliedMessage;h&&!this.props.hideBeforeDecorator&&(b("MessengerDecorator").getBeforeDecorators().forEach(function(a){a.check(h)&&f.push(a.render(h,j,{scrollToRepliedMessage:l}))}),b("MessengerDecorator").getInnerDecorators().forEach(function(a){a.check(h)&&g.push(a.getAdditionalClassNames())}));var n=this.$1(e,!1),o=this.$2(e,null);o&&(n=this.$1(e,!0));e=!!o&&this.$3();return b("React").createElement(b("MessengerMessageActionsWrapper.react"),{className:b("joinClasses").apply(undefined,["clearfix _o46 _3erg"+(c?" _-5k":"")+(d?" _3i_m":"")+(d?" _nd_":"")+(d?"":" _29_7")+(e?" _q4a":""),b("messengerRTLClasses")(a.body)].concat(g)),message:a,onShowMenu:this.$4},f,n,o,this.$5(),this.$6(),b("React").createElement(k,{className:"_4jzq",isFromViewer:d,message:a,nextTimestamp:this.props.nextTimestamp,participants:this.props.participants,readReceipts:this.props.readReceipts}))};a.prototype.$7=function(a){return a.every(function(a){return!a||!b("MessengerAttachmentRenderer").isRenderedShareAttachment(a)})};a.prototype.$8=function(){return this.props.message.attachments.length===1&&b("MercuryAttachment").hasAttribution(this.props.message.attachments[0])};a.prototype.$2=function(a,c){__p&&__p();if(this.props.message.is_filtered_content)return null;if(this.props.message.commerce_message_type===b("MNCommerceMessageType").RIDE_INTENT)return null;var d=[],e=[],f=this.props.message,g=this.props.isFromViewer||!1;f&&b("MessengerDecorator").getAfterDecorators().forEach(function(a){a.check(f,g)&&(d.push(a.render(f,g,this.props,this.state.shown[this.props.message.message_id])),e.push(a.getAdditionalClassNames()))}.bind(this));c=b("MessengerAttachmentRenderer").getAttachmentsOutsideBubble(this.props.message,this.props.onAttachmentLoad,{customColor:this.props.customColor,isFromViewer:this.props.isFromViewer,isPageMessage:this.props.isPageMessage,isVisible:this.state.isVisible,onSelect:this.$9,onUnwrap:null,pageID:this.props.pageID},d);if(!c||!c.length)return null;var h=this.$7(c),i=this.props.isPageMessage?null:b("React").createElement(b("MessengerInnerDecorators.react"),{className:h?"_1z_2":"",message:f,isFromViewer:!!this.props.isFromViewer,hovered:this.state.shown[this.props.message.message_id],messageProps:babelHelpers["extends"]({},this.props,{handleToggleOriginal:this.$10,hasFormatting:this.$11,isShowingOriginal:this.state.plainText}),isSavedView:this.props.isSavedView});if(a){var j=c.some(function(a){return!!a&&b("MessengerAttachmentRenderer").isPhotosGroupAttachment(a)});this.$8()&&(c=[b("React").createElement("span",{key:"AttachmentWithAttribution"},c[0],b("React").createElement(b("MessengerAttachmentAttribution.react"),{attachment:new(b("ImmutableObject"))(this.props.message.attachments[0])}))]);c=h?b("React").createElement("div",babelHelpers["extends"]({},a,{className:b("joinClasses").apply(undefined,["_3zvs"+(j?" _2-x3":"")].concat(e))}),c,d,i):c.map(function(c){return c&&b("React").cloneElement(c,a)})}j=b("MessengerAttachmentRenderer").isSharedVideoAttachmentMessage(this.props.message);j=b("React").createElement("div",{key:"renderedAttachments",className:"_3058 _15gf"+(j?" _3duc":"")},c,f.body||h?null:i);return this.$8()?b("React").createElement(b("MessengerBubbleBlock.react"),null,j):j};a.prototype.$12=function(){return b("MessengerAttachmentRenderer").isP2PAttachment(this.props.message)};a.prototype.$1=function(a,c){var d=this.props.message,e=b("immutable").List(b("MessengerAttachmentRenderer").getAttachmentsInsideBubble(d,this.props.onAttachmentLoad)),f=d.ranges;d.profile_ranges&&d.profile_ranges.length&&(f=(f||[]).concat(d.profile_ranges.map(function(a){return babelHelpers["extends"]({},a,{url:b("MessengerURIUtils.bs").getURIForUserID(a.id)})})));var g=b("MessengerCodePasteUtils").containsCodeBlock(d.body)&&!this.state.plainText;if(d.is_filtered_content)return b("React").createElement("div",{className:"_3058 _wiu _52mr uiBoxYellow clearfix"},b("MercuryDisplayTimeFilterMessageRenderer").renderFilteredContent(d));var h=d.body&&!b("EmojiLikeUtils").isEmojiLike(d);return h||!e.isEmpty()?b("React").createElement(b("MessengerBubble.react"),babelHelpers["extends"]({attachments:e,body:d.body,bodyRef:this.$13,className:g?(this.props.isFromViewer?"_3uhm":"")+(this.props.isFromViewer?"":" _3uhn")+(d.isSelected?" _3xsz":""):"_3058 _ui9"+(d.isSelected?" _3xsz":""),containsCode:g,customColor:this.props.isFromViewer?this.props.customColor:"",customLike:d.customLike,excludeAfterDecorators:c,isFromViewer:this.props.isFromViewer,isP2PAttachment:this.$12(),ranges:f,message:d,metaRanges:d.meta_ranges,plainText:this.state.plainText,threadCustomColor:this.props.threadCustomColor||"#0084ff",threadID:d.thread_id,participants:this.props.participants,isHovered:this.state.shown[d.message_id],onReplyToMessage:this.props.onReplyToMessage,handleToggleOriginal:this.$10,hasFormatting:this.$11,isShowingOriginal:this.state.plainText,isPageMessage:this.props.isPageMessage,isSavedView:this.props.isSavedView,repliedToMessage:this.props.message.replied_to_message,scrollToRepliedMessage:this.props.scrollToRepliedMessage},a||{})):null};a.prototype.$6=function(){if(!this.props.isFromViewer||!this.props.showDeliveryState||this.props.message.is_like_preview)return null;var a=b("MessengerMessage.bs").getDeliveryState(this.props.message,this.props.deliveryTimestamp);if(a===b("MercuryMessageDeliveryState").UNKNOWN)return null;var c={};this.props.customColor&&(a===b("MercuryMessageDeliveryState").SENT||a===b("MercuryMessageDeliveryState").SENDING||a===b("MercuryMessageDeliveryState").DELIVERED)&&(c.color=this.props.customColor);var d=l(a);return b("React").createElement("span",{className:"_2her"+(a===b("MercuryMessageDeliveryState").SENDING?" _4jzp":"")+(a===b("MercuryMessageDeliveryState").SENT?" _3zzf":"")+(a===b("MercuryMessageDeliveryState").DELIVERED?" _9ah":"")+(a===b("MercuryMessageDeliveryState").ERROR?" _5ei9":""),style:c,title:d},b("React").createElement("i",{"aria-label":d,"aria-roledescription":i._("Bi\u1ec3u t\u01b0\u1ee3ng tr\u1ea1ng th\u00e1i"),className:"_57e_",role:"img"}))};a.prototype.$5=function(){var a=this.props.message;return!b("MessengerMessage.bs").hasError(a)?null:b("React").createElement(b("MercuryMessageError.react"),{className:"_3058 _2ygi",message:a,authorFBID:this.props.authorFBID})};a.prototype.$3=function(){var a=this.props.message,b=!1;a&&(b=!!(a.reactions&&Object.keys(a.reactions).length>0));return b};a.propTypes={customColor:c.string,deliveryTimestamp:c.number.isRequired,hideBeforeDecorator:c.bool,isActive:c.bool,isFromViewer:c.bool,isPageMessage:c.bool,message:c.object.isRequired,nextTimestamp:c.number.isRequired,onAttachmentLoad:c.func.isRequired,onDeselect:c.func.isRequired,onSelect:c.func.isRequired,onReplyToMessage:c.func,participants:c.instanceOf(b("immutable").Map).isRequired,readReceipts:c.instanceOf(b("immutable").OrderedMap).isRequired,showDeliveryState:c.bool,authorFBID:c.string,threadCustomColor:c.string,pageID:c.string,isSavedView:c.bool,scrollToRepliedMessage:c.func};a.defaultProps={onAttachmentLoad:b("emptyFunction"),threadCustomColor:"#0084ff"};function m(a){return b("getViewportDimensions")().width<=parseInt("700px".replace("px",""),10)||b("MessengerSettingsStore").getSettings().info_sidebar_collapsed&&a?"above":a?"right":"left"}e.exports=b("FluxContainer").create(a,{withProps:!0})}),null);
__d("MessengerPageAdminNoteList.react",["cx","fbt","LeftRight.react","MessengerBubble.react","PagesMessengerCreatorInfo.react","React","ReactComponentWithPureRenderMixin","classWithMixins","enumerate","immutable","mixin"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;i=babelHelpers.inherits(a,b("classWithMixins")(b("React").Component,b("mixin")(b("ReactComponentWithPureRenderMixin"))));i&&i.prototype;a.prototype.render=function(){var a=[],c=this.calculateGroups(this.props.notes);c.forEach(function(c,d){a.push(b("React").createElement("li",{className:"_4kd2",key:"group:"+d},this.$MessengerPageAdminNoteList1(c)))}.bind(this));return b("React").createElement("ul",{className:"_4kd3"},a)};a.prototype.$MessengerPageAdminNoteList1=function(a){var c=[];a.forEach(function(d,e){c.push(b("React").createElement("div",{className:"_4kd4",key:"note:"+e},this.$MessengerPageAdminNoteList2(d,a)))}.bind(this));return c};a.prototype.$MessengerPageAdminNoteList2=function(a,c){c=b("immutable").List([b("React").createElement(b("LeftRight.react"),{className:"_561k"},b("React").createElement("div",{className:"_561l"},h._("Ghi ch\u00fa ri\u00eang")),b("React").createElement(b("PagesMessengerCreatorInfo.react"),{key:"creator_info",creator_info:c[0].creator_info,isNote:!0}))]);return b("React").createElement("div",{className:"_o46 _3i_m _nd_"},b("React").createElement("div",{className:"clearfix"},b("React").createElement(b("MessengerBubble.react"),{body:a.body.text,attachments:c,className:"_3058 _4kd5"})))};a.prototype.calculateGroups=function(a){__p&&__p();var c=[],d=null,e=null;a=b("enumerate")(a);var f;while(!(f=a.next()).done){var g=e&&e.value.creator_info.creatorID===f.value.creator_info.creatorID;g||(d=[],c.push(d));d&&d.push(f.value);e=f}return c};function a(){i.apply(this,arguments)}a.propTypes={notes:c.arrayOf(c.shape({id:c.string,body:c.object.isRequired,creator_info:c.shape({creatorID:c.string.isRequired,creatorName:c.string.isRequired,creatorType:c.string.isRequired,labelType:c.string.isRequired,pageID:c.string.isRequired,profileURI:c.string}),timestamp:c.number.isRequired})).isRequired};e.exports=a}),null);
__d("MessengerMessageGroup.react",["cx","fbt","invariant","BootloadOnRender.react","CurrentUser","Image.react","ImmutableObject","JSResource","LazyComponent.react","Link.react","MercuryIDs","MercuryParticipantSilhouettes","MessengerActions","MessengerContactActions.bs","MessengerEnvironment","MessengerMessage.react","MessengerPageAdminNoteList.react","MessengerParticipants.bs","MessengerProfileImageWrapperReact.bs","MessengerStickerUtils","MessengerTextWithEmoticons.react","MessengerURIUtils.bs","PagesMessengerCreatorInfo.react","React","ReactDOM","SimpleXUIDialog","WorkForeignEntityType","gkx","goURI","immutable"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=b("MessengerContactActions.bs").actions,k=b("MessengerProfileImageWrapperReact.bs").jsComponent;a=b("immutable").List;c=b("immutable").OrderedMap;f=b("React").PropTypes;var l=32,m=new(b("ImmutableObject"))({image_src:b("MercuryParticipantSilhouettes").neutralSilhouette,is_messenger_user:!0,name:""});g=b("React").createClass({displayName:"MessengerMessageGroup",_subscription:null,propTypes:{activeMessageID:f.string,deliveryTimestamp:f.number.isRequired,hasDateBreak:f.bool,isCanonical:f.bool,isFromViewer:f.bool,isPageMessage:f.bool,lastReadTimestamp:f.number.isRequired,messages:f.instanceOf(a).isRequired,nextTimestamp:f.number.isRequired,onAttachmentLoad:f.func,onMessageDeselect:f.func.isRequired,onMessageSelect:f.func.isRequired,persona:f.object,onReplyToMessage:f.func,readReceipts:f.instanceOf(c).isRequired,thread:f.object,pageID:f.string,scrollToRepliedMessage:f.func},getInitialState:function(){return{participants:{}}},componentDidMount:function(){this._subscription=this._computeParticipants()},shouldComponentUpdate:function(a,c){var d=a.thread,e=this.props.thread;e=b("gkx")("AT6PnFfyOnIgFYTqFmOIF5pNf2N_1SIsxdZnHuG7VubbiHbDGQcY2LZYFCyw_lKZtHq50hJCgc0UTUOPI60VpF-QK1PVWirWPwgtIYEJ-fSzmA")?Boolean(d&&e&&(d.solid_color!==e.solid_color||d.custom_nickname!==e.custom_nickname)):Boolean(d&&e&&e!==d);return this.props.activeMessageID!==a.activeMessageID||this.props.isFromViewer!==a.isFromViewer||this.props.deliveryTimestamp!==a.deliveryTimestamp||this.props.lastReadTimestamp!==a.lastReadTimestamp||!b("immutable").is(this.props.messages,a.messages)||!b("immutable").is(this.props.readReceipts,a.readReceipts)||this.state.participants!==c.participants||e},componentDidUpdate:function(){var a=n(this.props);!this._subscription&&!a.every(function(a){return this.state.participants[a]}.bind(this))&&(this._subscription=this._computeParticipants())},componentWillUnmount:function(){this._subscription&&b("MessengerParticipants.bs").removeCallback(this._subscription)},render:function(){return b("React").createElement("div",null,b("React").createElement("div",{className:"_1t_p clearfix"+(b("MessengerStickerUtils").isStickerMessageGroup(this.props.messages)?" _5tx1":"")+(this._hasSeenHeadsAtBottom()?" _35fy":"")},this._renderProfileColumn(),b("React").createElement("div",{className:"_41ud"},this._renderName(),this._renderMessages())),this.props.isPageMessage?this._renderNotes():null)},_renderProfileColumn:function(){__p&&__p();var a;if(this.props.isFromViewer)return null;var c=this.props.messages.last();c=this.state.participants[c.author]||m;var d=c.name,e=c.image_src;this.props.persona&&(d=this.props.persona.name,e=this.props.persona.profile_picture_url);var f=h._("{name}",[h._param("name",d)]);a=(a=c)!=null?(a=a.work_foreign_entity_info)!=null?a.type:a:a;a=b("CurrentUser").isWorkUser()&&a===b("WorkForeignEntityType").FOREIGN;a=b("React").createElement(k,{className:"_1t_r",isMessengerUser:c.is_messenger_user,size:l,showBadge:a,isMultiCompany:a,tooltipContent:f},b("React").createElement(b("Image.react"),{alt:d,src:e,height:l,width:l}));if(c.fbid){f=b("MessengerURIUtils.bs").getURIForUserID(c.fbid);!this.props.persona&&b("gkx")("AT7Q3RXvU0e0MR7WMB7vpMdOzYsW6m3MXSY9NFLfpMl_9zOHYMydsYAgMgpRAa3rIuTQCnrjzygxZViELyTXnLRu")?a=b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("MessengerAvatarActions.react").__setRef("MessengerMessageGroup.react"),placeholder:this.props.isCanonical?a:b("React").createElement(b("Link.react"),{className:"_5f0v",href:f.toString(),onClick:this._handleContactSelect.bind(this,c),tabIndex:-1},a),component:b("React").createElement(b("LazyComponent.react"),{avatar:a,contact:c,showSendMessageItem:!this.props.isCanonical,onAction:this._handleContactAction})}):this.props.isCanonical||(a=b("React").createElement(b("Link.react"),{className:"_5f0v",href:f.toString(),onClick:this._handleContactSelect.bind(this,c),tabIndex:-1},a))}return b("React").createElement("div",{className:"_1t_q"},a)},_handleContactAction:function(a,c,e){__p&&__p();switch(a){case j.MESSAGE:this._handleContactSelect(c,e);break;case j.PROFILE:a=this.state.participants[c.id];if(a&&a.href){var f=b("MessengerEnvironment").messengerdotcom;f?window.open(a.href):b("goURI")(a.href)}else this._handleContactSelect(c,e);break;case j.FREE_CALL:d(["FBRTCCore","MNRTCCallabilityStore"],function(a,d){var e=c.fbid;e||i(0,undefined);a.isAvailableForWebrtcCalling(e)||d.isCallable(e)?a.startOutgoingCall(e,"messenger_group_bubble_free_call",!1):b("SimpleXUIDialog").show(h._("Hi\u1ec7n kh\u00f4ng th\u1ec3 li\u00ean h\u1ec7 v\u1edbi {firstname}.",[h._param("firstname",c.short_name)]),h._("Kh\u00f4ng th\u1ec3 k\u1ebft n\u1ed1i cu\u1ed9c g\u1ecdi"))});break}},_renderMessages:function(){var a=this.props.messages.size,c=[];this.props.messages.forEach(function(d,e,f){var g=d.message_id===this.props.activeMessageID,h=b("MercuryIDs").getUserIDFromParticipantID(this.props.author),i=this.props.thread?this.props.thread.solid_color:"",j=this.props.onAttachmentLoad;c.push(b("React").createElement(b("MessengerMessage.react"),{customColor:i,deliveryTimestamp:this.props.deliveryTimestamp,isActive:g,isFromViewer:this.props.isFromViewer,isPageMessage:this.props.isPageMessage,key:d.message_id,message:d,messageActionsWrapper:this.props.messageActionWrapper,onAttachmentLoad:j,participants:b("immutable").Map(this.state.participants),nextTimestamp:this._getNextTimestamp(f,a,e),onDeselect:this.props.onMessageDeselect,onSelect:this.props.onMessageSelect,onReplyToMessage:this.props.onReplyToMessage,readReceipts:this.props.readReceipts,showDeliveryState:d.timestamp>this.props.lastReadTimestamp,ref:d.message_id,authorFBID:h==null?undefined:h,threadCustomColor:i,pageID:this.props.pageID,scrollToRepliedMessage:this.props.scrollToRepliedMessage}));o(this.props.isPageMessage,f,e,d)&&c.push(b("React").createElement(b("PagesMessengerCreatorInfo.react"),{key:"creator_info:"+e,creator_info:d.creator_info}))}.bind(this));return c},_renderNotes:function(){var a=[];this.props.messages.forEach(function(c,d,e){this.props.isPageMessage&&c.page_admin_notes&&a.push(b("React").createElement(b("MessengerPageAdminNoteList.react"),{key:"notes:"+c.message_id,notes:c.page_admin_notes}))}.bind(this));return a},_renderName:function(){__p&&__p();var a=this.props.messages.first(),c=this.state.participants[a.author];if(!c)return null;if(a.replied_to_message)return null;var d=c.short_name,e=d;if(this.props.thread){var f=this.props.thread.custom_nickname?this.props.thread.custom_nickname:null;c=b("MercuryIDs").getUserIDFromParticipantID(c.id);f&&c&&f[c]&&(d=f[c],e=b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:f[c]}))}if(this.props.persona){f=this.state.participants[a.author];e=f?h._("{persona name} t\u1eeb {page name}",[h._param("persona name",this.props.persona.name),h._param("page name",f.short_name)]):this.props.persona.name;d=e.toString()}return b("React").createElement("h5",{"aria-label":d,className:"_ih3"+(this.props.isFromViewer?" accessible_elem":"")+(this.props.isCanonical&&!this.props.persona?" _-ne":"")},e)},getMessageElement:function(a){return b("ReactDOM").findDOMNode(this.refs[a])},_hasSeenHeadsAtBottom:function(){var a=this.props,b=a.messages,c=a.nextTimestamp;a=a.readReceipts;var d=b.last().timestamp,e=0;a.forEach(function(a){if(a>=d&&a<c&&++e===2)return!1});return e===2},_getNextTimestamp:function(a,b,c){return c<b-1?a.get(c+1).timestamp:this.props.nextTimestamp},_handleContactSelect:function(a,c){c&&c.preventDefault();c=b("MercuryIDs").getThreadIDFromParticipantID(a.id);c&&b("MessengerActions").selectThread(c)},_computeParticipants:function(){__p&&__p();var a=n(this.props),c={},d=[];a.forEach(function(a){var e=b("MessengerParticipants.bs").getNow(a);c[a]=e;e||d.push(a)});this.setState({participants:c});return d.length>0?b("MessengerParticipants.bs").getMulti(d,function(b){var a=Object.assign({},this.state.participants);d.forEach(function(c){a[c]=b[c]});this._subscription=null;this.setState({participants:a})}.bind(this)):null}});function n(a){var b=[a.messages.first().author];a.readReceipts.forEach(function(a,c){return b.push(c)});return b}function o(a,b,c,d){if(!a||!d.creator_info)return!1;if(c===b.size-1)return!0;a=b.get(c+1).creator_info;return!a?!0:d.creator_info.creatorID!==a.creatorID}e.exports=g}),null);
__d("MessengerResponsiveBlock.react",["React","createCancelableFunction","requestAnimationFrame","shallowEqual","throttle"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("React").PropTypes;var h={bottom:0,left:0,overflow:"hidden",position:"absolute",right:0,top:0,visibility:"hidden",zIndex:-1},i={left:0,position:"absolute",top:0,transition:"0s"},j={height:"200%",left:0,position:"absolute",top:0,transition:"0s",width:"200%"};d=babelHelpers.inherits(a,b("React").Component);g=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=g.constructor).call.apply(a,[this].concat(e)),this.dirty=!1,this.lastWidth=null,this.lastHeight=null,this.lastBreakpointsToggles=null,this.setupWeirdScrollTracking=function(){this.refs.expandChild.style.width="10000px",this.refs.expandChild.style.height="10000px",this.refs.expand.scrollLeft=1e5,this.refs.expand.scrollTop=1e5,this.refs.shrink.scrollLeft=1e5,this.refs.shrink.scrollTop=1e5}.bind(this),this.$2=function(){__p&&__p();var a=this.refs.outer.offsetWidth,c=this.refs.outer.offsetHeight;if((a!=this.lastWidth||c!=this.lastHeight)&&!this.dirty){if(Math.abs(a-(this.lastWidth||0))<10&&Math.abs(c-(this.lastHeight||0))<16)return;this.dirty=!0;this.lastWidth=a;this.lastHeight=c;a=this.props.breakpointsToggles(a,c);b("shallowEqual")(this.lastBreakpointsToggles,a)?this.dirty=!1:this.forceUpdate(function(){b("requestAnimationFrame")(function(){this.dirty=!1}.bind(this))}.bind(this));this.lastBreakpointsToggles=a}this.setupWeirdScrollTracking()}.bind(this),c}a.prototype.componentDidMount=function(){this.$1=b("createCancelableFunction")(this.$2),this.onScroll=b("throttle")(this.$1,50),this.setupWeirdScrollTracking(),this.onScroll()};a.prototype.componentWillUnmount=function(){this.$1.cancel()};a.prototype.render=function(){return b("React").createElement("div",{ref:"outer"},this.props.children(this.props.breakpointsToggles(this.lastWidth,this.lastHeight)),b("React").createElement("div",{style:h,onScroll:this.onScroll,ref:"expand"},b("React").createElement("div",{style:i,ref:"expandChild"})),b("React").createElement("div",{style:h,onScroll:this.onScroll,ref:"shrink"},b("React").createElement("div",{style:j})))};a.propTypes={children:c.func.isRequired,breakpointsToggles:c.func.isRequired};e.exports=a}),null);
__d("MessengerTypingIndicator.react",["cx","Image.react","MercuryIDs","MercuryTypingAnimation.react","MessengerBubble.react","MessengerParticipants.bs","MessengerPersonas.bs","MessengerProfileImageWrapperReact.bs","React","ReactComponentWithPureRenderMixin","createReactClass_DEPRECATED","immutable"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("MessengerProfileImageWrapperReact.bs").jsComponent;a=b("React").PropTypes;var i=32;c=b("createReactClass_DEPRECATED")({displayName:"MessengerTypingIndicator",_subscription:null,mixins:[b("ReactComponentWithPureRenderMixin")],propTypes:{userID:a.string,showName:a.bool},getInitialState:function(){var a=this.props.userID;return!a?{author:null}:{author:b("MessengerParticipants.bs").getNow(a)}},componentDidMount:function(){var a=this.props.userID;if(!this.state.author&&a){a=b("MessengerParticipants.bs").getNow(a);a||(this._subscription=this._computeAuthor(this.props));this.setState({author:a})}},componentDidUpdate:function(){if(this._subscription)return;if(this.state.author&&this.state.author.id===this.props.userID)return;this._subscription=this._computeAuthor(this.props)},componentWillUnmount:function(){this._subscription&&b("MessengerParticipants.bs").removeCallback(this._subscription)},_computeAuthor:function(a){var c=a.userID;return!c?null:b("MessengerParticipants.bs").getMulti([c],function(a){this._subscription=null,this.setState({author:a[c]})}.bind(this))},getPersona:function(){var a=this.props.userID;return!a?null:b("MessengerPersonas.bs").getNow(b("MercuryIDs").getUserIDFromParticipantID(a))},render:function(){var a=this.state.author,c=this.getPersona();if(!a&&!c)return null;c=c?c.profile_picture_url:a?a.image_src:null;return b("React").createElement("div",{className:"_1t_p _1hbw"},b("React").createElement("div",{className:"_1t_q"},b("React").createElement(h,{className:"_1t_r",isMessengerUser:a?a.is_messenger_user:!1,size:i,showBadge:!0},b("React").createElement(b("Image.react"),{alt:"",src:c,height:i,width:i}))),b("React").createElement("div",{className:"_41ud"},b("React").createElement("div",{className:"_o46 _3erg _29_7"},b("React").createElement(b("MessengerBubble.react"),{attachments:b("immutable").List([b("React").createElement(b("MercuryTypingAnimation.react"),{key:"animation"})]),body:"",className:"_3058",ref:"bubble"}))))},getBubble:function(){return this.refs.bubble}});e.exports=c}),null);
__d("MessengerContextualDialog.react",["cx","AccessibleLayer","ContextualLayerAutoFlipHorizontal","ContextualLayerUpdateOnScroll","LayerHideOnEscape","ReactAbstractContextualDialog","ReactLayer"],(function(a,b,c,d,e,f,g){"use strict";a=12;c=b("ReactLayer").createClass(b("ReactAbstractContextualDialog").createSpec({addedBehaviors:[b("ContextualLayerAutoFlipHorizontal"),b("ContextualLayerUpdateOnScroll"),b("LayerHideOnEscape"),b("AccessibleLayer")],displayName:"MessengerContextualDialog",shouldSetARIAProperties:!1,theme:{wrapperClassName:"_1r_9",arrowDimensions:{offset:a,length:16}}}));e.exports=c}),null);
__d("MessengerDeliveryReceipt.bs",["bs_belt_Option","bs_belt_MapString"],(function(a,b,c,d,e,f){"use strict";function a(a,c){return b("bs_belt_Option").getWithDefault(b("bs_belt_MapString").get(a,c),0)}c=b("bs_belt_Option").getWithDefault;f.$pipe$unknown=c;f.getDeliveryTimeOfThread=a}),null);
__d("MercuryMessageStore",["CurrentUser","LogHistory","MercuryAPIArgsSource","MercuryThreadInformer","MercuryThreadlistConstants","MessengerState.bs","SubscriptionsHandler","mixInEventEmitter","setImmediate"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("LogHistory").getInstance("mercury_message_store");function h(a,c,d){__p&&__p();this.$5=a;this.$1=d||b("CurrentUser").getID();this.$2=1;this.$3=c||b("MercuryThreadlistConstants").RECENT_MESSAGES_LIMIT;this.$6=d?b("MercuryThreadInformer").getForFBID(d):b("MercuryThreadInformer").get();this.$4=new(b("SubscriptionsHandler"))();this.$4.addSubscriptions(this.$6.subscribe("messages-received",function(a,b){return this.$7(b)}.bind(this)),this.$6.subscribe("messages-updated",function(a,b){return b[this.$5]&&this.$8(b[this.$5])}.bind(this)),this.$6.subscribe("messages-reordered",function(a,b){return b[this.$5]&&this.$9()}.bind(this)),this.$6.subscribe("thread-invalidated",function(a,b){return b[this.$5]&&this.$10()}.bind(this)));a=this.$11();g.debug("constructed",JSON.stringify({threadID:this.$5,messageCount:a}));a<this.$3?this.$12():b("setImmediate")(function(){this.$9()}.bind(this))}h.prototype.destroy=function(){this.$4&&this.$4.release(),g.debug("destroyed",JSON.stringify({threadID:this.$5}))};h.prototype.subscribe=function(a){return this.addRetroactiveListener("updated",a)};h.prototype.fetchMoreMessages=function(){if(this.hasFetchedAll())return!1;this.$12();return!0};h.prototype.hasFetchedAll=function(){return b("MessengerState.bs").hasLoadedAllMessages(this.$1,this.$5)||b("MessengerState.bs").isNewEmptyLocalThread(this.$1,this.$5)};h.prototype.$11=function(){return b("MessengerState.bs").getCurrentlyLoadedMessages(this.$1,this.$5).length};h.prototype.$12=function(){var a=this.$3;b("MessengerState.bs").getThreadMessagesRange(this.$1,this.$5,this.$11(),a,this.$13.bind(this),null,b("MercuryAPIArgsSource").MERCURY);this.$2<10&&(this.$2+=1);b("MessengerState.bs").hasLoadedNMessages(this.$1,this.$5,a+this.$11())&&b("setImmediate")(function(){this.$9()}.bind(this))};h.prototype.$13=function(a){g.debug("fetch_messages",JSON.stringify({threadID:this.$5,fetchedMessagesCount:a&&a.length||0,messageCount:this.$11()})),a&&!a.length&&!this.$11()&&this.$14(h.THREAD_IS_EMPTY)};h.prototype.$7=function(a){var b=[];a=a[this.$5];a&&a.length&&(b=b.concat(a.filter(function(a){return!!a})));b.length&&this.$14(h.MESSAGES_RECEIVED)};h.prototype.$8=function(a){this.$14(h.MESSAGES_CHANGED)};h.prototype.$9=function(){this.$14(h.MESSAGES_REORDERED)};h.prototype.$10=function(){this.$2=1,this.$12()};h.prototype.$14=function(a){var c=b("MessengerState.bs").getCurrentlyLoadedMessages(this.$1,this.$5);this.releaseHeldEventType("updated");this.emitAndHold("updated",{messages:c,eventType:a})};Object.assign(h,{MESSAGES_FETCHED:"fetched",MESSAGES_CHANGED:"changed",MESSAGES_RECEIVED:"received",MESSAGES_REORDERED:"reordered",THREAD_IS_EMPTY:"thread-is-empty"});b("mixInEventEmitter")(h,{updated:!0});e.exports=h}),null);